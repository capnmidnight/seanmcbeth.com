function T(t,e){return t.splice(e,1)[0]}function E(t){return t.splice(0)}function v(t,e){let n=t.indexOf(e);return n>-1?(T(t,n),!0):!1}var X=class{constructor(e){this.items=new Map;this.defaultItems=new Array;if(o(e))for(let[n,r]of e)this.add(n,r)}add(e,n){if(u(e))this.defaultItems.push(n);else{let r=this.items.get(e);u(r)&&this.items.set(e,r=[]),r.push(n)}return this}entries(){return this.items.entries()}[Symbol.iterator](){return this.entries()}keys(){return this.items.keys()}*values(){for(let e of this.defaultItems)yield e;for(let e of this.items.values())for(let n of e)yield n}has(e){return o(e)?this.items.has(e):this.defaultItems.length>0}get(e){return u(e)?this.defaultItems:this.items.get(e)||[]}count(e){if(u(e))return this.defaultItems.length;let n=this.get(e);return o(n)?n.length:0}get size(){let e=this.defaultItems.length;for(let n of this.items.values())e+=n.length;return e}delete(e){return u(e)?E(this.defaultItems).length>0:this.items.delete(e)}remove(e,n){if(u(e))v(this.defaultItems,n);else{let r=this.items.get(e);o(r)&&(v(r,n),r.length===0&&this.items.delete(e))}}clear(){this.items.clear(),E(this.defaultItems)}};var C=class{constructor(){this.listeners=new Map;this.listenerOptions=new Map}addEventListener(e,n,r){if(l(n)){let i=this.listeners.get(e);i||(i=new Array,this.listeners.set(e,i)),i.find(a=>a===n)||(i.push(n),r&&this.listenerOptions.set(n,r))}}removeEventListener(e,n){if(l(n)){let r=this.listeners.get(e);r&&this.removeListener(r,n)}}clearEventListeners(e){for(let[n,r]of this.listeners)if(u(e)||e===n){for(let i of r)this.removeEventListener(e,i);E(r),this.listeners.delete(n)}}removeListener(e,n){let r=e.findIndex(i=>i===n);r>=0&&(T(e,r),this.listenerOptions.has(n)&&this.listenerOptions.delete(n))}dispatchEvent(e){let n=this.listeners.get(e.type);if(n)for(let r of n){let i=this.listenerOptions.get(r);o(i)&&!m(i)&&i.once&&this.removeListener(n,r),r.call(this,e)}return!e.defaultPrevented}},w=class extends Event{get type(){return super.type}constructor(e){super(e)}},S=class extends C{constructor(){super(...arguments);this.bubblers=new Set;this.scopes=new WeakMap}addBubbler(n){this.bubblers.add(n)}removeBubbler(n){this.bubblers.delete(n)}addEventListener(n,r,i){super.addEventListener(n,r,i)}removeEventListener(n,r){super.removeEventListener(n,r)}clearEventListeners(n){return super.clearEventListeners(n)}addScopedEventListener(n,r,i,a){this.scopes.has(n)||this.scopes.set(n,[]),this.scopes.get(n).push([r,i]),this.addEventListener(r,i,a)}removeScope(n){let r=this.scopes.get(n);if(r){this.scopes.delete(n);for(let[i,a]of r)this.removeEventListener(i,a)}}dispatchEvent(n){if(!super.dispatchEvent(n))return!1;for(let r of this.bubblers)if(!r.dispatchEvent(n))return!1;return!0}};var b=class{constructor(e,n,r=!0){this._resolve=null;this._reject=null;this._result=null;this._error=null;this._started=!1;this._finished=!1;this.resolve=null;this.reject=null;let i=M,a=M;l(e)&&(i=e),l(n)&&(a=n),m(e)?r=e:m(n)&&(r=n),this.resolve=c=>{o(this._resolve)&&this._resolve(c)},this.reject=c=>{o(this._reject)&&this._reject(c)},this.promise=new Promise((c,A)=>{this._resolve=g=>{i(g)&&(this._result=g,this._finished=!0,c(g))},this._reject=g=>{a(g)&&(this._error=g,this._finished=!0,A(g))}}),r&&this.start()}get result(){if(o(this.error))throw this.error;return this._result}get error(){return this._error}get started(){return this._started}get finished(){return this._finished}start(){this._started=!0}get[Symbol.toStringTag](){return this.promise.toString()}then(e,n){return this.promise.then(e,n)}catch(e){return this.promise.catch(e)}finally(e){return this.promise.finally(e)}};var J=class{constructor(e,n,r){this.callback=null;this.promise=new Promise((i,a)=>{this.callback=(...c)=>{e(...c)?i(n(...c)):a(r(...c))}})}get[Symbol.toStringTag](){return this.promise.toString()}then(e,n){return this.promise.then(e,n)}catch(e){return this.promise.catch(e)}finally(e){return this.promise.finally(e)}};var Oe=/OculusBrowser\/(\d+)\.(\d+)\.(\d+)/i,P=navigator.userAgent.match(Oe),L=!!P,dr=L&&{major:parseFloat(P[1]),minor:parseFloat(P[2]),patch:parseFloat(P[3])},gr=L&&/pacific/i.test(navigator.userAgent),hr=L&&/quest/i.test(navigator.userAgent),xr=L&&/quest 2/i.test(navigator.userAgent);var Er=!("Document"in globalThis);var ke=298.257223563,Ae=6378137;var B=1/ke,_=1-B,s=B/(2-B),Tr=Ae/(1+s)*(1+s*s/4+s*s*s*s/64),I=Math.sqrt(1-_*_),p=1-_*_,vr=I*I/(1-I*I),wr=1-p*(.25+p*(3/64+5*p/256)),Sr=p*(3/8+p*(3/32+45*p/1024)),yr=p*p*(15/256+p*45/1024),Cr=p*p*p*(35/3072),Mr=[s/2-2*s*s/3+37*s*s*s/96,s*s/48+s*s*s/15,17*s*s*s/480],Rr=[2*s-2*s*s/3,7*s*s/3-8*s*s*s/5,56*s*s*s/15];function M(){return!0}var Zr=2*Math.PI;function N(t,e,n){return typeof t===e||t instanceof n}function l(t){return N(t,"function",Function)}function m(t){return N(t,"boolean",Boolean)}function h(t){return o(t)&&N(t,"object",Object)}function u(t){return t==null}function o(t){return!u(t)}function ee(t,e){let n=globalThis,r=n[t];if(u(r)){if(u(e))throw new Error(`No value ${t} found`);r=e(),n[t]=r}return r}function V(t){return o(t)&&t.length>0?parseFloat(t):null}var ne=class{constructor(e,n){this._url=null;this._base=void 0;this._protocol=null;this._host=null;this._hostName=null;this._userName=null;this._password=null;this._port=null;this._pathName=null;this._hash=null;this._query=new Map;e!==void 0&&(this._url=new URL(e,n),this.rehydrate())}rehydrate(){o(this._protocol)&&this._protocol!==this._url.protocol&&(this._url.protocol=this._protocol),o(this._host)&&this._host!==this._url.host&&(this._url.host=this._host),o(this._hostName)&&this._hostName!==this._url.hostname&&(this._url.hostname=this._hostName),o(this._userName)&&this._userName!==this._url.username&&(this._url.username=this._userName),o(this._password)&&this._password!==this._url.password&&(this._url.password=this._password),o(this._port)&&this._port.toFixed(0)!==this._url.port&&(this._url.port=this._port.toFixed(0)),o(this._pathName)&&this._pathName!==this._url.pathname&&(this._url.pathname=this._pathName),o(this._hash)&&this._hash!==this._url.hash&&(this._url.hash=this._hash);for(let[e,n]of this._query)this._url.searchParams.set(e,n);this._protocol=this._url.protocol,this._host=this._url.host,this._hostName=this._url.hostname,this._userName=this._url.username,this._password=this._url.password,this._port=V(this._url.port),this._pathName=this._url.pathname,this._hash=this._url.hash,this._url.searchParams.forEach((e,n)=>this._query.set(n,e))}refresh(){if(this._url===null){if(o(this._protocol)&&(o(this._host)||o(this._hostName))){if(o(this._host))return this._url=new URL(`${this._protocol}//${this._host}`,this._base),this._port=V(this._url.port),this.rehydrate(),!1;if(o(this._hostName))return this._url=new URL(`${this._protocol}//${this._hostName}`,this._base),this.rehydrate(),!1}else if(o(this._pathName)&&o(this._base))return this._url=new URL(this._pathName,this._base),this.rehydrate(),!1}return o(this._url)}base(e){if(this._url!==null)throw new Error("Cannot redefine base after defining the protocol and domain");return this._base=e,this.refresh(),this}protocol(e){return this._protocol=e,this.refresh()&&(this._url.protocol=e),this}host(e){return this._host=e,this.refresh()&&(this._url.host=e,this._hostName=this._url.hostname,this._port=V(this._url.port)),this}hostName(e){return this._hostName=e,this.refresh()&&(this._url.hostname=e,this._host=`${this._url.hostname}:${this._url.port}`),this}port(e){return this._port=e,this.refresh()&&(this._url.port=e.toFixed(0),this._host=`${this._url.hostname}:${this._url.port}`),this}userName(e){return this._userName=e,this.refresh()&&(this._url.username=e),this}password(e){return this._password=e,this.refresh()&&(this._url.password=e),this}path(e){return this._pathName=e,this.refresh()&&(this._url.pathname=e),this}pathPop(e){return e=e||/\/[^\/]+\/?$/,this.path(this._pathName.replace(e,""))}pathPush(e){let n=this._pathName;return n.endsWith("/")||(n+="/"),n+=e,this.path(n)}query(e,n){return this._query.set(e,n),this.refresh()&&this._url.searchParams.set(e,n),this}hash(e){return this._hash=e,this.refresh()&&(this._url.hash=e),this}toURL(){return this._url}toString(){return this._url.href}[Symbol.toStringTag](){return this.toString()}};function D(t){let e=new Map;for(let[n,r]of t)e.set(r,n);return e}var Ve=new Map([[1,"KiB"],[2,"MiB"],[3,"GiB"],[4,"TiB"]]),De=new Map([[1,"KB"],[2,"MB"],[3,"GB"],[4,"TB"]]),us=D(Ve),as=D(De);var re=304.79999999999995,cs=re*3,Fe=10*100,Ue=re*16.5,Ke=Ue*40,ps=Fe*1e3,fs=Ke*8,oe=2.54*4,ie=oe*3,ms=ie*3,ze=ie*16.5,Ge=ze*40,ds=100*1e3,gs=Ge*8,F=4*3,$e=F*3,U=100/2.54,je=F*16.5,We=je*40,hs=U*1e3,xs=We*8,Es=3*3,qe=100/oe,Ye=3*16.5,Ze=Ye*40,bs=qe*1e3,Ts=Ze*8,se=U/F,Xe=16.5*40,vs=se*1e3,ws=Xe*8,Je=U/$e,Qe=16.5/3,et=Qe*40,Ss=Je*1e3,ys=et*8,ue=16.5/se,ae=ue*40,Cs=ae*8,Ms=1e3/ue,Rs=40*8,tt=1e3/ae,Ps=8/tt;var K=class{constructor(e,n){this.key=e;this.value=n;this.name=e.replace(/[A-Z]/g,r=>`-${r.toLocaleLowerCase()}`)}name;applyToElement(e){e.style[this.key]=this.value}},z=class{rest;constructor(...e){this.rest=e}applyToElement(e){for(let n of this.rest)n.applyToElement(e)}};function G(...t){return new z(...t)}function le(t){return new K("touchAction",t)}var x=class{constructor(e,n,r,...i){this.key=e;this.value=n;this.bySetAttribute=r;this.tags=i.map(a=>a.toLocaleUpperCase()),Object.freeze(this)}applyToElement(e){let n=this.key.startsWith("data-");if(!(this.tags.length===0||this.tags.indexOf(e.tagName)>-1||n))console.warn(`Element ${e.tagName} does not support Attribute ${this.key}`);else if(n){let i=this.key.substring(5);e.dataset[i]=this.value}else this.key==="style"?Object.assign(e.style,this.value):this.key==="classList"?this.value.forEach(i=>e.classList.add(i)):this.bySetAttribute?e.setAttribute(this.key,this.value):this.key in e?e[this.key]=this.value:this.value===!1?e.removeAttribute(this.key):this.value===!0?e.setAttribute(this.key,""):e.setAttribute(this.key,this.value)}};function ce(t){return new x("height",t,!1,"canvas","embed","iframe","img","input","object","video")}function nt(t){return t instanceof URL&&(t=t.href),t}function $(t){return new x("src",nt(t),!1,"audio","embed","iframe","img","input","script","source","track","video")}function pe(t){return new x("width",t,!1,"canvas","embed","iframe","img","input","object","video")}function fe(t){return h(t)?t.element instanceof Node:!1}function ot(t){return h(t)&&"elements"in t&&t.elements instanceof Array}function j(t){return fe(t)?t.element:t}function it(t){return h(t)&&"applyToElement"in t&&l(t.applyToElement)}function y(t,...e){t=j(t);for(let n of e)o(n)&&(n instanceof Node?t.append(n):fe(n)?t.append(j(n)):ot(n)?t.append(...n.elements.map(j)):it(n)?n.applyToElement(t):t.append(document.createTextNode(n.toLocaleString())));return t}function me(t,...e){let n=null;for(let r of e)if(r instanceof x&&r.key==="id"){n=document.getElementById(r.value);break}return n==null&&(n=document.createElement(t)),y(n,...e),n}function de(...t){return me("canvas",...t)}function W(...t){return me("img",...t)}function ge(t){return!(t.shiftKey||t.altKey||t.ctrlKey||t.metaKey)}var f=class{constructor(e,n,r){this.name=e;this.callback=n;if(!l(n))throw new Error("A function instance is required for this parameter");this.opts=r,Object.freeze(this)}opts;applyToElement(e){this.add(e)}add(e){e.addEventListener(this.name,this.callback,this.opts)}remove(e){e.removeEventListener(this.name,this.callback)}};function he(t,e){return new f("pointercancel",t,e)}function xe(t,e){return new f("pointerdown",t,e)}function Ee(t,e){return new f("pointerenter",t,e)}function be(t,e){return new f("pointerleave",t,e)}function Te(t,e){return new f("pointermove",t,e)}function ve(t,e){return new f("pointerout",t,e)}function we(t,e){return new f("pointerover",t,e)}function Se(t,e){return new f("pointerup",t,e)}var q="HTMLCanvasElement"in globalThis,Iu="HTMLImageElement"in globalThis,ye=!1,Y=!ye&&"OffscreenCanvas"in globalThis,st=!ye&&"createImageBitmap"in globalThis;function ut(){try{return new OffscreenCanvas(1,1).getContext("2d")!=null}catch{return!1}}var at=Y&&ut(),Ce=at&&pt||q&&O||null,Me=q?O:Ce;function lt(){try{return new OffscreenCanvas(1,1).getContext("webgl2")!=null}catch{return!1}}var _u=Y&&lt();function ct(){if(!q&&!Y)return!1;try{return Ce(1,1).getContext("bitmaprenderer")!=null}catch{return!1}}var Ou=st&&ct();function pt(t,e){return new OffscreenCanvas(t,e)}function O(t,e){return de(pe(t),ce(e))}var ft=ee("Juniper:Graphics2D:Dirt:StopTypes",()=>new Map([["mousedown","down"],["mouseenter","move"],["mouseleave","up"],["mousemove","move"],["mouseout","up"],["mouseover","move"],["mouseup","up"],["pointerdown","down"],["pointerenter","move"],["pointerleave","up"],["pointermove","move"],["pointerout","up"],["pointerup","up"],["pointerover","move"],["touchcancel","up"],["touchend","up"],["touchmove","move"],["touchstart","down"]])),k=class extends S{element;finger;bcanvas;fg;bg;_update;updateEvt=new w("update");pointerId;x;y;lx;ly;pressed;timer;constructor(e,n){super(),this.element=O(e,n),this.bcanvas=Me(this.element.width,this.element.height),this.fg=this.element.getContext("2d"),this.bg=this.bcanvas.getContext("2d"),this.bg.fillStyle="rgb(50%, 50%, 50%)",this.bg.fillRect(0,0,this.bcanvas.width,this.bcanvas.height),this.fg.drawImage(this.bcanvas,0,0),this._update=this.update.bind(this),this.finger=W($("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAqhJREFUOE+VVE1PE1EUPbfvDdOZUiwtdAr9pqQhZBIJQoCwYGX8SlgIaUgIEqb8AxQ2JP0Nuta1rtS4UH6CmBDcGqP+gS4waV3YwDP32akdLAl9yc3M3HnvvPt1DuGKpZSyARQBlAGU2s9oe/tXAK+J6PPl43TZoZQSAJK1Wq1Sr9cfSClnR0dH47lc7rxYLP5mcxwnZBgGg78F8JiIvvs4AUAG29nZmT89PX0WDofnk8kkxsbGkE6nkc1mkclk9HsqlUI8HvcxfgLYIKIjdnQAlVLkuu6der3+MhqNxhKJBCzLghBCG7/zBeVyGYuLi1heXgZR5/g5gIdE9K7jcRzHbTabx7Zt25FIBFJKTE9Po1QqIRr9W7pWq6UtFAphYmIC6+vr3ZE2ANzyAckwjGPTNOc5EgZYXV1FLBbr2TKllI6OL97d3e3ed+QD3hVCfAiHwzBNE1tbWxgeHr5qAAL+8fFxDeqn7wM+F0JUGWxhYQErKyvXAvM3ra2twXVd/ekD/hBCFAzDgOd5uvj9rMnJSWxubv4DJKKWEEJyN/f393VX+1mDg4PY29sLRPhLSmlx9w4ODvoG5AAODw8DgF+EEGX+wQXuN+VeEb6QUno8e0tLS3035b8aArgnpXw/MDAAtu3t7WuPDefZq8s82J9M05zjeRoZGdGDfdUsXlxcaLbw6jmHzONUKuU2Go2PTD1mAtdlZmZGU6wX9ZhRzJRqtdp9cYcpYKWZmpq6fXZ29ioSidxgUE6fgYeGhgLGPr6oUql0064JYDagNgBsz/NunpycPLUsa862bZ0aD7yvNtyAa6kN10MpJQEwiWO1Wu1+t8Dm83ktsIVCgQVWtAWWj7HKPCKiNwE99JnhKzaAHCs3171tWQAZAGkADoAEAAZ5QkTf/PN/ACV4rJ9AdCf3AAAAAElFTkSuQmCC"))}update(){let e=this.lx-this.x,n=this.ly-this.y;if(Math.abs(e)+Math.abs(n)>0&&this.pressed){let r=Math.atan2(n,e)+Math.PI,i=Math.round(Math.sqrt(e*e+n*n));this.bg.save(),this.bg.translate(this.lx,this.ly),this.bg.rotate(r),this.bg.translate(-.5*this.finger.width,-.5*this.finger.height);for(let a=0;a<=i;++a)this.bg.drawImage(this.finger,a,0);this.bg.restore()}this.fg.drawImage(this.bcanvas,0,0),this.lx=this.x,this.ly=this.y,this.timer=null,this.dispatchEvent(this.updateEvt)}stop(){this.pressed=!1}checkPointer(e,n,r,i){let a=ft.get(i)||"up",c=a==="down"&&this.pointerId===null,A=a==="move"&&e===this.pointerId&&this.pressed;this.x=n,this.y=r,c&&(this.lx=n,this.ly=r),this.pressed=c||A,this.pressed?(this.pointerId=e,o(this.timer)&&(cancelAnimationFrame(this.timer),this.timer=null),this.timer=requestAnimationFrame(this._update)):this.pointerId=null}checkPointerUV(e,n,r,i){this.checkPointer(e,n*this.element.width,r*this.element.height,i)}};var Z=new k(1024,1024);y(document.body,y(Z,G(le("none")),Te(d),xe(d),he(d),Se(d),be(d),Ee(d),ve(d),we(d)));function d(t){if(!ge(t))Z.stop();else{let e=t.type;e==="pointerenter"&&t.pointerType==="mouse"&&t.buttons===1&&(e="pointerdown"),Z.checkPointer(t.pointerId,t.offsetX,t.offsetY,e)}}
//# sourceMappingURL=index.min.js.map
