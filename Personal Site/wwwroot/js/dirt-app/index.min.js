function b(n,e){return n.splice(e,1)[0]}function f(n){return n.splice(0)}function v(n,e){let t=n.indexOf(e);return t>-1?(b(n,t),!0):!1}var Y=class{constructor(e){this.items=new Map;this.defaultItems=new Array;if(o(e))for(let[t,r]of e)this.add(t,r)}add(e,t){if(u(e))this.defaultItems.push(t);else{let r=this.items.get(e);u(r)&&this.items.set(e,r=[]),r.push(t)}return this}entries(){return this.items.entries()}[Symbol.iterator](){return this.entries()}keys(){return this.items.keys()}*values(){for(let e of this.defaultItems)yield e;for(let e of this.items.values())for(let t of e)yield t}has(e){return o(e)?this.items.has(e):this.defaultItems.length>0}get(e){return u(e)?this.defaultItems:this.items.get(e)||[]}count(e){if(u(e))return this.defaultItems.length;let t=this.get(e);return o(t)?t.length:0}get size(){let e=this.defaultItems.length;for(let t of this.items.values())e+=t.length;return e}delete(e){return u(e)?f(this.defaultItems).length>0:this.items.delete(e)}remove(e,t){if(u(e))v(this.defaultItems,t);else{let r=this.items.get(e);o(r)&&(v(r,t),r.length===0&&this.items.delete(e))}}clear(){this.items.clear(),f(this.defaultItems)}};var y=class{constructor(){this.listeners=new Map;this.listenerOptions=new Map}addEventListener(e,t,r){if(l(t)){let i=this.listeners.get(e);i||(i=new Array,this.listeners.set(e,i)),i.find(a=>a===t)||(i.push(t),r&&this.listenerOptions.set(t,r))}}removeEventListener(e,t){if(l(t)){let r=this.listeners.get(e);r&&this.removeListener(r,t)}}clearEventListeners(e){for(let[t,r]of this.listeners)if(u(e)||e===t){for(let i of r)this.removeEventListener(e,i);f(r),this.listeners.delete(t)}}removeListener(e,t){let r=e.findIndex(i=>i===t);r>=0&&(b(e,r),this.listenerOptions.has(t)&&this.listenerOptions.delete(t))}dispatchEvent(e){let t=this.listeners.get(e.type);if(t)for(let r of t){let i=this.listenerOptions.get(r);o(i)&&!m(i)&&i.once&&this.removeListener(t,r),r.call(this,e)}return!e.defaultPrevented}},T=class extends Event{get type(){return super.type}constructor(e){super(e)}},w=class extends y{constructor(){super(...arguments);this.bubblers=new Set;this.scopes=new WeakMap}addBubbler(t){this.bubblers.add(t)}removeBubbler(t){this.bubblers.delete(t)}addEventListener(t,r,i){super.addEventListener(t,r,i)}removeEventListener(t,r){super.removeEventListener(t,r)}clearEventListeners(t){return super.clearEventListeners(t)}addScopedEventListener(t,r,i,a){this.scopes.has(t)||this.scopes.set(t,[]),this.scopes.get(t).push([r,i]),this.addEventListener(r,i,a)}removeScope(t){let r=this.scopes.get(t);if(r){this.scopes.delete(t);for(let[i,a]of r)this.removeEventListener(i,a)}}dispatchEvent(t){if(!super.dispatchEvent(t))return!1;for(let r of this.bubblers)if(!r.dispatchEvent(t))return!1;return!0}};function C(){return!0}var x=class{constructor(e,t,r=!0){this.onThens=new Array;this.onCatches=new Array;this._result=null;this._error=null;this._started=!1;this._errored=!1;this._finished=!1;l(e)?this.resolveTest=e:this.resolveTest=C,l(t)?this.rejectTest=t:this.rejectTest=C,m(e)?this.autoStart=e:m(t)?this.autoStart=t:o(r)?this.autoStart=r:this.autoStart=!1,this.autoStart&&this.start(),this.resolve=this._resolve.bind(this),this.reject=this._reject.bind(this)}get result(){if(o(this.error))throw this.error;return this._result}get error(){return this._error}get started(){return this._started}get finished(){return this._finished}get errored(){return this._errored}start(){this._started=!0}_resolve(e){if(this.started&&!this.finished&&this.resolveTest(e)){this._result=e;for(let t of this.onThens)t(e);this._finished=!0}}_reject(e){if(this.started&&!this.finished&&this.rejectTest(e)){this._error=e,this._errored=!0;for(let t of this.onCatches)t(e);this._finished=!0}}get[Symbol.toStringTag](){return this.toString()}project(){return new Promise((e,t)=>{this.finished?this.errored?t(this.error):e(this.result):(this.onThens.push(e),this.onCatches.push(t))})}then(e,t){return this.project().then(e,t)}catch(e){return this.project().catch(e)}finally(e){return this.project().finally(e)}reset(){this.started&&!this.finished&&this.reject("Resetting previous invocation"),f(this.onThens),f(this.onCatches),this._started=this.autoStart,this._errored=!1,this._finished=!1}};var Z=class{constructor(e,t,r){this.callback=null;this.promise=new Promise((i,a)=>{this.callback=(...p)=>{e(...p)?i(t(...p)):a(r(...p))}})}get[Symbol.toStringTag](){return this.promise.toString()}then(e,t){return this.promise.then(e,t)}catch(e){return this.promise.catch(e)}finally(e){return this.promise.finally(e)}};function A(n,e,t){return typeof n===e||n instanceof t}function l(n){return A(n,"function",Function)}function m(n){return A(n,"boolean",Boolean)}function h(n){return o(n)&&A(n,"object",Object)}function u(n){return n==null}function o(n){return!u(n)}var Le=/OculusBrowser\/(\d+)\.(\d+)\.(\d+)/i,R=navigator.userAgent.match(Le),P=!!R,gr=P&&{major:parseFloat(R[1]),minor:parseFloat(R[2]),patch:parseFloat(R[3])},xr=P&&/pacific/i.test(navigator.userAgent),Er=P&&/quest/i.test(navigator.userAgent),br=P&&/quest 2/i.test(navigator.userAgent);var vr=!("Document"in globalThis);var Ie=298.257223563,_e=6378137;var H=1/Ie,I=1-H,s=H/(2-H),wr=_e/(1+s)*(1+s*s/4+s*s*s*s/64),L=Math.sqrt(1-I*I),c=1-I*I,Sr=L*L/(1-L*L),yr=1-c*(.25+c*(3/64+5*c/256)),Cr=c*(3/8+c*(3/32+45*c/1024)),Mr=c*c*(15/256+c*45/1024),Rr=c*c*c*(35/3072),Pr=[s/2-2*s*s/3+37*s*s*s/96,s*s/48+s*s*s/15,17*s*s*s/480],Lr=[2*s-2*s*s/3,7*s*s/3-8*s*s*s/5,56*s*s*s/15];var Xr=2*Math.PI;function J(n,e){let t=globalThis,r=t[n];if(u(r)){if(u(e))throw new Error(`No value ${n} found`);r=e(),t[n]=r}return r}function B(n){let e=new Map;for(let[t,r]of n)e.set(r,t);return e}var He=new Map([[1,"KiB"],[2,"MiB"],[3,"GiB"],[4,"TiB"]]),Be=new Map([[1,"KB"],[2,"MB"],[3,"GB"],[4,"TB"]]),is=B(He),ss=B(Be);var ee=304.79999999999995,as=ee*3,Ne=10*100,Ve=ee*16.5,De=Ve*40,ls=Ne*1e3,cs=De*8,te=2.54*4,ne=te*3,ps=ne*3,Fe=ne*16.5,Ue=Fe*40,fs=100*1e3,ms=Ue*8,N=4*3,Ke=N*3,V=100/2.54,ze=N*16.5,Ge=ze*40,ds=V*1e3,hs=Ge*8,gs=3*3,$e=100/te,je=3*16.5,We=je*40,xs=$e*1e3,Es=We*8,re=V/N,qe=16.5*40,bs=re*1e3,vs=qe*8,Ye=V/Ke,Ze=16.5/3,Xe=Ze*40,Ts=Ye*1e3,ws=Xe*8,oe=16.5/re,ie=oe*40,Ss=ie*8,ys=1e3/oe,Cs=40*8,Je=1e3/ie,Ms=8/Je;function D(n){return o(n)&&n.length>0?parseFloat(n):null}var se=class{constructor(e,t){this._url=null;this._base=void 0;this._protocol=null;this._host=null;this._hostName=null;this._userName=null;this._password=null;this._port=null;this._pathName=null;this._hash=null;this._query=new Map;e!==void 0&&(this._url=new URL(e,t),this.rehydrate())}rehydrate(){o(this._protocol)&&this._protocol!==this._url.protocol&&(this._url.protocol=this._protocol),o(this._host)&&this._host!==this._url.host&&(this._url.host=this._host),o(this._hostName)&&this._hostName!==this._url.hostname&&(this._url.hostname=this._hostName),o(this._userName)&&this._userName!==this._url.username&&(this._url.username=this._userName),o(this._password)&&this._password!==this._url.password&&(this._url.password=this._password),o(this._port)&&this._port.toFixed(0)!==this._url.port&&(this._url.port=this._port.toFixed(0)),o(this._pathName)&&this._pathName!==this._url.pathname&&(this._url.pathname=this._pathName),o(this._hash)&&this._hash!==this._url.hash&&(this._url.hash=this._hash);for(let[e,t]of this._query)this._url.searchParams.set(e,t);this._protocol=this._url.protocol,this._host=this._url.host,this._hostName=this._url.hostname,this._userName=this._url.username,this._password=this._url.password,this._port=D(this._url.port),this._pathName=this._url.pathname,this._hash=this._url.hash,this._url.searchParams.forEach((e,t)=>this._query.set(t,e))}refresh(){if(this._url===null){if(o(this._protocol)&&(o(this._host)||o(this._hostName))){if(o(this._host))return this._url=new URL(`${this._protocol}//${this._host}`,this._base),this._port=D(this._url.port),this.rehydrate(),!1;if(o(this._hostName))return this._url=new URL(`${this._protocol}//${this._hostName}`,this._base),this.rehydrate(),!1}else if(o(this._pathName)&&o(this._base))return this._url=new URL(this._pathName,this._base),this.rehydrate(),!1}return o(this._url)}base(e){if(this._url!==null)throw new Error("Cannot redefine base after defining the protocol and domain");return this._base=e,this.refresh(),this}protocol(e){return this._protocol=e,this.refresh()&&(this._url.protocol=e),this}host(e){return this._host=e,this.refresh()&&(this._url.host=e,this._hostName=this._url.hostname,this._port=D(this._url.port)),this}hostName(e){return this._hostName=e,this.refresh()&&(this._url.hostname=e,this._host=`${this._url.hostname}:${this._url.port}`),this}port(e){return this._port=e,this.refresh()&&(this._url.port=e.toFixed(0),this._host=`${this._url.hostname}:${this._url.port}`),this}userName(e){return this._userName=e,this.refresh()&&(this._url.username=e),this}password(e){return this._password=e,this.refresh()&&(this._url.password=e),this}path(e){return this._pathName=e,this.refresh()&&(this._url.pathname=e),this}pathPop(e){return e=e||/\/[^\/]+\/?$/,this.path(this._pathName.replace(e,""))}pathPush(e){let t=this._pathName;return t.endsWith("/")||(t+="/"),t+=e,this.path(t)}query(e,t){return this._query.set(e,t),this.refresh()&&this._url.searchParams.set(e,t),this}hash(e){return this._hash=e,this.refresh()&&(this._url.hash=e),this}toURL(){return this._url}toString(){return this._url.href}[Symbol.toStringTag](){return this.toString()}};var F=class{constructor(e,t){this.key=e;this.value=t;this.name=e.replace(/[A-Z]/g,r=>`-${r.toLocaleLowerCase()}`)}name;applyToElement(e){e.style[this.key]=this.value}},U=class{rest;constructor(...e){this.rest=e}applyToElement(e){for(let t of this.rest)t.applyToElement(e)}};function K(...n){return new U(...n)}function ue(n){return new F("touchAction",n)}var g=class{constructor(e,t,r,...i){this.key=e;this.value=t;this.bySetAttribute=r;this.tags=i.map(a=>a.toLocaleUpperCase()),Object.freeze(this)}tags;applyToElement(e){let t=this.key.startsWith("data-");if(!(this.tags.length===0||this.tags.indexOf(e.tagName)>-1||t))console.warn(`Element ${e.tagName} does not support Attribute ${this.key}`);else if(t){let i=this.key.substring(5);e.dataset[i]=this.value}else this.key==="style"?Object.assign(e.style,this.value):this.key==="classList"?this.value.forEach(i=>e.classList.add(i)):this.bySetAttribute?e.setAttribute(this.key,this.value):this.key in e?e[this.key]=this.value:this.value===!1?e.removeAttribute(this.key):this.value===!0?e.setAttribute(this.key,""):e.setAttribute(this.key,this.value)}};function ae(n){return new g("height",n,!1,"canvas","embed","iframe","img","input","object","video")}function Qe(n){return n instanceof URL&&(n=n.href),n}function z(n){return new g("src",Qe(n),!1,"audio","embed","iframe","img","input","script","source","track","video")}function le(n){return new g("width",n,!1,"canvas","embed","iframe","img","input","object","video")}function ce(n){return h(n)?n.element instanceof Node:!1}function tt(n){return h(n)&&"elements"in n&&n.elements instanceof Array}function G(n){return ce(n)?n.element:n}function nt(n){return h(n)&&"applyToElement"in n&&l(n.applyToElement)}function S(n,...e){n=G(n);for(let t of e)o(t)&&(t instanceof Node?n.append(t):ce(t)?n.append(G(t)):tt(t)?n.append(...t.elements.map(G)):nt(t)?t.applyToElement(n):n.append(document.createTextNode(t.toLocaleString())));return n}function pe(n,...e){let t=null;for(let r of e)if(r instanceof g&&r.key==="id"){t=document.getElementById(r.value);break}return t==null&&(t=document.createElement(n)),S(t,...e),t}function fe(...n){return pe("canvas",...n)}function $(...n){return pe("img",...n)}var d=class{constructor(e,t,r){this.name=e;this.callback=t;if(!l(t))throw new Error("A function instance is required for this parameter");this.opts=r,Object.freeze(this)}opts;applyToElement(e){this.add(e)}add(e){e.addEventListener(this.name,this.callback,this.opts)}remove(e){e.removeEventListener(this.name,this.callback)}};function me(n,e){return new d("pointercancel",n,e)}function de(n,e){return new d("pointerdown",n,e)}function he(n,e){return new d("pointerenter",n,e)}function ge(n,e){return new d("pointerleave",n,e)}function xe(n,e){return new d("pointermove",n,e)}function Ee(n,e){return new d("pointerup",n,e)}var j="HTMLCanvasElement"in globalThis,Iu="HTMLImageElement"in globalThis,be=!1,W=!be&&"OffscreenCanvas"in globalThis,rt=!be&&"createImageBitmap"in globalThis;function ot(){try{return new OffscreenCanvas(1,1).getContext("2d")!=null}catch{return!1}}var it=W&&ot(),ve=it&&at||j&&_||null,Te=j?_:ve;function st(){try{return new OffscreenCanvas(1,1).getContext("webgl2")!=null}catch{return!1}}var _u=W&&st();function ut(){if(!j&&!W)return!1;try{return ve(1,1).getContext("bitmaprenderer")!=null}catch{return!1}}var Ou=rt&&ut();function at(n,e){return new OffscreenCanvas(n,e)}function _(n,e){return fe(le(n),ae(e))}var lt=J("Juniper:Graphics2D:Dirt:StopTypes",()=>new Map([["drag","move"],["dragcancel","up"],["dragend","up"],["dragstart","down"],["mousedown","down"],["mouseenter","move"],["mouseleave","up"],["mousemove","move"],["mouseout","up"],["mouseover","move"],["mouseup","up"],["pointerdown","down"],["pointerenter","move"],["pointerleave","up"],["pointermove","move"],["pointerout","up"],["pointerup","up"],["pointerover","move"],["touchcancel","up"],["touchend","up"],["touchmove","move"],["touchstart","down"]])),O=class extends w{constructor(t,r,i=1){super();this.fingerScale=i;this.element=_(t,r),this.bcanvas=Te(this.element.width,this.element.height),this.fg=this.element.getContext("2d"),this.bg=this.bcanvas.getContext("2d"),this.bg.fillStyle="rgb(50%, 50%, 50%)",this.bg.fillRect(0,0,this.bcanvas.width,this.bcanvas.height),this.fg.drawImage(this.bcanvas,0,0),this._update=this.update.bind(this),this.finger=$(z("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAqhJREFUOE+VVE1PE1EUPbfvDdOZUiwtdAr9pqQhZBIJQoCwYGX8SlgIaUgIEqb8AxQ2JP0Nuta1rtS4UH6CmBDcGqP+gS4waV3YwDP32akdLAl9yc3M3HnvvPt1DuGKpZSyARQBlAGU2s9oe/tXAK+J6PPl43TZoZQSAJK1Wq1Sr9cfSClnR0dH47lc7rxYLP5mcxwnZBgGg78F8JiIvvs4AUAG29nZmT89PX0WDofnk8kkxsbGkE6nkc1mkclk9HsqlUI8HvcxfgLYIKIjdnQAlVLkuu6der3+MhqNxhKJBCzLghBCG7/zBeVyGYuLi1heXgZR5/g5gIdE9K7jcRzHbTabx7Zt25FIBFJKTE9Po1QqIRr9W7pWq6UtFAphYmIC6+vr3ZE2ANzyAckwjGPTNOc5EgZYXV1FLBbr2TKllI6OL97d3e3ed+QD3hVCfAiHwzBNE1tbWxgeHr5qAAL+8fFxDeqn7wM+F0JUGWxhYQErKyvXAvM3ra2twXVd/ekD/hBCFAzDgOd5uvj9rMnJSWxubv4DJKKWEEJyN/f393VX+1mDg4PY29sLRPhLSmlx9w4ODvoG5AAODw8DgF+EEGX+wQXuN+VeEb6QUno8e0tLS3035b8aArgnpXw/MDAAtu3t7WuPDefZq8s82J9M05zjeRoZGdGDfdUsXlxcaLbw6jmHzONUKuU2Go2PTD1mAtdlZmZGU6wX9ZhRzJRqtdp9cYcpYKWZmpq6fXZ29ioSidxgUE6fgYeGhgLGPr6oUql0064JYDagNgBsz/NunpycPLUsa862bZ0aD7yvNtyAa6kN10MpJQEwiWO1Wu1+t8Dm83ktsIVCgQVWtAWWj7HKPCKiNwE99JnhKzaAHCs3171tWQAZAGkADoAEAAZ5QkTf/PN/ACV4rJ9AdCf3AAAAAElFTkSuQmCC"))}element;finger;bcanvas;fg;bg;_update;updateEvt=new T("update");pressed=!1;pointerId=null;x=null;y=null;lx=null;ly=null;timer=null;update(){let t=this.lx-this.x,r=this.ly-this.y;if(Math.abs(t)+Math.abs(r)>0&&this.pressed){let i=Math.atan2(r,t)+Math.PI,a=Math.round(Math.sqrt(t*t+r*r));this.bg.save(),this.bg.translate(this.lx,this.ly),this.bg.rotate(i),this.bg.translate(-.5*this.finger.width*this.fingerScale,-.5*this.finger.height*this.fingerScale);for(let p=0;p<=a;++p)this.bg.drawImage(this.finger,0,0,this.finger.width,this.finger.height,p,0,this.finger.width*this.fingerScale,this.finger.height*this.fingerScale);this.bg.restore()}this.fg.drawImage(this.bcanvas,0,0),this.lx=this.x,this.ly=this.y,this.timer=null,this.dispatchEvent(this.updateEvt)}stop(){this.pressed=!1}checkPointer(t,r,i,a){let p=lt.get(a)||"up",q=p==="down"&&this.pointerId===null,Se=p==="move"&&t===this.pointerId&&this.pressed;this.x=r,this.y=i,q&&(this.lx=r,this.ly=i),this.pressed=q||Se,this.pressed?(this.pointerId=t,o(this.timer)&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(this._update,10)):this.pointerId=null}checkPointerUV(t,r,i,a){this.checkPointer(t,r*this.element.width,i*this.element.height,a)}};var we=new O(640,480,1);S(document.body,S(we,K(ue("none")),me(E),de(E),he(E),ge(E),xe(E),Ee(E)));function E(n){we.checkPointer(n.pointerId,n.offsetX,n.offsetY,n.type)}
//# sourceMappingURL=index.min.js.map
