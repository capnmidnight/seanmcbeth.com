function A(n,t,e){return typeof n===t||n instanceof e}function x(n){return A(n,"function",Function)}function d(n){return A(n,"string",String)}function u(n){return A(n,"number",Number)}function g(n){return l(n)&&A(n,"object",Object)}function m(n){return n==null}function l(n){return!m(n)}var S=new Map,b=class{constructor(t,e,o,...r){this.key=t;this.value=e;this.bySetAttribute=o;this.tags=r.map(i=>i.toLocaleUpperCase()),Object.freeze(this)}tags;applyToElement(t){if(this.tags.length>0&&this.tags.indexOf(t.tagName)===-1){let e=S.get(t.tagName);e||S.set(t.tagName,e=new Set),e.has(this.key)||(e.add(this.key),console.warn(`Element ${t.tagName} does not support Attribute ${this.key}`))}this.bySetAttribute?t.setAttribute(this.key,this.value.toString()):this.key in t?t[this.key]=this.value:this.value===!1?t.removeAttribute(this.key):this.value===!0?t.setAttribute(this.key,""):x(this.value)?this.value(t):t.setAttribute(this.key,this.value.toString())}};function O(n,t,e,...o){return new b(n,t,e,...o)}function T(n){return n instanceof b}function P(n){return O("id",n,!1)}function h(n){return n.splice(0)}function y(n,t){let e=n.indexOf(t);return e>-1?(M(n,e),!0):!1}function M(n,t){return n.splice(t,1)[0]}var w=class{constructor(t=!0){this.autoStart=t,this.onThens=new Array,this.onCatches=new Array,this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",this.resolve=e=>{if(this.running){this._result=e,this._resultState="resolved";for(let o of this.onThens)o(e);this.clear(),this._executionState="finished"}},this.reject=e=>{if(this.running){this._error=e,this._resultState="errored";for(let o of this.onCatches)o(e);this.clear(),this._executionState="finished"}},this.autoStart&&this.start()}clear(){h(this.onThens),h(this.onCatches)}start(){this._executionState="running"}resolver(t){return()=>this.resolve(t)}resolveOn(t,e,o){let r=this.resolver(o);t.addEventListener(e,r),this.finally(()=>t.removeEventListener(e,r))}get result(){if(l(this.error))throw this.error;return this._result}get error(){return this._error}get executionState(){return this._executionState}get waiting(){return this.executionState==="waiting"}get started(){return this.executionState!=="waiting"}get running(){return this.executionState==="running"}get finished(){return this.executionState==="finished"}get resultState(){return this._resultState}get resolved(){return this.resultState==="resolved"}get errored(){return this.resultState==="errored"}get[Symbol.toStringTag](){return this.toString()}project(){return new Promise((t,e)=>{this.finished?this.errored?e(this.error):t(this.result):(this.onThens.push(t),this.onCatches.push(e))})}then(t,e){return this.project().then(t,e)}catch(t){return this.project().catch(t)}finally(t){return this.project().finally(t)}reset(){this._reset(this.autoStart)}restart(){this._reset(!0)}_reset(t){this.running&&this.reject("Resetting previous invocation"),this.clear(),this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",t&&this.start()}};function k(n){return g(n)?n.element instanceof Element:!1}function F(n){return k(n)?n.element:d(n)?H(n):n}function G(n){return g(n)&&"applyToElement"in n&&x(n.applyToElement)}function z(n,...t){let e=n instanceof Element||n instanceof ShadowRoot?n:d(n)?document.querySelector(n):n.element,o=e instanceof HTMLTemplateElement?e.content:e;for(let r of t)l(r)&&(r instanceof Node?o.appendChild(r):k(r)?o.appendChild(F(r)):G(r)?e instanceof ShadowRoot||r.applyToElement(e):o.appendChild(document.createTextNode(r.toLocaleString())));return e}function H(n){return document.querySelector(n)}function W(n,...t){let e=null,o=t.filter(T).filter(r=>r.key==="id"||r.key==="query");for(let r of o)r.key==="query"?(e=r.value,y(t,r)):r.key==="id"&&(e=document.getElementById(r.value),e&&y(t,r));return e&&e.tagName!==n.toUpperCase()&&console.warn(`Expected a "${n.toUpperCase()}" element but found a "${e.tagName}".`),e||(e=document.createElement(n)),z(e,...t),e}function X(...n){return W("canvas",...n)}function L(n,t){let e=t!=null?1:0,o=Math.floor(Math.random()*(n.length+e))-e;return o<0?t:n[o]}var p=class n extends Float32Array{static BYTE_LENGTH=2*Float32Array.BYTES_PER_ELEMENT;constructor(...t){switch(t.length){case 2:{let e=t[0];typeof e=="number"?super([e,t[1]]):super(e,t[1],2);break}case 1:{let e=t[0];typeof e=="number"?super([e,e]):super(e,0,2);break}default:super(2);break}}get x(){return this[0]}set x(t){this[0]=t}get y(){return this[1]}set y(t){this[1]=t}get r(){return this[0]}set r(t){this[0]=t}get g(){return this[1]}set g(t){this[1]=t}get magnitude(){return Math.hypot(this[0],this[1])}get mag(){return this.magnitude}get squaredMagnitude(){let t=this[0],e=this[1];return t*t+e*e}get sqrMag(){return this.squaredMagnitude}get str(){return n.str(this)}copy(t){return this.set(t),this}add(t){return this[0]+=t[0],this[1]+=t[1],this}subtract(t){return this[0]-=t[0],this[1]-=t[1],this}sub(t){return this}multiply(t){return this[0]*=t[0],this[1]*=t[1],this}mul(t){return this}divide(t){return this[0]/=t[0],this[1]/=t[1],this}div(t){return this}scale(t){return this[0]*=t,this[1]*=t,this}scaleAndAdd(t,e){return this[0]+=t[0]*e,this[1]+=t[1]*e,this}distance(t){return n.distance(this,t)}dist(t){return 0}squaredDistance(t){return n.squaredDistance(this,t)}sqrDist(t){return 0}negate(){return this[0]*=-1,this[1]*=-1,this}invert(){return this[0]=1/this[0],this[1]=1/this[1],this}dot(t){return this[0]*t[0]+this[1]*t[1]}normalize(){return n.normalize(this,this)}static create(){return new n}static clone(t){return new n(t)}static fromValues(t,e){return new n(t,e)}static copy(t,e){return t[0]=e[0],t[1]=e[1],t}static set(t,e,o){return t[0]=e,t[1]=o,t}static add(t,e,o){return t[0]=e[0]+o[0],t[1]=e[1]+o[1],t}static subtract(t,e,o){return t[0]=e[0]-o[0],t[1]=e[1]-o[1],t}static sub(t,e,o){return[0,0]}static multiply(t,e,o){return t[0]=e[0]*o[0],t[1]=e[1]*o[1],t}static mul(t,e,o){return[0,0]}static divide(t,e,o){return t[0]=e[0]/o[0],t[1]=e[1]/o[1],t}static div(t,e,o){return[0,0]}static ceil(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}static floor(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}static min(t,e,o){return t[0]=Math.min(e[0],o[0]),t[1]=Math.min(e[1],o[1]),t}static max(t,e,o){return t[0]=Math.max(e[0],o[0]),t[1]=Math.max(e[1],o[1]),t}static round(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}static scale(t,e,o){return t[0]=e[0]*o,t[1]=e[1]*o,t}static scaleAndAdd(t,e,o,r){return t[0]=e[0]+o[0]*r,t[1]=e[1]+o[1]*r,t}static distance(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1])}static dist(t,e){return 0}static squaredDistance(t,e){let o=e[0]-t[0],r=e[1]-t[1];return o*o+r*r}static sqrDist(t,e){return 0}static magnitude(t){let e=t[0],o=t[1];return Math.sqrt(e*e+o*o)}static mag(t){return 0}static length(t){return 0}static len(t){return 0}static squaredLength(t){let e=t[0],o=t[1];return e*e+o*o}static sqrLen(t,e){return 0}static negate(t,e){return t[0]=-e[0],t[1]=-e[1],t}static inverse(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}static normalize(t,e){let o=e[0],r=e[1],i=o*o+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}static dot(t,e){return t[0]*e[0]+t[1]*e[1]}static cross(t,e,o){let r=e[0]*o[1]-e[1]*o[0];return t[0]=t[1]=0,t[2]=r,t}static lerp(t,e,o,r){let i=e[0],a=e[1];return t[0]=i+r*(o[0]-i),t[1]=a+r*(o[1]-a),t}static transformMat2(t,e,o){let r=e[0],i=e[1];return t[0]=o[0]*r+o[2]*i,t[1]=o[1]*r+o[3]*i,t}static transformMat2d(t,e,o){let r=e[0],i=e[1];return t[0]=o[0]*r+o[2]*i+o[4],t[1]=o[1]*r+o[3]*i+o[5],t}static transformMat3(t,e,o){let r=e[0],i=e[1];return t[0]=o[0]*r+o[3]*i+o[6],t[1]=o[1]*r+o[4]*i+o[7],t}static transformMat4(t,e,o){let r=e[0],i=e[1];return t[0]=o[0]*r+o[4]*i+o[12],t[1]=o[1]*r+o[5]*i+o[13],t}static rotate(t,e,o,r){let i=e[0]-o[0],a=e[1]-o[1],f=Math.sin(r),v=Math.cos(r);return t[0]=i*v-a*f+o[0],t[1]=i*f+a*v+o[1],t}static angle(t,e){let o=t[0],r=t[1],i=e[0],a=e[1],f=Math.sqrt(o*o+r*r)*Math.sqrt(i*i+a*a),v=f&&(o*i+r*a)/f;return Math.acos(Math.min(Math.max(v,-1),1))}static zero(t){return t[0]=0,t[1]=0,t}static exactEquals(t,e){return t[0]===e[0]&&t[1]===e[1]}static equals(t,e){let o=t[0],r=t[1],i=e[0],a=e[1];return Math.abs(o-i)<=1e-6*Math.max(1,Math.abs(o),Math.abs(i))&&Math.abs(r-a)<=1e-6*Math.max(1,Math.abs(r),Math.abs(a))}static str(t){return`Vec2(${t.join(", ")})`}};p.prototype.sub=p.prototype.subtract;p.prototype.mul=p.prototype.multiply;p.prototype.div=p.prototype.divide;p.prototype.dist=p.prototype.distance;p.prototype.sqrDist=p.prototype.squaredDistance;p.sub=p.subtract;p.mul=p.multiply;p.div=p.divide;p.dist=p.distance;p.sqrDist=p.squaredDistance;p.sqrLen=p.squaredLength;p.mag=p.magnitude;p.length=p.magnitude;p.len=p.magnitude;function V(n,t){return Math.random()*(t-n)+n}var q=["red","green","blue","yellow","magenta","cyan"],C=class n{#t;get pos(){return this.#t}#e;get vel(){return this.#e}#o;static BYTE_LENGTH=2*p.BYTE_LENGTH;constructor(t){this.#t=new p(t,0),this.#e=new p(t,p.BYTE_LENGTH),this.#o=L(q)}static fill(t){let e=new ArrayBuffer(n.BYTE_LENGTH*t.length);for(let o=0;o<t.length;++o){let r=new Float32Array(e,n.BYTE_LENGTH*o,4),i=t[o]=new n(r);i.pos.x=V(-1,1),i.pos.y=V(-1,1),i.vel.x=V(-.1,.1),i.vel.y=V(-.1,.1)}return e}draw2d(t,e,o){let r=Math.atan2(this.vel.y,this.vel.x),i=this.vel.magnitude;t.save(),t.fillStyle=this.#o,t.translate(this.#t.x,this.#t.y),t.rotate(r),t.scale(1+i,1),t.fillRect(-o,-o,e,e),t.restore()}};function I(n,t){let e=0;u(n)?e=n:t=n;let o=!0;return(...r)=>{o&&(o=!1,setTimeout(()=>{o=!0,t(...r)},e))}}var s=X(P("frontBuffer")),_=s.getContext("2d",{alpha:!0,desynchronized:!0}),J=I(et),$=new ResizeObserver(n=>{for(let t of n)t.target===s&&J()}),U=await navigator.gpu.requestAdapter({powerPreference:"high-performance"}),K=await U.requestDevice(),j=new Array(100),R=C.fill(j),Y=new Uint8Array(R),Z=K.createBuffer({mappedAtCreation:!0,size:R.byteLength,usage:GPUBufferUsage.MAP_WRITE}),Q=Z.getMappedRange(),tt=new Uint8Array(Q);tt.set(Y);$.observe(s);function et(){s.width=s.clientWidth*devicePixelRatio,s.height=s.clientHeight*devicePixelRatio}requestAnimationFrame(D);function D(){requestAnimationFrame(D);let n=Math.min(s.width,s.height),t=n/2;_.clearRect(0,0,s.width,s.height),_.save(),_.translate(s.width/2,s.height/2),_.scale(.01,.01);for(let e of j)e.draw2d(_,n,t);_.restore()}requestAnimationFrame(B);async function B(){requestAnimationFrame(B)}
