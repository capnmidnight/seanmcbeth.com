function u(t,e,n){return typeof t===e||t instanceof n}function a(t){return u(t,"function",Function)}function p(t){return u(t,"string",String)}function d(t){return s(t)&&u(t,"object",Object)}function c(t){return t==null}function s(t){return!c(t)}function l(t){return t.splice(0)}function f(t,e){let n=t.indexOf(e);return n>-1?(A(t,n),!0):!1}function A(t,e){return t.splice(e,1)[0]}var g=class{constructor(e=!0){this.autoStart=e,this.onThens=new Array,this.onCatches=new Array,this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",this.resolve=n=>{if(this.running){this._result=n,this._resultState="resolved";for(let r of this.onThens)r(n);this.clear(),this._executionState="finished"}},this.reject=n=>{if(this.running){this._error=n,this._resultState="errored";for(let r of this.onCatches)r(n);this.clear(),this._executionState="finished"}},this.autoStart&&this.start()}clear(){l(this.onThens),l(this.onCatches)}start(){this._executionState="running"}resolver(e){return()=>this.resolve(e)}resolveOn(e,n,r){let o=this.resolver(r);e.addEventListener(n,o),this.finally(()=>e.removeEventListener(n,o))}get result(){if(s(this.error))throw this.error;return this._result}get error(){return this._error}get executionState(){return this._executionState}get waiting(){return this.executionState==="waiting"}get started(){return this.executionState!=="waiting"}get running(){return this.executionState==="running"}get finished(){return this.executionState==="finished"}get resultState(){return this._resultState}get resolved(){return this.resultState==="resolved"}get errored(){return this.resultState==="errored"}get[Symbol.toStringTag](){return this.toString()}project(){return new Promise((e,n)=>{this.finished?this.errored?n(this.error):e(this.result):(this.onThens.push(e),this.onCatches.push(n))})}then(e,n){return this.project().then(e,n)}catch(e){return this.project().catch(e)}finally(e){return this.project().finally(e)}reset(){this._reset(this.autoStart)}restart(){this._reset(!0)}_reset(e){this.running&&this.reject("Resetting previous invocation"),this.clear(),this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",e&&this.start()}};var h=new Map,m=class{constructor(e,n,r,...o){this.key=e;this.value=n;this.bySetAttribute=r;this.tags=o.map(X=>X.toLocaleUpperCase()),Object.freeze(this)}tags;applyToElement(e){if(this.tags.length>0&&this.tags.indexOf(e.tagName)===-1){let n=h.get(e.tagName);n||h.set(e.tagName,n=new Set),n.has(this.key)||(n.add(this.key),console.warn(`Element ${e.tagName} does not support Attribute ${this.key}`))}this.bySetAttribute?e.setAttribute(this.key,this.value.toString()):this.key in e?e[this.key]=this.value:this.value===!1?e.removeAttribute(this.key):this.value===!0?e.setAttribute(this.key,""):a(this.value)?this.value(e):e.setAttribute(this.key,this.value.toString())}};function V(t,e,n,...r){return new m(t,e,n,...r)}function C(t){return t instanceof m}function y(t){return V("id",t,!1)}function E(t){return p(t)||(t=t.value),V("type",t,!1,"button","input","command","embed","link","object","script","source","style","menu")}function w(t){return d(t)?t.element instanceof Element:!1}function I(t){return w(t)?t.element:p(t)?j(t):t}function O(t){return d(t)&&"applyToElement"in t&&a(t.applyToElement)}function S(t,...e){let n=t instanceof Element||t instanceof ShadowRoot?t:p(t)?document.querySelector(t):t.element,r=n instanceof HTMLTemplateElement?n.content:n;for(let o of e)s(o)&&(o instanceof Node?r.appendChild(o):w(o)?r.appendChild(I(o)):O(o)?n instanceof ShadowRoot||o.applyToElement(n):r.appendChild(document.createTextNode(o.toLocaleString())));return n}function j(t){return document.querySelector(t)}function P(t,...e){let n=null,r=e.filter(C).filter(o=>o.key==="id"||o.key==="query");for(let o of r)o.key==="query"?(n=o.value,f(e,o)):o.key==="id"&&(n=document.getElementById(o.value),n&&f(e,o));return n&&n.tagName!==t.toUpperCase()&&console.warn(`Expected a "${t.toUpperCase()}" element but found a "${n.tagName}".`),n||(n=document.createElement(t)),S(n,...e),n}function D(...t){return P("button",...t)}function k(...t){return D(...t,E("button"))}function x(...t){return P("div",...t)}var v=class{constructor(e,n,r){this.name=e;this.callback=n;if(!a(n))throw new Error("A function instance is required for this parameter");this.opts=r,Object.freeze(this)}opts;applyToElement(e){this.add(e)}add(e){e.addEventListener(this.name,this.callback,this.opts)}remove(e){e.removeEventListener(this.name,this.callback)}};function R(t,e,n){return new v(t,e,n)}function T(t,e){return R("click",t,e)}var M=0;k(y("go"),T(()=>{console.log("GO",++M),document.body.append(x(M.toFixed(0)))}));window.addEventListener("keydown",t=>{console.log(t),document.body.append(x("Down",t.key))});window.addEventListener("keyup",t=>{console.log(t),document.body.append(x("Up",t.key))});
