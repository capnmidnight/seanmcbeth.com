var Tt=Object.defineProperty;var Xt=(e,t)=>{for(var o in t)Tt(e,o,{get:t[o],enumerable:!0})};function Y(e,t,o){return typeof e===t||e instanceof o}function v(e){return Y(e,"function",Function)}function m(e){return Y(e,"string",String)}function X(e){return l(e)&&Y(e,"object",Object)}function u(e){return e==null}function l(e){return!u(e)}var pt=new Map,L=class{constructor(t,o,n,...r){this.key=t;this.value=o;this.bySetAttribute=n;this.tags=r.map(s=>s.toLocaleUpperCase()),Object.freeze(this)}tags;applyToElement(t){if(this.tags.length>0&&this.tags.indexOf(t.tagName)===-1){let o=pt.get(t.tagName);o||pt.set(t.tagName,o=new Set),o.has(this.key)||(o.add(this.key),console.warn(`Element ${t.tagName} does not support Attribute ${this.key}`))}this.bySetAttribute?t.setAttribute(this.key,this.value.toString()):this.key in t?t[this.key]=this.value:this.value===!1?t.removeAttribute(this.key):this.value===!0?t.setAttribute(this.key,""):v(this.value)?this.value(t):t.setAttribute(this.key,this.value.toString())}};function Lt(e,t,o,...n){return new L(e,t,o,...n)}function ct(e){return e instanceof L}function lt(e){return Lt("id",e,!1)}function I(e){return e.splice(0)}function Q(e,t){let o=e.indexOf(t);return o>-1?(dt(e,o),!0):!1}function dt(e,t){return e.splice(t,1)[0]}var tt=class{constructor(t=!0){this.autoStart=t,this.onThens=new Array,this.onCatches=new Array,this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",this.resolve=o=>{if(this.running){this._result=o,this._resultState="resolved";for(let n of this.onThens)n(o);this.clear(),this._executionState="finished"}},this.reject=o=>{if(this.running){this._error=o,this._resultState="errored";for(let n of this.onCatches)n(o);this.clear(),this._executionState="finished"}},this.autoStart&&this.start()}clear(){I(this.onThens),I(this.onCatches)}start(){this._executionState="running"}resolver(t){return()=>this.resolve(t)}resolveOn(t,o,n){let r=this.resolver(n);t.addEventListener(o,r),this.finally(()=>t.removeEventListener(o,r))}get result(){if(l(this.error))throw this.error;return this._result}get error(){return this._error}get executionState(){return this._executionState}get waiting(){return this.executionState==="waiting"}get started(){return this.executionState!=="waiting"}get running(){return this.executionState==="running"}get finished(){return this.executionState==="finished"}get resultState(){return this._resultState}get resolved(){return this.resultState==="resolved"}get errored(){return this.resultState==="errored"}get[Symbol.toStringTag](){return this.toString()}project(){return new Promise((t,o)=>{this.finished?this.errored?o(this.error):t(this.result):(this.onThens.push(t),this.onCatches.push(o))})}then(t,o){return this.project().then(t,o)}catch(t){return this.project().catch(t)}finally(t){return this.project().finally(t)}reset(){this._reset(this.autoStart)}restart(){this._reset(!0)}_reset(t){this.running&&this.reject("Resetting previous invocation"),this.clear(),this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",t&&this.start()}};function mt(e){return X(e)?e.element instanceof Element:!1}function It(e){return mt(e)?e.element:m(e)?Dt(e):e}function jt(e){return X(e)&&"applyToElement"in e&&v(e.applyToElement)}function Rt(e,...t){let o=e instanceof Element||e instanceof ShadowRoot?e:m(e)?document.querySelector(e):e.element,n=o instanceof HTMLTemplateElement?o.content:o;for(let r of t)l(r)&&(r instanceof Node?n.appendChild(r):mt(r)?n.appendChild(It(r)):jt(r)?o instanceof ShadowRoot||r.applyToElement(o):n.appendChild(document.createTextNode(r.toLocaleString())));return o}function Dt(e){return document.querySelector(e)}function Ot(e,...t){let o=null,n=t.filter(ct).filter(r=>r.key==="id"||r.key==="query");for(let r of n)r.key==="query"?(o=r.value,Q(t,r)):r.key==="id"&&(o=document.getElementById(r.value),o&&Q(t,r));return o&&o.tagName!==e.toUpperCase()&&console.warn(`Expected a "${e.toUpperCase()}" element but found a "${o.tagName}".`),o||(o=document.createElement(e)),Rt(o,...t),o}function xt(...e){return Ot("canvas",...e)}var et=1e-6,S=typeof Float32Array<"u"?Float32Array:Array,ut=Math.random;var gn=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var i={};Xt(i,{add:()=>Wt,angle:()=>le,ceil:()=>Nt,clone:()=>Gt,copy:()=>zt,create:()=>_t,cross:()=>oe,dist:()=>Ae,distance:()=>At,div:()=>ve,divide:()=>vt,dot:()=>ee,equals:()=>ue,exactEquals:()=>xe,floor:()=>qt,forEach:()=>Ve,fromValues:()=>Ft,inverse:()=>Qt,len:()=>_e,length:()=>bt,lerp:()=>ne,max:()=>$t,min:()=>Jt,mul:()=>ge,multiply:()=>gt,negate:()=>Zt,normalize:()=>te,random:()=>re,rotate:()=>ce,round:()=>Ut,scale:()=>Kt,scaleAndAdd:()=>Yt,set:()=>Ht,sqrDist:()=>he,sqrLen:()=>be,squaredDistance:()=>ht,squaredLength:()=>Vt,str:()=>me,sub:()=>fe,subtract:()=>ft,transformMat2:()=>ie,transformMat2d:()=>se,transformMat3:()=>pe,transformMat4:()=>ae,zero:()=>de});function _t(){var e=new S(2);return S!=Float32Array&&(e[0]=0,e[1]=0),e}function Gt(e){var t=new S(2);return t[0]=e[0],t[1]=e[1],t}function Ft(e,t){var o=new S(2);return o[0]=e,o[1]=t,o}function zt(e,t){return e[0]=t[0],e[1]=t[1],e}function Ht(e,t,o){return e[0]=t,e[1]=o,e}function Wt(e,t,o){return e[0]=t[0]+o[0],e[1]=t[1]+o[1],e}function ft(e,t,o){return e[0]=t[0]-o[0],e[1]=t[1]-o[1],e}function gt(e,t,o){return e[0]=t[0]*o[0],e[1]=t[1]*o[1],e}function vt(e,t,o){return e[0]=t[0]/o[0],e[1]=t[1]/o[1],e}function Nt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function qt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function Jt(e,t,o){return e[0]=Math.min(t[0],o[0]),e[1]=Math.min(t[1],o[1]),e}function $t(e,t,o){return e[0]=Math.max(t[0],o[0]),e[1]=Math.max(t[1],o[1]),e}function Ut(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function Kt(e,t,o){return e[0]=t[0]*o,e[1]=t[1]*o,e}function Yt(e,t,o,n){return e[0]=t[0]+o[0]*n,e[1]=t[1]+o[1]*n,e}function At(e,t){var o=t[0]-e[0],n=t[1]-e[1];return Math.hypot(o,n)}function ht(e,t){var o=t[0]-e[0],n=t[1]-e[1];return o*o+n*n}function bt(e){var t=e[0],o=e[1];return Math.hypot(t,o)}function Vt(e){var t=e[0],o=e[1];return t*t+o*o}function Zt(e,t){return e[0]=-t[0],e[1]=-t[1],e}function Qt(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function te(e,t){var o=t[0],n=t[1],r=o*o+n*n;return r>0&&(r=1/Math.sqrt(r)),e[0]=t[0]*r,e[1]=t[1]*r,e}function ee(e,t){return e[0]*t[0]+e[1]*t[1]}function oe(e,t,o){var n=t[0]*o[1]-t[1]*o[0];return e[0]=e[1]=0,e[2]=n,e}function ne(e,t,o,n){var r=t[0],s=t[1];return e[0]=r+n*(o[0]-r),e[1]=s+n*(o[1]-s),e}function re(e,t){t=t||1;var o=ut()*2*Math.PI;return e[0]=Math.cos(o)*t,e[1]=Math.sin(o)*t,e}function ie(e,t,o){var n=t[0],r=t[1];return e[0]=o[0]*n+o[2]*r,e[1]=o[1]*n+o[3]*r,e}function se(e,t,o){var n=t[0],r=t[1];return e[0]=o[0]*n+o[2]*r+o[4],e[1]=o[1]*n+o[3]*r+o[5],e}function pe(e,t,o){var n=t[0],r=t[1];return e[0]=o[0]*n+o[3]*r+o[6],e[1]=o[1]*n+o[4]*r+o[7],e}function ae(e,t,o){var n=t[0],r=t[1];return e[0]=o[0]*n+o[4]*r+o[12],e[1]=o[1]*n+o[5]*r+o[13],e}function ce(e,t,o,n){var r=t[0]-o[0],s=t[1]-o[1],a=Math.sin(n),p=Math.cos(n);return e[0]=r*p-s*a+o[0],e[1]=r*a+s*p+o[1],e}function le(e,t){var o=e[0],n=e[1],r=t[0],s=t[1],a=Math.sqrt(o*o+n*n)*Math.sqrt(r*r+s*s),p=a&&(o*r+n*s)/a;return Math.acos(Math.min(Math.max(p,-1),1))}function de(e){return e[0]=0,e[1]=0,e}function me(e){return"vec2("+e[0]+", "+e[1]+")"}function xe(e,t){return e[0]===t[0]&&e[1]===t[1]}function ue(e,t){var o=e[0],n=e[1],r=t[0],s=t[1];return Math.abs(o-r)<=et*Math.max(1,Math.abs(o),Math.abs(r))&&Math.abs(n-s)<=et*Math.max(1,Math.abs(n),Math.abs(s))}var _e=bt,fe=ft,ge=gt,ve=vt,Ae=At,he=ht,be=Vt,Ve=function(){var e=_t();return function(t,o,n,r,s,a){var p,_;for(o||(o=2),n||(n=0),r?_=Math.min(r*o+n,t.length):_=t.length,p=n;p<_;p+=o)e[0]=t[p],e[1]=t[p+1],s(e,e,a),t[p]=e[0],t[p+1]=e[1];return t}}();var j=class{constructor(t,o){this.canvas=t;this.target=o}position=i.create();update(t){i.set(this.position,this.canvas.width,this.canvas.height),i.scale(this.position,this.position,.5),i.scaleAndAdd(this.position,this.position,this.target.position,-1);let o=i.len(this.target.velocity);o>0&&i.scaleAndAdd(this.position,this.position,this.target.velocity,-1/Math.pow(o,.25))}draw(t){t.fillStyle="rgba(0, 0, 0, 0.5)",t.fillRect(0,0,this.canvas.width,this.canvas.height),t.translate(this.position[0],this.position[1])}};var R=class{keySet=new Set;constructor(){window.addEventListener("keydown",t=>{this.keySet.add(t.key)}),window.addEventListener("keyup",t=>{this.keySet.delete(t.key)})}has(t){return this.keySet.has(t)}get shift(){return this.keySet.has("Shift")?1:0}get vertical(){return this.keySet.has("ArrowUp")?1:this.keySet.has("ArrowDown")?-1:0}get horizontal(){return this.keySet.has("ArrowRight")?1:this.keySet.has("ArrowLeft")?-1:0}};var A=i.create();var Ce=1,h=i.create(),D=class{bodies;constructor(...t){this.bodies=t}update(t){for(let o of this.bodies)i.copy(o.gravity,A);for(let o=0;o<this.bodies.length-1;++o){let n=this.bodies[o];for(let r=o+1;r<this.bodies.length;++r){let s=this.bodies[r];i.sub(h,n.position,s.position);let a=i.sqrLen(h);if(a>0){i.normalize(h,h);let p=Ce*n.mass*s.mass/a;i.scaleAndAdd(n.gravity,n.gravity,h,-p/n.mass),i.scaleAndAdd(s.gravity,s.gravity,h,p/s.mass)}}}}};var E=class{constructor(t,o,n){this.mass=t;this.radius=o;this.atmoRadius=n;this.atmoRadius>0&&(this.atmoRadius+=this.radius)}gravity=i.create();velocity=i.create();position=i.create();update(t){i.scaleAndAdd(this.velocity,this.velocity,this.gravity,t),i.scaleAndAdd(this.position,this.position,this.velocity,t)}draw(t){t.save(),t.fillStyle="black",t.strokeStyle="white",t.lineWidth=10,t.translate(this.position[0],this.position[1]),t.beginPath(),t.arc(0,0,this.radius,0,2*Math.PI),t.stroke(),t.fill(),this.atmoRadius>0&&(t.lineWidth=.5,t.beginPath(),t.arc(0,0,this.atmoRadius,0,2*Math.PI),t.stroke()),t.restore()}};var Ct=5,ye=5,we=1e3,Se=-.05,O=class{constructor(t){this.keyboard=t}enginePower=0;turnRate=0;drag=0;mass=1;rotation=0;shake=i.create();acceleration=i.create();gravity=i.create();velocity=i.create();position=i.create();update(t){this.turnRate=this.keyboard.horizontal,this.enginePower=Math.max(-.5,this.keyboard.vertical)+this.keyboard.shift*7,this.rotation+=ye*this.turnRate*t,i.set(this.acceleration,1,0),i.rotate(this.acceleration,this.acceleration,A,this.rotation),i.scale(this.acceleration,this.acceleration,we*this.enginePower*t),i.set(this.shake,0,Math.random()*2-1),i.rotate(this.shake,this.shake,A,this.rotation);let o=Math.pow(i.len(this.acceleration),.3333);i.scaleAndAdd(this.shake,A,this.shake,o),i.scaleAndAdd(this.acceleration,this.acceleration,this.velocity,Se*this.drag),i.add(this.acceleration,this.acceleration,this.gravity),i.scaleAndAdd(this.velocity,this.velocity,this.acceleration,t),i.scaleAndAdd(this.position,this.position,this.velocity,t)}draw(t){t.save(),t.fillStyle="black",t.strokeStyle="white",t.lineWidth=.25,t.translate(this.position[0]+this.shake[0],this.position[1]+this.shake[1]),t.rotate(this.rotation),t.scale(Ct,Ct),t.beginPath(),t.moveTo(1.75,0),t.lineTo(-1,1.25),t.lineTo(-.5,0),this.enginePower>0&&(t.lineTo(-this.enginePower+.4*Math.random(),.2+.4*Math.random()),t.lineTo(-.7+.1*Math.random(),0+.1*Math.random()),t.lineTo(-this.enginePower-.4*Math.random(),-.2-.4*Math.random()),t.lineTo(-.5,0)),t.lineTo(-1,-1.25),t.closePath(),t.stroke(),t.restore()}};var Ee=.5*(Math.sqrt(3)-1),P=(3-Math.sqrt(3))/6,Xn=1/3,Ln=1/6,In=(Math.sqrt(5)-1)/4,jn=(5-Math.sqrt(5))/20,yt=e=>Math.floor(e)|0,wt=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]);function St(e=Math.random){let t=Pe(e),o=new Float64Array(t).map(r=>wt[r%12*2]),n=new Float64Array(t).map(r=>wt[r%12*2+1]);return function(s,a){let p=0,_=0,rt=0,it=(s+a)*Ee,H=yt(s+it),W=yt(a+it),st=(H+W)*P,kt=H-st,Mt=W-st,f=s-kt,g=a-Mt,M,T;f>g?(M=1,T=0):(M=0,T=1);let N=f-M+P,q=g-T+P,J=f-1+2*P,$=g-1+2*P,U=H&255,K=W&255,b=.5-f*f-g*g;if(b>=0){let d=U+t[K],y=o[d],w=n[d];b*=b,p=b*b*(y*f+w*g)}let V=.5-N*N-q*q;if(V>=0){let d=U+M+t[K+T],y=o[d],w=n[d];V*=V,_=V*V*(y*N+w*q)}let C=.5-J*J-$*$;if(C>=0){let d=U+1+t[K+1],y=o[d],w=n[d];C*=C,rt=C*C*(y*J+w*$)}return 70*(p+_+rt)}}function Pe(e){let o=new Uint8Array(512);for(let n=0;n<512/2;n++)o[n]=n;for(let n=0;n<512/2-1;n++){let r=n+~~(e()*(256-n)),s=o[n];o[n]=o[r],o[r]=s}for(let n=256;n<512;n++)o[n]=o[n-256];return o}var x=10,B=class{constructor(t,o){this.canvas=t;this.target=o}noise=St(Math.random);draw(t){t.save(),t.fillStyle="white";for(let o=0;o<this.canvas.height;o+=x){let n=o-x*Math.round(this.target.position[1]/x);for(let r=0;r<this.canvas.width;r+=x){let s=r-x*Math.round(this.target.position[0]/x);this.noise(x*s,x*n)>.9&&t.fillRect(s,n,2,2)}}t.restore()}};function Et(e){let t=!1;function o(){e.width=devicePixelRatio*e.clientWidth,e.height=devicePixelRatio*e.clientHeight,t=!1}new ResizeObserver(r=>{for(let s of r)s.target===e&&(t||(t=!0,queueMicrotask(o)))}).observe(e)}function Pt(e){let t=0;requestAnimationFrame(n=>{n*=.001,t=n,requestAnimationFrame(o)});function o(n){n*=.001;let r=n-t;t=n,requestAnimationFrame(o),e(r,n)}}var G=xt(lt("frontBuffer")),ot=G.getContext("2d"),ke=new R,F=new O(ke),z=new E(1e7,10,0),k=new E(1e6,50,50),nt=new j(G,F),Me=new B(G,nt),Te=new D(z,k,F),Xe=[Te,z,k,F,nt],Le=[nt,Me,z,k,F];i.set(z.position,500,100);i.set(k.position,-500,-150);i.set(k.velocity,30,-30);Et(G);Pt(e=>{ot.save();for(let t of Xe)t.update(e);for(let t of Le)t.draw(ot);ot.restore()});
