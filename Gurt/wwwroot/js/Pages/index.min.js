var Dt=Object.defineProperty;var Ot=(e,t)=>{for(var o in t)Dt(e,o,{get:t[o],enumerable:!0})};function Z(e,t,o){return typeof e===t||e instanceof o}function v(e){return Z(e,"function",Function)}function x(e){return Z(e,"string",String)}function X(e){return d(e)&&Z(e,"object",Object)}function _(e){return e==null}function d(e){return!_(e)}var ct=new Map,L=class{constructor(t,o,n,...r){this.key=t;this.value=o;this.bySetAttribute=n;this.tags=r.map(s=>s.toLocaleUpperCase()),Object.freeze(this)}tags;applyToElement(t){if(this.tags.length>0&&this.tags.indexOf(t.tagName)===-1){let o=ct.get(t.tagName);o||ct.set(t.tagName,o=new Set),o.has(this.key)||(o.add(this.key),console.warn(`Element ${t.tagName} does not support Attribute ${this.key}`))}this.bySetAttribute?t.setAttribute(this.key,this.value.toString()):this.key in t?t[this.key]=this.value:this.value===!1?t.removeAttribute(this.key):this.value===!0?t.setAttribute(this.key,""):v(this.value)?this.value(t):t.setAttribute(this.key,this.value.toString())}};function Q(e,t,o,...n){return new L(e,t,o,...n)}function dt(e){return e instanceof L}function mt(e){return Q("height",e,!1,"canvas","embed","iframe","img","input","object","video")}function xt(e){return Q("id",e,!1)}function ut(e){return Q("width",e,!1,"canvas","embed","iframe","img","input","object","video")}function I(e){return e.splice(0)}function et(e,t){let o=e.indexOf(t);return o>-1?(_t(e,o),!0):!1}function _t(e,t){return e.splice(t,1)[0]}var ot=class{constructor(t=!0){this.autoStart=t,this.onThens=new Array,this.onCatches=new Array,this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",this.resolve=o=>{if(this.running){this._result=o,this._resultState="resolved";for(let n of this.onThens)n(o);this.clear(),this._executionState="finished"}},this.reject=o=>{if(this.running){this._error=o,this._resultState="errored";for(let n of this.onCatches)n(o);this.clear(),this._executionState="finished"}},this.autoStart&&this.start()}clear(){I(this.onThens),I(this.onCatches)}start(){this._executionState="running"}resolver(t){return()=>this.resolve(t)}resolveOn(t,o,n){let r=this.resolver(n);t.addEventListener(o,r),this.finally(()=>t.removeEventListener(o,r))}get result(){if(d(this.error))throw this.error;return this._result}get error(){return this._error}get executionState(){return this._executionState}get waiting(){return this.executionState==="waiting"}get started(){return this.executionState!=="waiting"}get running(){return this.executionState==="running"}get finished(){return this.executionState==="finished"}get resultState(){return this._resultState}get resolved(){return this.resultState==="resolved"}get errored(){return this.resultState==="errored"}get[Symbol.toStringTag](){return this.toString()}project(){return new Promise((t,o)=>{this.finished?this.errored?o(this.error):t(this.result):(this.onThens.push(t),this.onCatches.push(o))})}then(t,o){return this.project().then(t,o)}catch(t){return this.project().catch(t)}finally(t){return this.project().finally(t)}reset(){this._reset(this.autoStart)}restart(){this._reset(!0)}_reset(t){this.running&&this.reject("Resetting previous invocation"),this.clear(),this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",t&&this.start()}};function ft(e){return X(e)?e.element instanceof Element:!1}function Bt(e){return ft(e)?e.element:x(e)?zt(e):e}function Gt(e){return X(e)&&"applyToElement"in e&&v(e.applyToElement)}function Ft(e,...t){let o=e instanceof Element||e instanceof ShadowRoot?e:x(e)?document.querySelector(e):e.element,n=o instanceof HTMLTemplateElement?o.content:o;for(let r of t)d(r)&&(r instanceof Node?n.appendChild(r):ft(r)?n.appendChild(Bt(r)):Gt(r)?o instanceof ShadowRoot||r.applyToElement(o):n.appendChild(document.createTextNode(r.toLocaleString())));return o}function zt(e){return document.querySelector(e)}function Ht(e,...t){let o=null,n=t.filter(dt).filter(r=>r.key==="id"||r.key==="query");for(let r of n)r.key==="query"?(o=r.value,et(t,r)):r.key==="id"&&(o=document.getElementById(r.value),o&&et(t,r));return o&&o.tagName!==e.toUpperCase()&&console.warn(`Expected a "${e.toUpperCase()}" element but found a "${o.tagName}".`),o||(o=document.createElement(e)),Ft(o,...t),o}function R(...e){return Ht("canvas",...e)}var nt=1e-6,S=typeof Float32Array<"u"?Float32Array:Array,gt=Math.random;var bn=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var i={};Ot(i,{add:()=>Ut,angle:()=>_e,ceil:()=>Kt,clone:()=>Nt,copy:()=>Jt,create:()=>vt,cross:()=>pe,dist:()=>ye,distance:()=>Vt,div:()=>Ce,divide:()=>bt,dot:()=>se,equals:()=>Ae,exactEquals:()=>ve,floor:()=>Yt,forEach:()=>Ee,fromValues:()=>qt,inverse:()=>re,len:()=>he,length:()=>yt,lerp:()=>ae,max:()=>Qt,min:()=>Zt,mul:()=>Ve,multiply:()=>ht,negate:()=>ne,normalize:()=>ie,random:()=>ce,rotate:()=>ue,round:()=>te,scale:()=>ee,scaleAndAdd:()=>oe,set:()=>$t,sqrDist:()=>we,sqrLen:()=>Se,squaredDistance:()=>Ct,squaredLength:()=>wt,str:()=>ge,sub:()=>be,subtract:()=>At,transformMat2:()=>le,transformMat2d:()=>de,transformMat3:()=>me,transformMat4:()=>xe,zero:()=>fe});function vt(){var e=new S(2);return S!=Float32Array&&(e[0]=0,e[1]=0),e}function Nt(e){var t=new S(2);return t[0]=e[0],t[1]=e[1],t}function qt(e,t){var o=new S(2);return o[0]=e,o[1]=t,o}function Jt(e,t){return e[0]=t[0],e[1]=t[1],e}function $t(e,t,o){return e[0]=t,e[1]=o,e}function Ut(e,t,o){return e[0]=t[0]+o[0],e[1]=t[1]+o[1],e}function At(e,t,o){return e[0]=t[0]-o[0],e[1]=t[1]-o[1],e}function ht(e,t,o){return e[0]=t[0]*o[0],e[1]=t[1]*o[1],e}function bt(e,t,o){return e[0]=t[0]/o[0],e[1]=t[1]/o[1],e}function Kt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function Yt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function Zt(e,t,o){return e[0]=Math.min(t[0],o[0]),e[1]=Math.min(t[1],o[1]),e}function Qt(e,t,o){return e[0]=Math.max(t[0],o[0]),e[1]=Math.max(t[1],o[1]),e}function te(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function ee(e,t,o){return e[0]=t[0]*o,e[1]=t[1]*o,e}function oe(e,t,o,n){return e[0]=t[0]+o[0]*n,e[1]=t[1]+o[1]*n,e}function Vt(e,t){var o=t[0]-e[0],n=t[1]-e[1];return Math.hypot(o,n)}function Ct(e,t){var o=t[0]-e[0],n=t[1]-e[1];return o*o+n*n}function yt(e){var t=e[0],o=e[1];return Math.hypot(t,o)}function wt(e){var t=e[0],o=e[1];return t*t+o*o}function ne(e,t){return e[0]=-t[0],e[1]=-t[1],e}function re(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function ie(e,t){var o=t[0],n=t[1],r=o*o+n*n;return r>0&&(r=1/Math.sqrt(r)),e[0]=t[0]*r,e[1]=t[1]*r,e}function se(e,t){return e[0]*t[0]+e[1]*t[1]}function pe(e,t,o){var n=t[0]*o[1]-t[1]*o[0];return e[0]=e[1]=0,e[2]=n,e}function ae(e,t,o,n){var r=t[0],s=t[1];return e[0]=r+n*(o[0]-r),e[1]=s+n*(o[1]-s),e}function ce(e,t){t=t||1;var o=gt()*2*Math.PI;return e[0]=Math.cos(o)*t,e[1]=Math.sin(o)*t,e}function le(e,t,o){var n=t[0],r=t[1];return e[0]=o[0]*n+o[2]*r,e[1]=o[1]*n+o[3]*r,e}function de(e,t,o){var n=t[0],r=t[1];return e[0]=o[0]*n+o[2]*r+o[4],e[1]=o[1]*n+o[3]*r+o[5],e}function me(e,t,o){var n=t[0],r=t[1];return e[0]=o[0]*n+o[3]*r+o[6],e[1]=o[1]*n+o[4]*r+o[7],e}function xe(e,t,o){var n=t[0],r=t[1];return e[0]=o[0]*n+o[4]*r+o[12],e[1]=o[1]*n+o[5]*r+o[13],e}function ue(e,t,o,n){var r=t[0]-o[0],s=t[1]-o[1],a=Math.sin(n),p=Math.cos(n);return e[0]=r*p-s*a+o[0],e[1]=r*a+s*p+o[1],e}function _e(e,t){var o=e[0],n=e[1],r=t[0],s=t[1],a=Math.sqrt(o*o+n*n)*Math.sqrt(r*r+s*s),p=a&&(o*r+n*s)/a;return Math.acos(Math.min(Math.max(p,-1),1))}function fe(e){return e[0]=0,e[1]=0,e}function ge(e){return"vec2("+e[0]+", "+e[1]+")"}function ve(e,t){return e[0]===t[0]&&e[1]===t[1]}function Ae(e,t){var o=e[0],n=e[1],r=t[0],s=t[1];return Math.abs(o-r)<=nt*Math.max(1,Math.abs(o),Math.abs(r))&&Math.abs(n-s)<=nt*Math.max(1,Math.abs(n),Math.abs(s))}var he=yt,be=At,Ve=ht,Ce=bt,ye=Vt,we=Ct,Se=wt,Ee=function(){var e=vt();return function(t,o,n,r,s,a){var p,l;for(o||(o=2),n||(n=0),r?l=Math.min(r*o+n,t.length):l=t.length,p=n;p<l;p+=o)e[0]=t[p],e[1]=t[p+1],s(e,e,a),t[p]=e[0],t[p+1]=e[1];return t}}();var j=class{constructor(t){this.target=t}position=i.create();do(t,o,n,r){if(i.set(this.position,t.canvas.width,t.canvas.height),i.scale(this.position,this.position,.5),i.scaleAndAdd(this.position,this.position,this.target.position,-o),r){let s=i.len(this.target.velocity);s>0&&i.scaleAndAdd(this.position,this.position,this.target.velocity,-o/Math.pow(s,.25))}t.fillStyle=n,t.fillRect(0,0,t.canvas.width,t.canvas.height),t.translate(this.position[0],this.position[1])}predict(t,o){this.do(t,o,"rgba(0, 0, 0, 0.5)",!0)}prepare(t,o){t.clearRect(0,0,t.canvas.width,t.canvas.height),this.do(t,o,"rgba(0, 0, 0, 0.75)",!1)}};var D=class{keySet=new Set;constructor(){window.addEventListener("keydown",t=>{this.keySet.add(t.key)}),window.addEventListener("keyup",t=>{this.keySet.delete(t.key)})}has(t){return this.keySet.has(t)}get shift(){return this.keySet.has("Shift")?1:0}get vertical(){return this.keySet.has("ArrowUp")?1:this.keySet.has("ArrowDown")?-1:0}get horizontal(){return this.keySet.has("ArrowRight")?1:this.keySet.has("ArrowLeft")?-1:0}};var O=class{constructor(t,o,n){this.scale=t;this.camera=o;this.drawables=n}buffer=R(ut(256),mt(128));g=this.buffer.getContext("2d");draw(t){this.g.save(),this.camera.prepare(this.g,this.scale),t.scale(this.scale,this.scale);for(let o of this.drawables)o.drawMini(this.g,this.scale);this.g.restore(),t.save(),t.strokeStyle="rgba(255, 255, 255, 0.25)",t.lineWidth=1,t.translate(10,10),t.drawImage(this.buffer,0,0),t.strokeRect(0,0,this.buffer.width,this.buffer.height),t.restore()}};var A=i.create();var h=i.create(),St=.01,B=class{bodies;timeAccum=0;constructor(...t){this.bodies=t}update(t){for(this.timeAccum+=t;this.timeAccum>0;this.timeAccum-=St){for(let o of this.bodies)i.copy(o.gravity,A);for(let o=0;o<this.bodies.length-1;++o){let n=this.bodies[o];if(n.mass!==0)for(let r=o+1;r<this.bodies.length;++r){let s=this.bodies[r];if(s.mass!==0&&(i.sub(h,n.position,s.position),i.sqrLen(h)>0)){i.normalize(h,h);let p=0;i.scaleAndAdd(n.gravity,n.gravity,h,-p/n.mass),i.scaleAndAdd(s.gravity,s.gravity,h,p/s.mass)}}}for(let o of this.bodies)o.update(St)}}};var E=class{constructor(t,o,n,r,s){this.name=t;this.mass=o;this.radius=n;this.atmoRadius=r;this.color=s;this.atmoRadius>0&&(this.atmoRadius+=this.radius)}gravity=i.create();velocity=i.create();position=i.create();update(t){i.scaleAndAdd(this.velocity,this.velocity,this.gravity,t),i.scaleAndAdd(this.position,this.position,this.velocity,t)}drawMajor(t,o,n){t.fillStyle=n,t.translate(this.position[0],this.position[1]),this.radius*o>=2?(t.beginPath(),t.arc(0,0,this.radius,0,2*Math.PI),t.fill()):t.fillRect(0,0,2/o,2/o),t.textAlign="center",t.textBaseline="middle",t.fillStyle="white"}draw(t,o){t.save(),t.scale(o,o),this.atmoRadius>0&&(t.fillStyle="rgba(255, 255, 255, .05)",t.lineWidth=.5/o,t.beginPath(),t.arc(this.position[0],this.position[1],this.atmoRadius,0,2*Math.PI),t.fill(),t.stroke()),t.lineWidth=2/o,this.drawMajor(t,o,"black");let n=50/o;t.font=`normal ${n}px monospace`,t.fillText(this.name,0,0),t.strokeStyle=this.color,t.stroke(),t.restore()}drawMini(t,o){t.save(),this.drawMajor(t,o,this.color),t.restore()}};var Pe=5,ke=1e3,Me=-.05,G=class{constructor(t){this.keyboard=t}enginePower=0;turnRate=0;drag=0;mass=1;rotation=0;shake=i.create();acceleration=i.create();gravity=i.create();velocity=i.create();position=i.create();update(t){this.turnRate=this.keyboard.horizontal,this.enginePower=Math.max(-.5,this.keyboard.vertical)+this.keyboard.shift*7,this.rotation+=Pe*this.turnRate*t,i.set(this.acceleration,1,0),i.rotate(this.acceleration,this.acceleration,A,this.rotation),i.scale(this.acceleration,this.acceleration,ke*this.enginePower*t),i.set(this.shake,0,Math.random()*2-1),i.rotate(this.shake,this.shake,A,this.rotation);let o=0;i.scaleAndAdd(this.shake,A,this.shake,o),i.scaleAndAdd(this.acceleration,this.acceleration,this.velocity,Me*this.drag),i.add(this.acceleration,this.acceleration,this.gravity),i.scaleAndAdd(this.velocity,this.velocity,this.acceleration,t),i.scaleAndAdd(this.position,this.position,this.velocity,t)}draw(t,o){if(t.save(),t.fillStyle="black",t.strokeStyle="white",t.lineWidth=1.25/o,t.scale(o,o),t.translate(this.position[0]+this.shake[0],this.position[1]+this.shake[1]),t.rotate(this.rotation),t.beginPath(),t.moveTo(14,0),t.lineTo(-8,10),t.lineTo(-4,0),this.enginePower>0){let n=-8*Math.sqrt(this.enginePower);t.lineTo(n-3.2*Math.random(),1.6+3.2*Math.random()),t.lineTo(-5.6+.8*Math.random(),0+.8*Math.random()),t.lineTo(n-3.2*Math.random(),-1.6-3.2*Math.random()),t.lineTo(-4,0)}t.lineTo(-8,-10),t.closePath(),t.stroke(),t.restore()}drawMini(t,o){let n=4/o;t.save(),t.fillStyle="yellow",t.fillRect(this.position[0],this.position[1],n,n),t.restore()}};var Te=.5*(Math.sqrt(3)-1),P=(3-Math.sqrt(3))/6,Bn=1/3,Gn=1/6,Fn=(Math.sqrt(5)-1)/4,zn=(5-Math.sqrt(5))/20,Et=e=>Math.floor(e)|0,Pt=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]);function kt(e=Math.random){let t=Xe(e),o=new Float64Array(t).map(r=>Pt[r%12*2]),n=new Float64Array(t).map(r=>Pt[r%12*2+1]);return function(s,a){let p=0,l=0,H=0,pt=(s+a)*Te,W=Et(s+pt),N=Et(a+pt),at=(W+N)*P,Rt=W-at,jt=N-at,f=s-Rt,g=a-jt,M,T;f>g?(M=1,T=0):(M=0,T=1);let q=f-M+P,J=g-T+P,$=f-1+2*P,U=g-1+2*P,K=W&255,Y=N&255,b=.5-f*f-g*g;if(b>=0){let m=K+t[Y],y=o[m],w=n[m];b*=b,p=b*b*(y*f+w*g)}let V=.5-q*q-J*J;if(V>=0){let m=K+M+t[Y+T],y=o[m],w=n[m];V*=V,l=V*V*(y*q+w*J)}let C=.5-$*$-U*U;if(C>=0){let m=K+1+t[Y+1],y=o[m],w=n[m];C*=C,H=C*C*(y*$+w*U)}return 70*(p+l+H)}}function Xe(e){let o=new Uint8Array(512);for(let n=0;n<512/2;n++)o[n]=n;for(let n=0;n<512/2-1;n++){let r=n+~~(e()*(256-n)),s=o[n];o[n]=o[r],o[r]=s}for(let n=256;n<512;n++)o[n]=o[n-256];return o}var u=10,F=class{constructor(t){this.target=t}noise=kt(Math.random);draw(t,o){t.save(),t.fillStyle="white";let n=.5*t.canvas.width,r=.5*t.canvas.height;for(let s=-r;s<r;s+=u){let a=s-u*Math.round(this.target.position[1]/u);for(let p=-n;p<n;p+=u){let l=p-u*Math.round(this.target.position[0]/u);this.noise(u*l,u*a)>.9&&t.fillRect(l,a,2/o,2/o)}}t.restore()}drawMini(t,o){}};function Mt(e){let t=!1;function o(){e.width=devicePixelRatio*e.clientWidth,e.height=devicePixelRatio*e.clientHeight,t=!1}new ResizeObserver(r=>{for(let s of r)s.target===e&&(t||(t=!0,queueMicrotask(o)))}).observe(e)}function Tt(e){let t=0;requestAnimationFrame(n=>{n*=.001,t=n,requestAnimationFrame(o)});function o(n){n*=.001;let r=n-t;t=n,requestAnimationFrame(o),e(r,n)}}var Lt=R(xt("frontBuffer")),k=Lt.getContext("2d"),Le=new D,z=new G(Le),rt=new j(z),it=new E("Sol",2e30,695700,0,"yellow"),st=new E("Terra",6e24,6371,335,"blue"),Ie=new F(rt),Re=new B(it,st,z),je=[Re],It=[Ie,it,st,z],De=new O(1e-5,rt,It),Xt=1e-6;i.set(it.position,-15e10,0);i.set(st.velocity,0,30);i.set(z.position,42e3,0);Mt(Lt);Tt(e=>{for(let t of je)t.update(e);k.save(),rt.predict(k,Xt);for(let t of It)t.draw(k,Xt);k.restore(),De.draw(k)});
