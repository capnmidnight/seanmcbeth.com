function U(o,t,e){return typeof o===t||o instanceof e}function g(o){return U(o,"function",Function)}function _(o){return U(o,"string",String)}function $(o){return U(o,"boolean",Boolean)}function M(o){return U(o,"number",Number)}function F(o){return a(o)&&U(o,"object",Object)}function R(o){return o instanceof Array}function b(o,t){throw new Error((t||"Unexpected object: ")+o)}function m(o){return o==null}function a(o){return!m(o)}function Ut(o){return o instanceof Uint8Array||o instanceof Uint8ClampedArray||o instanceof Int8Array||o instanceof Uint16Array||o instanceof Int16Array||o instanceof Uint32Array||o instanceof Int32Array||o instanceof Float32Array||o instanceof Float64Array||"BigUint64Array"in globalThis&&o instanceof globalThis.BigUint64Array||"BigInt64Array"in globalThis&&o instanceof globalThis.BigInt64Array}function $t(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function C(o){return o.splice(0)}function Kt(o,t){for(let e=0;e<o.length;++e)if(o[e]!==t[e])return e;return-1}function N(o,t){let e=o.indexOf(t);return e>-1?(St(o,e),!0):!1}function St(o,t){return o.splice(t,1)[0]}function Be(o,t,e){let n=o?0:t.length-1,r=o?t.length:-1,i=o?1:-1;for(let p of e)for(let c=n;c!=r;c+=i){let s=t[c];if(p(s))return s}return null}function Yt(o,...t){return Be(!0,o,t)}var G=class{constructor(){this.listeners=new Map,this.listenerOptions=new Map,this.bubblers=new Set,this.scopes=new WeakMap}addBubbler(t){this.bubblers.add(t)}removeBubbler(t){this.bubblers.delete(t)}addScopedEventListener(t,e,n,r){this.scopes.has(t)||this.scopes.set(t,[]),this.scopes.get(t).push([e,n]),this.addEventListener(e,n,r)}removeScope(t){let e=this.scopes.get(t);if(e){this.scopes.delete(t);for(let[n,r]of e)this.removeEventListener(n,r)}}addEventListener(t,e,n){let r=this.listeners.get(t);r||(r=new Array,this.listeners.set(t,r)),r.find(i=>i===e)||(r.push(e),n&&this.listenerOptions.set(e,n))}removeEventListener(t,e){let n=this.listeners.get(t);n&&this.removeListener(n,e)}clearEventListeners(t){for(let[e,n]of this.listeners)if(m(t)||t===e){for(let r of n)this.removeEventListener(t,r);C(n),this.listeners.delete(e)}}removeListener(t,e){let n=t.findIndex(r=>r===e);n>=0&&(St(t,n),this.listenerOptions.has(e)&&this.listenerOptions.delete(e))}dispatchEvent(t){let e=this.listeners.get(t.type);if(e)for(let n of e){let r=this.listenerOptions.get(n);a(r)&&!$(r)&&r.once&&this.removeListener(e,n),g(n)?n.call(this,t):n.handleEvent(t)}if(t.defaultPrevented)return!1;for(let n of this.bubblers)if(!n.dispatchEvent(t))return!1;return!0}};var et=class extends Event{get type(){return super.type}constructor(t,e){super(t,e)}},I=class extends G{addBubbler(t){super.addBubbler(t)}removeBubbler(t){super.removeBubbler(t)}addScopedEventListener(t,e,n,r){super.addScopedEventListener(t,e,n,r)}addEventListener(t,e,n){super.addEventListener(t,e,n)}removeEventListener(t,e){super.removeEventListener(t,e)}clearEventListeners(t){return super.clearEventListeners(t)}};function Zt(o,t){let e=0;M(o)?e=o:t=o;let n=!0;return(...r)=>{n&&(n=!1,setTimeout(()=>{n=!0,t(...r)},e))}}function Qt(o){if(o.status>=400)throw new Error("Resource could not be retrieved: "+o.requestPath);return o}function ot(o){let{content:t}=Qt(o);return t}var kt=class extends et{constructor(){super("closing")}},nt=class extends I{constructor(t){super(),this.fetcher=t}async close(){let t=new kt;this.dispatchEvent(t),t.defaultPrevented||await this.fetcher.post("/api/appshell/close").exec()}maximize(){return this.fetcher.post("/api/appshell/maximize").exec()}minimize(){return this.fetcher.post("/api/appshell/minimize").exec()}setMenuHidden(t){return this.fetcher.post("/api/appshell/hidemenu").body(t).exec()}getCanGoBack(){return this.fetcher.get("/api/appshell/cangoback").object().then(ot)}getCanGoForward(){return this.fetcher.get("/api/appshell/cangoforward").object().then(ot)}setMenuUI(t,e){t.classList.toggle("hidden",localStorage.getItem("menuHidden")=="true"),e.addEventListener("click",()=>{if(!t.classList.contains("hidden")){for(let r of t.children)if(r instanceof HTMLElement){let i=getComputedStyle(r),p=parseFloat(i.marginInlineStart),c=parseFloat(i.marginInlineEnd);r.style.width=t.clientWidth-p-c+"px"}}let n=t.classList.toggle("hidden");localStorage.setItem("menuHidden",n?"true":"false"),this.setMenuHidden(n)})}setCloseButton(t){t&&t.addEventListener("click",()=>this.close())}setBodyUI(t,e,n){if(t||e){let r=function(){let c=n.scrollTop>25,s=n.scrollTop+n.clientHeight<n.scrollHeight-25;t&&t.classList.toggle("visible",c),e&&e.classList.toggle("visible",s)},i=Zt(r);t&&t.addEventListener("click",()=>n.scroll({behavior:"smooth",top:0})),e&&e.addEventListener("click",()=>n.scroll({behavior:"smooth",top:n.scrollHeight})),n.addEventListener("scroll",i),new ResizeObserver(c=>{for(let s of c)s.target===document.body&&i()}).observe(document.body),r()}}setHistoryUI(t,e){t&&(t.addEventListener("click",()=>history.back()),this.getCanGoBack().then(n=>t.disabled=!n)),e&&(e.addEventListener("click",()=>history.forward()),this.getCanGoForward().then(n=>e.disabled=!n))}};function K(o){return o}function te(){return!0}function ee(){return!1}var V=class{constructor(t=!0){this.autoStart=t,this.onThens=new Array,this.onCatches=new Array,this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",this.resolve=e=>{if(this.running){this._result=e,this._resultState="resolved";for(let n of this.onThens)n(e);this.clear(),this._executionState="finished"}},this.reject=e=>{if(this.running){this._error=e,this._resultState="errored";for(let n of this.onCatches)n(e);this.clear(),this._executionState="finished"}},this.autoStart&&this.start()}clear(){C(this.onThens),C(this.onCatches)}start(){this._executionState="running"}resolver(t){return()=>this.resolve(t)}resolveOn(t,e,n){let r=this.resolver(n);t.addEventListener(e,r),this.finally(()=>t.removeEventListener(e,r))}get result(){if(a(this.error))throw this.error;return this._result}get error(){return this._error}get executionState(){return this._executionState}get waiting(){return this.executionState==="waiting"}get started(){return this.executionState!=="waiting"}get running(){return this.executionState==="running"}get finished(){return this.executionState==="finished"}get resultState(){return this._resultState}get resolved(){return this.resultState==="resolved"}get errored(){return this.resultState==="errored"}get[Symbol.toStringTag](){return this.toString()}project(){return new Promise((t,e)=>{this.finished?this.errored?e(this.error):t(this.result):(this.onThens.push(t),this.onCatches.push(e))})}then(t,e){return this.project().then(t,e)}catch(t){return this.project().catch(t)}finally(t){return this.project().finally(t)}reset(){this._reset(this.autoStart)}restart(){this._reset(!0)}_reset(t){this.running&&this.reject("Resetting previous invocation"),this.clear(),this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",t&&this.start()}};function oe(o,t){return"on"+t in o}function T(o,t,e,...n){m(n)&&(n=[]);let r;if(_(e)?n.unshift(e):M(e)&&(r=e),!(o instanceof G)){if(!oe(o,t))throw new Error(`Target does not have a ${t} rejection event`);for(let s of n)if(!oe(o,s))throw new Error(`Target does not have a ${s} rejection event`)}let i=new V;if(M(r)){let s=setTimeout(i.reject,r,`'${t}' has timed out.`);i.finally(clearTimeout.bind(globalThis,s))}let p=(s,d)=>{o.addEventListener(s,d),i.finally(()=>o.removeEventListener(s,d))};p(t,s=>i.resolve(s));let c=s=>i.reject(s);for(let s of n)p(s,c);return i}function P(o){return o.then(te).catch(ee)}var ne=/([^\/]+)\/(.+)/,Le=/(?:([^\.]+)\.)?([^\+;]+)(?:\+([^;]+))?((?:; *([^=]+)=([^;]+))*)/;var Y=class o{constructor(t,e,n){this._type=t,this._fullSubType=e,this._primaryExtension=null,this.depMessage=null;let r=new Map;this._parameters=r;let i=this._fullSubType.match(Le);this._tree=i[1],this._subType=i[2],this._suffix=i[3];let p=i[4];if(this._value=this._fullValue=this._type+"/",a(this._tree)&&(this._value=this._fullValue+=this._tree+"."),this._value=this._fullValue+=this._subType,a(this._suffix)&&(this._value=this._fullValue+="+"+this._suffix),a(p)){let c=p.split(";").map(s=>s.trim()).filter(s=>s.length>0).map(s=>s.split("="));for(let[s,...d]of c){let l=d.join("=");r.set(s,l);let v=`; ${s}=${l}`;this._fullValue+=v,s!=="q"&&(this._value+=v)}}this._extensions=n||[],this._primaryExtension=this._extensions[0]||null}static parse(t){if(!t)return null;let e=t.match(ne);if(!e)return null;let n=e[1],r=e[2];return new o(n,r)}deprecate(t){return this.depMessage=t,this}check(){a(this.depMessage)&&console.warn(`${this._value} is deprecated ${this.depMessage}`)}matches(t){if(m(t))return!1;if(this.typeName==="*"&&this.subTypeName==="*")return!0;let e=null,n=null;if(_(t)){let r=t.match(ne);if(!r)return!1;e=r[1],n=r[2]}else e=t.typeName,n=t._fullSubType;return this.typeName===e&&(this._fullSubType==="*"||this._fullSubType===n)}withParameter(t,e){let n=`${this._fullSubType}; ${t}=${e}`;return new o(this.typeName,n,this.extensions)}get typeName(){return this.check(),this._type}get tree(){return this.check(),this._tree}get suffix(){return this._suffix}get subTypeName(){return this.check(),this._subType}get value(){return this.check(),this._value}__getValueUnsafe(){return this._value}get fullValue(){return this.check(),this._fullValue}get parameters(){return this.check(),this._parameters}get extensions(){return this.check(),this._extensions}__getExtensionsUnsafe(){return this._extensions}get primaryExtension(){return this.check(),this._primaryExtension}toString(){return this.parameters.get("q")==="1"?this.value:this.fullValue}toFileSystemAPIAccepts(){return{[this.value]:this.extensions.map(t=>"."+t)}}addExtension(t){if(!t)throw new Error("File name is not defined");return this.primaryExtension&&(t=o.removeExtension(t),t=`${t}.${this.primaryExtension}`),t}static removeExtension(t){let e=t.lastIndexOf(".");return e>-1&&(t=t.substring(0,e)),t}};function Fe(o,t,...e){return new Y(o,t,e)}function S(o){return Fe.bind(null,o)}var Xt=S("application");var z=Xt("javascript","js");var Ct=Xt("json","json");var Tt=Xt("wasm","wasm");var Mt=S("text");var Z=Mt("css","css");var rt=Mt("plain","txt","text","conf","def","list","log","in");var re=Mt("xml");var ie=new Map,it=class{constructor(t,e,n,...r){this.key=t,this.value=e,this.bySetAttribute=n,this.tags=r.map(i=>i.toLocaleUpperCase()),Object.freeze(this)}applyToElement(t){if(this.tags.length>0&&this.tags.indexOf(t.tagName)===-1){let e=ie.get(t.tagName);e||ie.set(t.tagName,e=new Set),e.has(this.key)||(e.add(this.key),console.warn(`Element ${t.tagName} does not support Attribute ${this.key}`))}this.bySetAttribute?t.setAttribute(this.key,this.value.toString()):this.key in t?t[this.key]=this.value:this.value===!1?t.removeAttribute(this.key):this.value===!0?t.setAttribute(this.key,""):g(this.value)?this.value(t):t.setAttribute(this.key,this.value.toString())}};function pt(o,t,e,...n){return new it(o,t,e,...n)}function pe(o){return o instanceof it}function se(o){return pt("height",o,!1,"canvas","embed","iframe","img","input","object","video")}function It(o){return pt("rel",o,!1,"a","area","link")}function st(o){return _(o)||(o=o.value),pt("type",o,!1,"button","input","command","embed","link","object","script","source","style","menu")}function ce(o){return pt("width",o,!1,"canvas","embed","iframe","img","input","object","video")}function ae(o){return F(o)?o.element instanceof Element:!1}function Ne(o){return ae(o)?o.element:_(o)?le(o):o}function Ge(o){return F(o)&&"applyToElement"in o&&g(o.applyToElement)}function ze(o,...t){let e=o instanceof Element||o instanceof ShadowRoot?o:_(o)?document.querySelector(o):o.element,n=e instanceof HTMLTemplateElement?e.content:e;for(let r of t)a(r)&&(r instanceof Node?n.appendChild(r):ae(r)?n.appendChild(Ne(r)):Ge(r)?e instanceof ShadowRoot||r.applyToElement(e):n.appendChild(document.createTextNode(r.toLocaleString())));return e}function le(o){return document.querySelector(o)}function de(o){return le(o)}function ct(o,...t){let e=null,n=t.filter(pe).filter(r=>r.key==="id"||r.key==="query");for(let r of n)r.key==="query"?(e=r.value,N(t,r)):r.key==="id"&&(e=document.getElementById(r.value),e&&N(t,r));return e&&e.tagName!==o.toUpperCase()&&console.warn(`Expected a "${o.toUpperCase()}" element but found a "${e.tagName}".`),e||(e=document.createElement(o)),ze(e,...t),e}function me(...o){return ct("canvas",...o)}function jt(...o){return ct("img",...o)}function xe(...o){return ct("link",...o)}function ue(...o){return ct("script",...o)}var Q=class extends I{constructor(){super(...arguments),this.attached=new Array,this.soFar=null,this.total=null,this.msg=null,this.est=null}get p(){return this.total>0?this.soFar/this.total:0}report(t,e,n,r){this.soFar=t,this.total=e,this.msg=n,this.est=r;for(let i of this.attached)i.report(t,e,n,r)}attach(t){this.attached.push(t),t.report(this.soFar,this.total,this.msg,this.est)}clear(){this.report(0,0),this._clear()}start(t){this.report(0,1,t||"starting")}end(t){this.report(1,1,t||"done"),this._clear()}_clear(){this.soFar=null,this.total=null,this.msg=null,this.est=null,C(this.attached)}};var tt=class extends Q{constructor(t,e){super(),this.i=t,this.prog=e}report(t,e,n,r){super.report(t,e,n,r),this.prog.update(this.i,t,e,n)}};var at=class{constructor(t){this.prog=t,this.weightTotal=0,this.subProgressCallbacks=new Array,this.subProgressWeights=new Array,this.subProgressValues=new Array,this.start=performance.now();for(let e=0;e<this.subProgressWeights.length;++e)this.subProgressValues[e]=0,this.subProgressCallbacks[e]=new tt(e,this)}addSubProgress(t){t=t||1,this.weightTotal+=t,this.subProgressWeights.push(t),this.subProgressValues.push(0);let e=new tt(this.subProgressCallbacks.length,this);return this.subProgressCallbacks.push(e),e}update(t,e,n,r){if(this.prog){this.subProgressValues[t]=e/n;let i=0;for(let d=0;d<this.subProgressWeights.length;++d)i+=this.subProgressValues[d]*this.subProgressWeights[d];let p=performance.now(),c=p-this.start,s=this.start-p+c*this.weightTotal/i;this.prog.report(i,this.weightTotal,r,s)}}};function Pt(o,t){return new Et(t,o).subProgressCallbacks}function _e(o,t){let e=new Array(t);for(let n=0;n<t;++n)e[n]=1;return Pt(o,e)}var Et=class extends at{constructor(t,e){super(e);for(let n of t)this.addSubProgress(n)}};async function fe(o,t){let e=new Array(t.length),n=new Array(t.length);for(let p=0;p<t.length;++p){let c=t[p];e[p]=c[0],n[p]=c[1]}let r=Pt(o,e),i=new Array(t.length);for(let p=0;p<t.length;++p)i[p]=n[p](r[p]);return await Promise.all(i)}function ge(o){return a(o)&&g(o.then)&&g(o.catch)&&g(o.finally)&&g(o.fetch)&&g(o.getSize)}var he=class{get result(){if(a(this.error))throw this.error;return this._result}get error(){return this._error}get started(){return this._started}get finished(){return this._finished}constructor(t,e){this.path=t,this.type=e,this._result=null,this._error=null,this._started=!1,this._finished=!1,this.resolve=null,this.reject=null,this.promise=new Promise((n,r)=>{this.resolve=i=>{this._result=i,this._finished=!0,n(i)},this.reject=i=>{this._error=i,this._finished=!0,r(i)}})}async getSize(t){try{let{contentLength:e}=await t.head(this.path).accept(this.type).exec();return[this,e||1]}catch(e){return console.warn(e),[this,1]}}async fetch(t,e){try{let n=await this.getResult(t,e);this.resolve(n)}catch(n){this.reject(n)}}get[Symbol.toStringTag](){return this.promise.toString()}then(t,e){return this.promise.then(t,e)}catch(t){return this.promise.catch(t)}finally(t){return this.promise.finally(t)}};function Ot(o,...t){if(!F(o))return!1;o=o;for(let e of t){if(!(e in o))return!1;let n=o[e];if(!g(n))return!1}return!0}function We(o){return Ot(o,"dispose")}function Je(o){return Ot(o,"destroy")}function He(o){return Ot(o,"close")}function j(o){We(o)&&o.dispose(),He(o)&&o.close(),Je(o)&&o.destroy()}function ve(o,t){try{return t(o)}finally{j(o)}}var Vr="HTMLCanvasElement"in globalThis,wr="HTMLImageElement"in globalThis,Ae=!1,W=!Ae&&"OffscreenCanvas"in globalThis,yr=!Ae&&"createImageBitmap"in globalThis;function qe(){try{return new OffscreenCanvas(1,1).getContext("2d")!=null}catch{return!1}}var Sr=W&&qe();function Ue(){try{return new OffscreenCanvas(1,1).getContext("webgl2")!=null}catch{return!1}}var kr=W&&Ue();function be(o,t){return new OffscreenCanvas(o,t)}function Ve(o,t){return me(ce(o),se(t))}function Rt(o,t){let e=o.getContext("2d");if(m(e))throw new Error("Could not create 2d context for canvas");e.drawImage(t,0,0)}function we(o){let t=new V,e=setInterval(()=>{o()&&(clearInterval(e),t.resolve())},100);return t}async function h(o,t){let{status:e,requestPath:n,responsePath:r,content:i,contentType:p,contentLength:c,fileName:s,headers:d,date:l}=o;return{status:e,requestPath:n,responsePath:r,content:a(t)?await t(i):void 0,contentType:p,contentLength:c,fileName:s,headers:d,date:l}}var Dt=null;function ye(o){return Dt===null&&(Dt=new Audio),Dt.canPlayType(o)!==""}var lt=class{constructor(t,e,n,r=!1){this.fetcher=t,this.method=e,this.path=n,this.useBLOBs=r,this.prog=null,this.request={method:e,path:this.path.href,body:null,headers:null,timeout:null,withCredentials:!1,useCache:!1,retryCount:3}}retries(t){return this.request.retryCount=t,this}query(t,e){return this.path.searchParams.set(t,e),this.request.path=this.path.href,this}header(t,e){return this.request.headers===null&&(this.request.headers=new Map),this.request.headers.set(t.toLowerCase(),e),this}headers(t){for(let[e,n]of t.entries())this.header(e,n);return this}timeout(t){return this.request.timeout=t,this}progress(t){return this.prog=t,this}body(t,e){if(a(t)){let n=new Set,r=new Array;r.push(t);let i=!1;for(;!i&&r.length>0;){let p=r.shift();if(p&&!n.has(p))if(n.add(p),p instanceof Blob){i=!0;break}else _(p)||r.push(...Object.values(p))}if(i){let p=new FormData,c=new Map,s=new Set;for(let[d,l]of Object.entries(t))if(l instanceof Blob){let v=d+".name",x=t[v];_(x)&&(c.set(l,x),s.add(v))}for(let[d,l]of Object.entries(t))s.has(d)||(l instanceof Blob?p.append(d,l,c.get(l)):_(l)?p.append(d,l):a(l)&&g(l.toString)?p.append(d,l.toString()):console.warn("Can't serialize value to formdata",d,l));t=p,e=void 0}this.request.body=t,this.content(e)}return this}withCredentials(){return this.request.withCredentials=!0,this}useCache(t=!0){return this.request.useCache=t,this}media(t,e){a(e)&&(_(e)||(e=e.value),this.header(t,e))}content(t){this.media("content-type",t)}accept(t){return this.media("accept",t),this}blob(t){if(this.accept(t),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetBlob(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetBlob(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);b(this.method)}buffer(t){if(this.accept(t),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetBuffer(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetBuffer(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);b(this.method)}async file(t){if(this.accept(t),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return await this.fetcher.sendObjectGetFile(this.request,this.prog);if(this.method==="GET"){if(this.useBLOBs)return await this.fetcher.sendNothingGetFile(this.request,this.prog);{let e=await this.fetcher.sendNothingGetNothing(this.request);return h(e,()=>this.request.path)}}else{if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);b(this.method)}}async dataUri(t){let e=await this.blob(t),n=new FileReader,r=new Promise(p=>n.addEventListener("loadend",c=>p(c.target.result)));n.readAsDataURL(e.content);let i=await r;return await h(e,()=>i)}text(t){if(this.accept(t||rt),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetText(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetText(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);b(this.method)}object(t){if(this.accept(t||Ct),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetObject(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetObject(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);b(this.method)}xml(t){if(this.accept(t||re),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetXml(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetXml(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);b(this.method)}imageBitmap(t){if(this.accept(t),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetImageBitmap(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetImageBitmap(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);b(this.method)}exec(){if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetNothing(this.request,this.prog);if(this.method==="GET")throw new Error("GET requests should expect a response type");if(this.method==="HEAD"||this.method==="OPTIONS")return this.fetcher.sendNothingGetNothing(this.request);b(this.method)}async audioBlob(t){if(a(t)&&(_(t)||(t=t.value),!ye(t)))throw new Error(`Probably can't play file of type "${t}" at path: ${this.request.path}`);let e=await this.blob(t);if(ye(e.contentType))return e;throw new Error(`Cannot play file of type "${e.contentType}" at path: ${this.request.path}`)}async audioBuffer(t,e){return h(await this.audioBlob(e),async n=>await t.decodeAudioData(await n.arrayBuffer()))}async htmlElement(t,e,n){let r=await this.file(n),i=T(t,e,"error");return t instanceof HTMLLinkElement?t.href=r.content:t.src=r.content,await i,await h(r,()=>t)}image(t){return this.htmlElement(jt(),"load",t)}async htmlCanvas(t){let e=Ve(1,1);if(this.method==="GET")if(W){this.accept(t);let n=await this.fetcher.drawImageToCanvas(this.request,e.transferControlToOffscreen(),this.prog);return await h(n,()=>e)}else{let n=await this.image(t);return await h(n,r=>(e.width=r.width,e.height=r.height,Rt(e,r),j(r),e))}else{if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE"||this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);b(this.method)}}canvas(t){return W?this.offscreenCanvas(t):this.htmlCanvas(t)}async offscreenCanvas(t){if(!W)throw new Error("This system does not support OffscreenCanvas");if(this.method==="GET"){let e=await this.image(t);return await h(e,n=>{let r=be(n.width,n.height);return Rt(r,n),j(n),r})}else{if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE"||this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);b(this.method)}}async style(){let t=xe(st(Z),It("stylesheet"));document.head.append(t);let e=await this.htmlElement(t,"load",Z);return h(e)}async getScript(){let t=ue(st(z));document.head.append(t);let e=await this.htmlElement(t,"load",z);return h(e)}async script(t){let e=null,n=this.request.path;if(!t)e=await this.getScript();else if(!t()){let r=we(t);e=await this.getScript(),await r}return this.prog&&this.prog.end(n),e}async module(){let t=this.request.path,e=await this.file(z),n=await import(e.content);return this.prog&&this.prog.end(t),h(e,()=>n)}async wasm(t){let e=await this.buffer(Tt);if(!Tt.matches(e.contentType))throw new Error(`Server did not respond with WASM file. Was: ${e.contentType}`);let n=await WebAssembly.compile(e.content),r=await WebAssembly.instantiate(n,t);return h(e,()=>r.exports)}async worker(t="module"){let e=this.request.path,n=await this.file(z);this.prog=null,this.request.timeout=null;let r=new Worker(n.content,{type:t});return this.prog&&this.prog.end(e),h(n,()=>r)}};var dt=class{constructor(t,e=!1){this.service=t,this.useBLOBs=e;{let n=de("input[name=__RequestVerificationToken]");n&&this.service.setRequestVerificationToken(n.value)}}clearCache(){return this.service.clearCache()}evict(t,e){return this.service.evict(new URL(t,e||location.href).href)}request(t,e,n){return new lt(this.service,t,new URL(e,n||location.href),this.useBLOBs)}head(t,e){return this.request("HEAD",t,e)}options(t,e){return this.request("OPTIONS",t,e)}get(t,e){return this.request("GET",t,e)}post(t,e){return this.request("POST",t,e)}put(t,e){return this.request("PUT",t,e)}patch(t,e){return this.request("PATCH",t,e)}delete(t,e){return this.request("DELETE",t,e)}async assets(t,e,...n){m(n)&&(n=[]),n.unshift(e);let r;ge(t)?n.unshift(t):a(t)&&(r=t),n=n.filter(a);let i=await Promise.all(n.map(c=>c.getSize(this))),p=new Map(i);await fe(r,n.map(c=>[p.get(c),s=>c.fetch(this,s)]))}};var mt=class{constructor(t){this.impl=t,this.defaultPostHeaders=new Map}setRequestVerificationToken(t){this.defaultPostHeaders.set("RequestVerificationToken",t)}clearCache(){return this.impl.clearCache()}evict(t){return this.impl.evict(t)}sendNothingGetNothing(t){return this.impl.sendNothingGetNothing(t)}sendNothingGetBlob(t,e){return this.impl.sendNothingGetSomething("blob",t,e)}sendObjectGetBlob(t,e){return this.impl.sendSomethingGetSomething("blob",t,this.defaultPostHeaders,e)}sendNothingGetBuffer(t,e){return this.impl.sendNothingGetSomething("arraybuffer",t,e)}sendObjectGetBuffer(t,e){return this.impl.sendSomethingGetSomething("arraybuffer",t,this.defaultPostHeaders,e)}sendNothingGetText(t,e){return this.impl.sendNothingGetSomething("text",t,e)}sendObjectGetText(t,e){return this.impl.sendSomethingGetSomething("text",t,this.defaultPostHeaders,e)}sendNothingGetObject(t,e){return this.impl.sendNothingGetSomething("json",t,e)}sendObjectGetObject(t,e){return this.impl.sendSomethingGetSomething("json",t,this.defaultPostHeaders,e)}sendObjectGetNothing(t,e){return this.impl.sendSomethingGetSomething("",t,this.defaultPostHeaders,e)}drawImageToCanvas(t,e,n){return this.impl.drawImageToCanvas(t,e,n)}async sendNothingGetFile(t,e){return h(await this.sendNothingGetBlob(t,e),URL.createObjectURL)}async sendObjectGetFile(t,e){return h(await this.sendObjectGetBlob(t,e),URL.createObjectURL)}async sendNothingGetXml(t,e){return h(await this.impl.sendNothingGetSomething("document",t,e),n=>n.documentElement)}async sendObjectGetXml(t,e){return h(await this.impl.sendSomethingGetSomething("document",t,this.defaultPostHeaders,e),n=>n.documentElement)}async sendNothingGetImageBitmap(t,e){return h(await this.sendNothingGetBlob(t,e),createImageBitmap)}async sendObjectGetImageBitmap(t,e){return h(await this.sendObjectGetBlob(t,e),createImageBitmap)}};function Se(o,t,e){return new Map(o.map(n=>[t(n),e(n)]))}function ke(o,t){return Se(o,t,K)}var D=class{constructor(t){if(this.items=new Map,this.defaultItems=new Array,a(t))for(let[e,n]of t)this.add(e,n)}add(t,...e){for(let n of e)if(m(t))this.defaultItems.push(n);else{let r=this.items.get(t);m(r)&&this.items.set(t,r=[]),r.push(n)}return this}entries(){return this.items.entries()}[Symbol.iterator](){return this.entries()}keys(){return this.items.keys()}*values(){for(let t of this.defaultItems)yield t;for(let t of this.items.values())for(let e of t)yield e}has(t){return a(t)?this.items.has(t):this.defaultItems.length>0}get(t){return m(t)?this.defaultItems:this.items.get(t)||[]}count(t){if(m(t))return this.defaultItems.length;let e=this.get(t);return a(e)?e.length:0}get size(){let t=this.defaultItems.length;for(let e of this.items.values())t+=e.length;return t}delete(t){return m(t)?C(this.defaultItems).length>0:this.items.delete(t)}remove(t,e){if(m(t))N(this.defaultItems,e);else{let n=this.items.get(t);a(n)&&(N(n,e),n.length===0&&this.items.delete(t))}}clear(){this.items.clear(),C(this.defaultItems)}};var L=class{constructor(t){if(this.items=new Map,a(t))for(let[e,n,r]of t)this.add(e,n,r)}add(t,e,n){let r=this.items.get(t);return m(r)&&this.items.set(t,r=new Map),r.set(e,n),this}*entries(){for(let[t,e]of this.items)for(let[n,r]of e)yield[t,n,r]}keys(t){return m(t)?this.items.keys():this.items.get(t).keys()}*values(){for(let t of this.items.values())for(let e of t.values())yield e}has(t,e){return this.items.has(t)&&(m(e)||this.items.get(t).has(e))}get(t,e){return m(e)?this.items.get(t):this.items.has(t)?this.items.get(t).get(e):null}count(t){return this.items.has(t)?this.items.get(t).size:null}get size(){let t=0;for(let e of this.items.values())t+=e.size;return t}delete(t,e){if(m(e))return this.items.delete(t);if(this.items.has(t)){let n=this.items.get(t),r=n.delete(e);return n.size===0&&this.items.delete(t),r}else return!1}clear(){this.items.clear()}};var xt=class o{static delete(t){let e=indexedDB.deleteDatabase(t),n=T(e,"success","error","blocked");return P(n)}static async open(t,...e){let n=ke(e,A=>A.name),r=new L(e.filter(A=>a(A.indexes)).flatMap(A=>A.indexes.map(X=>[A.name,X.name,X]))),i=new Array,p=new Array,c=new Array,s=new D,d=new D,l=null,v=indexedDB.open(t);if(await P(T(v,"success","error","blocked"))){let A=v.result;l=A.version;let X=new Array;for(let w of A.objectStoreNames)n.has(w)||p.push(w);for(let w of n.keys())A.objectStoreNames.contains(w)?X.push(w):i.push(w);if(X.length>0){let w=A.transaction(X),y=T(w,"complete","error","abort"),O=P(y);for(let f of X){let B=w.objectStore(f),qt=n.get(f);a(qt.options)&&B.keyPath!==qt.options.keyPath&&(p.push(f),i.push(f));for(let E of B.indexNames)r.has(f,E)||(c.indexOf(f)===-1&&c.push(f),d.add(f,E));if(r.has(f))for(let E of r.get(f).keys())if(!B.indexNames.contains(E))c.indexOf(f)===-1&&c.push(f),s.add(f,E);else{let H=r.get(f,E),q=B.index(E);(_(H.keyPath)!==_(q.keyPath)||_(H.keyPath)&&_(q.keyPath)&&H.keyPath!==q.keyPath||R(H.keyPath)&&R(q.keyPath)&&Kt(H.keyPath,q.keyPath))&&(c.indexOf(f)===-1&&c.push(f),d.add(f,E),s.add(f,E))}}w.commit(),await O}j(A)}else{l=0,i.push(...n.keys());for(let A of e)if(a(A.indexes))for(let X of A.indexes)s.add(A.name,X.name)}(i.length>0||p.length>0||s.size>0||d.size>0)&&++l;let x=new V,u=a(l)?indexedDB.open(t,l):indexedDB.open(t),k=T(u,"success","error","blocked"),J=P(x),yt=P(k),Ht=x.resolver(!1);if(u.addEventListener("success",Ht),u.addEventListener("upgradeneeded",()=>{let A=T(u.transaction,"complete","error","abort"),X=u.result;for(let y of p)X.deleteObjectStore(y);let w=new Map;for(let y of i){let O=n.get(y),f=X.createObjectStore(y,O.options);w.set(y,f)}for(let y of c){let O=u.transaction.objectStore(y);w.set(y,O)}for(let[y,O]of w){for(let f of d.get(y))O.deleteIndex(f);for(let f of s.get(y)){let B=r.get(y,f);O.createIndex(f,B.keyPath,B.options)}}P(A).then(x.resolve).catch(x.reject).finally(()=>u.removeEventListener("success",Ht))}),!await J)throw x.error;if(!await yt)throw k.error;return new o(u.result)}constructor(t){this.db=t}dispose(){j(this.db)}get name(){return this.db.name}get version(){return this.db.version}get storeNames(){return Array.from(this.db.objectStoreNames)}getStore(t){return new Bt(this.db,t)}},Bt=class{constructor(t,e){this.db=t,this.storeName=e}async request(t,e){let n=this.db.transaction(this.storeName,e),r=T(n,"complete","error"),i=n.objectStore(this.storeName),p=t(i),c=T(p,"success","error");if(!await P(c))throw n.abort(),c.error;if(n.commit(),!await P(r))throw r.error;return p.result}add(t,e){return this.request(n=>n.add(t,e),"readwrite")}clear(){return this.request(t=>t.clear(),"readwrite")}getCount(t){return this.request(e=>e.count(t),"readonly")}async has(t){return await this.getCount(t)>0}delete(t){return this.request(e=>e.delete(t),"readwrite")}get(t){return this.request(e=>e.get(t),"readonly")}getAll(){return this.request(t=>t.getAll(),"readonly")}getAllKeys(){return this.request(t=>t.getAllKeys(),"readonly")}getKey(t){return this.request(e=>e.getKey(t),"readonly")}openCursor(t,e){return this.request(n=>n.openCursor(t,e),"readonly")}openKeyCursor(t,e){return this.request(n=>n.openKeyCursor(t,e),"readonly")}put(t,e){return this.request(n=>n.put(t,e),"readwrite")}};function Xe(o,...t){for(let e of t)if(a(e))for(let[n,r]of e)o.set(n,r);return o}var Lt=class extends V{constructor(t){super(!1),this.milliseconds=t,this._timer=null}start(){super.start(),this._timer=setTimeout(()=>{this._timer=null,this.resolve()},this.milliseconds)}reset(){super.reset(),a(this._timer)&&(clearTimeout(this._timer),this._timer=null)}};function Ce(o){let t=new Lt(o);return t.start(),t}function ut(o,t){return async()=>{let e=null,n=500;for(let r=0;r<=o;++r)try{return r>0&&(await Ce(n),n*=2),await t()}catch(i){e=i}throw e}}function $e(o){return _(o)||Ut(o)||o instanceof Blob||o instanceof FormData||$t(o)||"Document"in globalThis&&o instanceof Document}function _t(o,t,e,n,r,i){let p=!i;i&&i.then(()=>p=!0);let c=!1,s=r,d=new V;e.addEventListener("loadstart",()=>{p&&!c&&n&&n.start(o)}),e.addEventListener("progress",v=>{if(p&&!c){let x=v;n&&n.report(x.loaded,Math.max(x.loaded,x.total),o),x.loaded===x.total&&(s=!0,c&&d.resolve())}}),e.addEventListener("load",()=>{p&&!c&&(n&&n.end(o),c=!0,s&&d.resolve())});let l=v=>()=>{p&&d.reject(`${v} (${t.status})`)};return e.addEventListener("error",l("error")),e.addEventListener("abort",l("abort")),e.addEventListener("timeout",l("timeout")),d}function Ft(o,t,e,n,r,i){if(o.open(t,e),o.responseType="blob",o.timeout=n,r)for(let[p,c]of r)o.setRequestHeader(p,c);a(i)?o.send(i):o.send()}function ft(o,t,e){if(!o.has(t))return null;let n=o.get(t);try{let r=e(n);return o.delete(t),r}catch(r){console.warn(t,r)}return null}var Ke=/filename=\"(.+)\"(;|$)/,Ye="Juniper:Fetcher:Cache",ht=class{constructor(){this.cache=null,this.store=null,this.tasks=new L,this.cacheReady=this.openCache()}async drawImageToCanvas(t,e,n){let r=await this.sendNothingGetSomething("blob",t,n),i=r.content;return ve(await createImageBitmap(i,{imageOrientation:"from-image"}),p=>(e.width=p.width,e.height=p.height,e.getContext("2d").drawImage(p,0,0),h(r)))}async openCache(){let t={keyPath:"requestPath"};this.cache=await xt.open(Ye,{name:"files",options:t}),this.store=await this.cache.getStore("files")}async clearCache(){await this.cacheReady,await this.store.clear()}async evict(t){await this.cacheReady,this.store.has(t)&&await this.store.delete(t)}async readResponseHeaders(t,e){let n=e.getAllResponseHeaders().split(/[\r\n]+/).map(x=>x.trim()).filter(x=>x.length>0).map(x=>{let u=x.split(": "),k=u.shift().toLowerCase(),J=u.join(": ");return[k,J]}),r=new D(n),i=Array.from(r.keys()).map(x=>[x,r.get(x).join(", ")]),p=new Map(i),c=ft(p,"content-type",K),s=ft(p,"content-length",parseFloat),d=ft(p,"date",x=>new Date(x)),l=ft(p,"content-disposition",x=>{if(a(x)){let u=x.match(Ke);if(a(u))return u[1]}return null});return{status:e.status,requestPath:t,responsePath:e.responseURL,content:void 0,contentType:c,contentLength:s,fileName:l,date:d,headers:p}}async readResponse(t,e){let{responsePath:n,status:r,contentType:i,contentLength:p,fileName:c,date:s,headers:d}=await this.readResponseHeaders(t,e),l={requestPath:t,responsePath:n,status:r,contentType:i,contentLength:p,fileName:c,date:s,headers:d,content:e.response};return a(l.content)&&(l.contentType=l.contentType||l.content.type,l.contentLength=l.contentLength||l.content.size),l}async decodeContent(t,e){return h(e,async n=>{if(t==="")return null;if(m(e.contentType)){let r=Array.from(e.headers.entries()).map(i=>i.join(": ")).join(`
  `);throw new Error(`No content type found in headers: 
  `+r)}else{if(t==="blob")return n;if(t==="arraybuffer")return await n.arrayBuffer();if(t==="json"){let r=await n.text();return r.length>0?JSON.parse(r):null}else if(t==="document"){let r=new DOMParser;if(e.contentType==="application/xhtml+xml"||e.contentType==="text/html"||e.contentType==="application/xml"||e.contentType==="image/svg+xml"||e.contentType==="text/xml")return r.parseFromString(await n.text(),e.contentType);throw new Error("Couldn't parse document")}else{if(t==="text")return await n.text();b(t)}}})}async withCachedTask(t,e){return t.method!=="GET"&&t.method!=="HEAD"&&t.method!=="OPTIONS"?await e():(this.tasks.has(t.method,t.path)||this.tasks.add(t.method,t.path,e().finally(()=>this.tasks.delete(t.method,t.path))),this.tasks.get(t.method,t.path))}sendNothingGetNothing(t){return this.withCachedTask(t,ut(t.retryCount,async()=>{let e=new XMLHttpRequest,n=_t(`requesting: ${t.path}`,e,e,null,!0);return Ft(e,t.method,t.path,t.timeout,t.headers),await n,await this.readResponseHeaders(t.path,e)}))}sendNothingGetSomething(t,e,n){return this.withCachedTask(e,ut(e.retryCount,async()=>{let r=null,i=e.useCache&&e.method==="GET";i&&(a(n)&&n.start(),await this.cacheReady,r=await this.store.get(e.path));let p=m(r);if(p){let s=new XMLHttpRequest,d=_t(`requesting: ${e.path}`,s,s,n,!0);Ft(s,e.method,e.path,e.timeout,e.headers),await d,r=await this.readResponse(e.path,s),i&&await this.store.add(r)}let c=await this.decodeContent(t,r);return p&&a(n)&&n.end(),c}))}sendSomethingGetSomething(t,e,n,r){let i=null,p=Xe(new Map,n,e.headers),c=null;if(a(p)){let u=new Array;for(let k of p.keys())k.toLowerCase()==="content-type"&&u.push(k);if(u.length>0){e.body instanceof FormData||(c=p.get(u[0]),u.shift());for(let k of u)p.delete(k)}}$e(e.body)&&!_(e.body)||_(e.body)&&rt.matches(c)?i=e.body:a(e.body)&&(i=JSON.stringify(e.body));let s=a(i),d=_e(r,s?2:1),[l,v]=d,x=async()=>{let u=new XMLHttpRequest,k=s?_t("uploading",u,u.upload,l,!1):Promise.resolve(),J=_t("saving",u,u,v,!0,k);Ft(u,e.method,e.path,e.timeout,p,i),await k,await J;let yt=await this.readResponse(e.path,u);return await this.decodeContent(t,yt)};return ut(e.retryCount,x)()}};function Nt(o){return a(o)&&g(o.report)&&g(o.attach)&&g(o.end)}var Ze=/OculusBrowser\/(\d+)\.(\d+)\.(\d+)/i,gt=navigator.userAgent.match(Ze),vt=!!gt,Ri=vt&&{major:parseFloat(gt[1]),minor:parseFloat(gt[2]),patch:parseFloat(gt[3])},Di=vt&&/pacific/i.test(navigator.userAgent),Bi=vt&&/quest/i.test(navigator.userAgent),Li=vt&&/quest 2/i.test(navigator.userAgent);var Gt="Worker"in globalThis;var At=class extends I{constructor(t){super(),this.worker=t,this.invocations=new Map,this.tasks=new Array,this.taskCounter=0,Gt||console.warn("Workers are not supported on this system."),this.worker.addEventListener("message",e=>{let n=e.data;switch(n.type){case"event":this.propogateEvent(n);break;case"progress":this.progressReport(n);break;case"return":this.methodReturned(n);break;case"error":this.invocationError(n);break;default:b(n)}})}postMessage(t,e){t.type!=="methodCall"&&b(t.type),e?this.worker.postMessage(t,e):this.worker.postMessage(t)}dispose(){this.worker.terminate()}progressReport(t){let e=this.invocations.get(t.taskID);if(e){let{prog:n}=e;n&&n.report(t.soFar,t.total,t.msg,t.est)}}methodReturned(t){let e=this.removeInvocation(t.taskID),{task:n}=e;n.resolve(t.returnValue)}invocationError(t){let e=this.removeInvocation(t.taskID),{task:n,methodName:r}=e;n.reject(new Error(`${r} failed. Reason: ${t.errorMessage}`))}removeInvocation(t){let e=this.invocations.get(t);return this.invocations.delete(t),e}callMethod(t,e,n,r){if(!Gt)return Promise.reject(new Error("Workers are not supported on this system."));let i=null,p=null;Nt(e)&&(r=e,e=null,n=null),Nt(n)&&!r&&(r=n,n=null),R(e)&&(i=e),R(n)&&(p=n);let c=this.taskCounter++,s=Yt(this.tasks,v=>v.finished);s?s.reset():(s=new V,this.tasks.push(s));let d={methodName:t,task:s,prog:r};this.invocations.set(c,d);let l=null;return a(e)?l={type:"methodCall",taskID:c,methodName:t,params:i}:l={type:"methodCall",taskID:c,methodName:t},this.postMessage(l,p),s}};var bt=class extends I{constructor(t,e){super(),this.scriptPath=t.scriptPath;let n=-1,r=t.workers,i=null;if(M(r)?n=r:a(r)?(this.taskCounter=r.curTaskCounter,i=r.workers,n=i.length):n=navigator.hardwareConcurrency||4,n<1)throw new Error("Worker pool size must be a postive integer greater than 0");if(this.workers=new Array(n),m(i)){this.taskCounter=0;for(let p=0;p<n;++p)this.workers[p]=new e(new Worker(this.scriptPath,{type:"module"}))}else for(let p=0;p<n;++p)this.workers[p]=new e(i[p]);for(let p of this.workers)p.addBubbler(this)}dispose(){this.workers.forEach(j),C(this.workers)}nextWorker(){let t=this.peekWorker();return this.taskCounter++,t}peekWorker(){return this.workers[this.taskCounter%this.workers.length]}};function Qe(o){return o==="application/xhtml+xml"||o==="application/xml"||o==="image/svg+xml"||o==="text/html"||o==="text/xml"}function Te(o){let{status:t,requestPath:e,responsePath:n,content:r,contentType:i,contentLength:p,fileName:c,headers:s,date:d}=o;if(!Qe(i))throw new Error(`Content-Type ${i} is not one supported by the DOM parser.`);let v=new TextDecoder().decode(r),u=new DOMParser().parseFromString(v,i);return{status:t,requestPath:e,responsePath:n,content:u.documentElement,contentType:i,contentLength:p,fileName:c,date:d,headers:s}}function Me(o){let{status:t,requestPath:e,responsePath:n,content:r,contentType:i,contentLength:p,fileName:c,headers:s,date:d}=o,l=new Blob([r],{type:i});return{status:t,requestPath:e,responsePath:n,content:l,contentType:i,contentLength:p,fileName:c,date:d,headers:s}}function Ie(o){return o={method:o.method,path:o.path,timeout:o.timeout,headers:o.headers,withCredentials:o.withCredentials,useCache:o.useCache,retryCount:o.retryCount},o}function to(o){return o={method:o.method,path:o.path,body:o.body,timeout:o.timeout,headers:o.headers,withCredentials:o.withCredentials,useCache:o.useCache,retryCount:o.retryCount},o}var Vt=class extends At{setRequestVerificationToken(t){this.callMethod("setRequestVerificationToken",[t])}clearCache(){return this.callMethod("clearCache")}evict(t){return this.callMethod("evict",[t])}propogateEvent(t){}makeRequest(t,e,n){return this.callMethod(t,[Ie(e)],n)}makeRequestWithBody(t,e,n){return this.callMethod(t,[to(e)],n)}sendNothingGetNothing(t){return this.makeRequest("sendNothingGetNothing",t,null)}sendNothingGetBuffer(t,e){return this.makeRequest("sendNothingGetBuffer",t,e)}sendNothingGetText(t,e){return this.makeRequest("sendNothingGetText",t,e)}sendNothingGetObject(t,e){return this.makeRequest("sendNothingGetObject",t,e)}sendNothingGetFile(t,e){return this.makeRequest("sendNothingGetFile",t,e)}sendNothingGetImageBitmap(t,e){return this.makeRequest("sendNothingGetImageBitmap",t,e)}sendObjectGetNothing(t,e){return this.makeRequestWithBody("sendObjectGetNothing",t,e)}sendObjectGetBuffer(t,e){return this.makeRequestWithBody("sendObjectGetBuffer",t,e)}sendObjectGetText(t,e){return this.makeRequestWithBody("sendObjectGetText",t,e)}sendObjectGetObject(t,e){return this.makeRequestWithBody("sendObjectGetObject",t,e)}sendObjectGetFile(t,e){return this.makeRequestWithBody("sendObjectGetFile",t,e)}sendObjectGetImageBitmap(t,e){return this.makeRequestWithBody("sendObjectGetImageBitmap",t,e)}drawImageToCanvas(t,e,n){return this.callMethod("drawImageToCanvas",[Ie(t),e],[e],n)}sendNothingGetBlob(t,e){return this.sendNothingGetBuffer(t,e).then(Me)}sendNothingGetXml(t,e){return this.sendNothingGetBuffer(t,e).then(Te)}sendObjectGetBlob(t,e){return this.sendObjectGetBuffer(t,e).then(Me)}sendObjectGetXml(t,e){return this.sendObjectGetBuffer(t,e).then(Te)}};var wt=class extends bt{constructor(t,e){super(t,Vt),this.fetcher=e}getFetcher(t){return t instanceof FormData?this.fetcher:this.nextWorker()}setRequestVerificationToken(t){this.fetcher.setRequestVerificationToken(t);for(let e of this.workers)e.setRequestVerificationToken(t)}async clearCache(){await Promise.all(this.workers.map(t=>t.clearCache()))}async evict(t){await Promise.all(this.workers.map(e=>e.evict(t)))}sendNothingGetNothing(t){return this.nextWorker().sendNothingGetNothing(t)}sendNothingGetBlob(t,e){return this.nextWorker().sendNothingGetBlob(t,e)}sendNothingGetBuffer(t,e){return this.nextWorker().sendNothingGetBuffer(t,e)}sendNothingGetFile(t,e){return this.nextWorker().sendNothingGetFile(t,e)}sendNothingGetText(t,e){return this.nextWorker().sendNothingGetText(t,e)}sendNothingGetObject(t,e){return this.nextWorker().sendNothingGetObject(t,e)}sendNothingGetXml(t,e){return this.nextWorker().sendNothingGetXml(t,e)}sendNothingGetImageBitmap(t,e){return this.nextWorker().sendNothingGetImageBitmap(t,e)}drawImageToCanvas(t,e,n){return this.nextWorker().drawImageToCanvas(t,e,n)}sendObjectGetBlob(t,e){return this.getFetcher(t.body).sendObjectGetBlob(t,e)}sendObjectGetBuffer(t,e){return this.getFetcher(t.body).sendObjectGetBuffer(t,e)}sendObjectGetFile(t,e){return this.getFetcher(t.body).sendObjectGetFile(t,e)}sendObjectGetText(t,e){return this.getFetcher(t.body).sendObjectGetText(t,e)}sendObjectGetNothing(t,e){return this.getFetcher(t.body).sendObjectGetNothing(t,e)}sendObjectGetObject(t,e){return this.getFetcher(t.body).sendObjectGetObject(t,e)}sendObjectGetXml(t,e){return this.getFetcher(t.body).sendObjectGetXml(t,e)}sendObjectGetImageBitmap(t,e){return this.getFetcher(t.body).sendObjectGetImageBitmap(t,e)}};var eo=new URL(globalThis.location.href),zt=eo.searchParams.has("DEBUG"),je=zt?".js":".min.js";function Ee(o,t){let e=globalThis,n=e[o];if(m(n)){if(m(t))throw new Error(`No value ${o} found`);n=t(),e[o]=n}return n}var Ap=Ee("juniper::loadedFonts",()=>[]);var Pe="0.0.1";var Oe=Pe;var Wt="JUNIPER::FETCHER";function Re(){if(Wt in window)return window[Wt];let o=new mt(new ht);o=new wt({scriptPath:`/js/workers/fetcher/index${je}?${Oe}`},o);let t=new dt(o,!zt);return Object.assign(window,{[Wt]:t}),t}var Jt="JUNIPER::APPSHELL";function De(){if(Jt in window)return window[Jt];let o=Re(),t=new nt(o);return t.setCloseButton(document.querySelector("#closeBtn")),Object.assign(window,{[Jt]:t}),t}De();
