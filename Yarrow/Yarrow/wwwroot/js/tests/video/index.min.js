var lr=Object.defineProperty;var Sn=(n,e)=>{for(var t in e)lr(n,t,{get:e[t],enumerable:!0})};var Vn=["change","click","contextmenu","dblclick","mouseup","pointerup","reset","submit","touchend"];function ve(n,e=!1){let t=async o=>{if(o.isTrusted){if(!e)for(let r of Vn)window.removeEventListener(r,t);n()}};for(let o of Vn)window.addEventListener(o,t)}function Ae(n,e,t){return typeof n===e||n instanceof t}function A(n){return Ae(n,"function",Function)}function h(n){return Ae(n,"string",String)}function re(n){return Ae(n,"boolean",Boolean)}function Y(n){return Ae(n,"number",Number)}function be(n){return l(n)&&Ae(n,"object",Object)}function ye(n){return n instanceof Array}function y(n,e){throw new Error((e||"Unexpected object: ")+n)}function u(n){return n==null}function l(n){return!u(n)}function Cn(n){return n instanceof Uint8Array||n instanceof Uint8ClampedArray||n instanceof Int8Array||n instanceof Uint16Array||n instanceof Int16Array||n instanceof Uint32Array||n instanceof Int32Array||n instanceof Float32Array||n instanceof Float64Array||"BigUint64Array"in globalThis&&n instanceof globalThis.BigUint64Array||"BigInt64Array"in globalThis&&n instanceof globalThis.BigInt64Array}function wn(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function cr(n){return n}function dr(n,e,t){let o=0,r=n.length,i=Math.floor((o+r)/2),s=!1;for(;o<r&&i<n.length;){let a=n[i],p=u(a)?null:t(a);l(p)&&e<p?r=i:(e===p&&(s=!0),o=i+1),i=Math.floor((o+r)/2)}return s||(i+=.5),i}function mr(n,e,t){t=t||cr;let o=t(e);return dr(n,o,t)}function I(n){return n.splice(0)}function Tn(n,e){for(let t=0;t<n.length;++t)if(n[t]!==e[t])return t;return-1}function Bt(n,e,t){n.splice(t,0,e)}function J(n,e){let t=n.indexOf(e);return t>-1?(jt(n,t),!0):!1}function jt(n,e){return n.splice(e,1)[0]}function ur(n,e,t){let o=n?0:e.length-1,r=n?e.length:-1,i=n?1:-1;for(let s of t)for(let a=o;a!=r;a+=i){let p=e[a];if(s(p))return p}return null}function Se(n,...e){return ur(!0,n,e)}function Nt(n,e,t,o){let r;return A(t)?r=t:re(t)&&(o=t),u(o)&&(o=!0),xr(n,e,r,o)}function xr(n,e,t,o){let r=mr(n,e,t),i=r%1===0;return r=r|0,(!i||o)&&Bt(n,e,r),r}function En(n,e){n.sort((t,o)=>{let r=e(t),i=e(o);return r<i?-1:r>i?1:0})}function fr(n){return n[0]}function _r(n){return n.shift()}function hr(n){return n[n.length-1]}function gr(n){return n.pop()}var $e=class{constructor(e){this.value=e;this._forward=new Array;this._reverse=new Array}connectSorted(e,t){l(t)?(Nt(this._forward,e,o=>t(o.value)),Nt(e._reverse,this,o=>t(o.value))):this.connectTo(e)}connectTo(e){this.connectAt(e,this._forward.length)}connectAt(e,t){Bt(this._forward,e,t),e._reverse.push(this)}disconnectFrom(e){J(this._forward,e),J(e._reverse,this)}isConnectedTo(e){return this._forward.indexOf(e)>=0||this._reverse.indexOf(e)>=0}flatten(){let e=new Set,t=[this];for(;t.length>0;){let o=t.shift();l(o)&&!e.has(o)&&(e.add(o),t.push(...o._forward))}return Array.from(e)}*traverse(e){let t=new Set,o=[this],r=e?fr:hr,i=e?_r:gr;for(;o.length>0;){let s=r(o);t.has(s)?e||(i(o),yield s):(t.add(s),e&&(i(o),yield s),s._forward.length>0&&o.push(...s._forward))}}breadthFirst(){return this.traverse(!0)}depthFirst(){return this.traverse(!1)}search(e,t=!0){for(let o of this.traverse(t))if(e(o))return o;return null}*searchAll(e,t=!0){for(let o of this.traverse(t))e(o)&&(yield o)}find(e,t=!0){return this.search(o=>o.value===e,t)}findAll(e,t=!0){return this.searchAll(o=>o.value===e,t)}contains(e,t=!0){for(let o of this.traverse(t))if(o===e)return!0;return!1}containsValue(e,t=!0){for(let o of this.traverse(t))if(o.value===e)return!0;return!1}get _isEntryPoint(){return this._reverse.length===0}get _isExitPoint(){return this._forward.length===0}get isDisconnected(){return this._isEntryPoint&&this._isExitPoint}get isConnected(){return!this._isExitPoint||!this._isEntryPoint}get isTerminus(){return this._isEntryPoint||this._isExitPoint}get isInternal(){return!this._isEntryPoint&&!this._isExitPoint}};var Ye=class extends $e{get connections(){return this._forward}get isEntryPoint(){return this._isEntryPoint}get isExitPoint(){return this._isExitPoint}};var S=class{constructor(e=!0){this.autoStart=e;this.onThens=new Array;this.onCatches=new Array;this._result=void 0;this._error=void 0;this._executionState="waiting";this._resultState="none";this.resolve=t=>{if(this.running){this._result=t,this._resultState="resolved";for(let o of this.onThens)o(t);this.clear(),this._executionState="finished"}},this.reject=t=>{if(this.running){this._error=t,this._resultState="errored";for(let o of this.onCatches)o(t);this.clear(),this._executionState="finished"}},this.autoStart&&this.start()}clear(){I(this.onThens),I(this.onCatches)}start(){this._executionState="running"}resolver(e){return()=>this.resolve(e)}resolveOn(e,t,o){let r=this.resolver(o);e.addEventListener(t,r),this.finally(()=>e.removeEventListener(t,r))}get result(){if(l(this.error))throw this.error;return this._result}get error(){return this._error}get executionState(){return this._executionState}get waiting(){return this.executionState==="waiting"}get started(){return this.executionState!=="waiting"}get running(){return this.executionState==="running"}get finished(){return this.executionState==="finished"}get resultState(){return this._resultState}get resolved(){return this.resultState==="resolved"}get errored(){return this.resultState==="errored"}get[Symbol.toStringTag](){return this.toString()}project(){return new Promise((e,t)=>{this.finished?this.errored?t(this.error):e(this.result):(this.onThens.push(e),this.onCatches.push(t))})}then(e,t){return this.project().then(e,t)}catch(e){return this.project().catch(e)}finally(e){return this.project().finally(e)}reset(){this._reset(this.autoStart)}restart(){this._reset(!0)}_reset(e){this.running&&this.reject("Resetting previous invocation"),this.clear(),this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",e&&this.start()}};function Ve(n){return l(n)&&"_resolveInput"in n}function Ce(n){return Ve(n)&&"_resolveOutput"in n}var we=class{constructor(){this.listeners=new Map;this.listenerOptions=new Map}addEventListener(e,t,o){if(A(t)){let r=this.listeners.get(e);r||(r=new Array,this.listeners.set(e,r)),r.find(i=>i===t)||(r.push(t),o&&this.listenerOptions.set(t,o))}}removeEventListener(e,t){if(A(t)){let o=this.listeners.get(e);o&&this.removeListener(o,t)}}clearEventListeners(e){for(let[t,o]of this.listeners)if(u(e)||e===t){for(let r of o)this.removeEventListener(e,r);I(o),this.listeners.delete(t)}}removeListener(e,t){let o=e.findIndex(r=>r===t);o>=0&&(jt(e,o),this.listenerOptions.has(t)&&this.listenerOptions.delete(t))}dispatchEvent(e){let t=this.listeners.get(e.type);if(t)for(let o of t){let r=this.listenerOptions.get(o);l(r)&&!re(r)&&r.once&&this.removeListener(t,o),o.call(this,e)}return!e.defaultPrevented}},w=class extends Event{get type(){return super.type}constructor(e,t){super(e,t)}},q=class extends we{constructor(){super(...arguments);this.bubblers=new Set;this.scopes=new WeakMap}addBubbler(t){this.bubblers.add(t)}removeBubbler(t){this.bubblers.delete(t)}addEventListener(t,o,r){super.addEventListener(t,o,r)}removeEventListener(t,o){super.removeEventListener(t,o)}clearEventListeners(t){return super.clearEventListeners(t)}addScopedEventListener(t,o,r,i){this.scopes.has(t)||this.scopes.set(t,[]),this.scopes.get(t).push([o,r]),this.addEventListener(o,r,i)}removeScope(t){let o=this.scopes.get(t);if(o){this.scopes.delete(t);for(let[r,i]of o)this.removeEventListener(r,i)}}dispatchEvent(t){if(!super.dispatchEvent(t))return!1;if(!t.cancelBubble){for(let o of this.bubblers)if(!o.dispatchEvent(t))return!1}return!0}};var pe=class extends q{constructor(t,o){super();this.nodeType=t;this.context=o;this._name=null;this.disposed=!1}get name(){return this._name}set name(t){this._name=t,this.context._name(this,t)}dispose(){this.disposed||(this.disposed=!0,this.onDisposing())}onDisposing(){}isConnected(t,o,r){return this.context._isConnected(this,t,o,r)}resolveOutput(t){let o={source:this,output:t};for(;Ce(o.source);)o=o.source._resolveOutput(o.output);return o}resolveInput(t){let o={destination:this,input:t};for(;Ve(o.destination);)o=o.destination._resolveInput(o.input);return o}toggle(t,o,r){this._toggle(t,o,r)}_toggle(t,o,r){if(this.isConnected(t,o,r))this._disconnect(t,o,r);else return this._connect(t,o,r)}connect(t,o,r){return this._connect(t,o,r)}_connect(t,o,r){return this.context._connect(this,t,o,r)}disconnect(t,o,r){this._disconnect(t,o,r)}_disconnect(t,o,r){this.context._disconnect(this,t,o,r)}};var f=class extends pe{constructor(t,o,r){super(t,o);this._node=r;this.context._init(this._node,this.nodeType)}onDisposing(){this.disconnect(),this.context._dispose(this._node),super.onDisposing()}parent(t){this.context._parent(this,t)}get channelCount(){return this._node.channelCount}set channelCount(t){this._node.channelCount=t}get channelCountMode(){return this._node.channelCountMode}set channelCountMode(t){this._node.channelCountMode=t}get channelInterpretation(){return this._node.channelInterpretation}set channelInterpretation(t){this._node.channelInterpretation=t}get numberOfInputs(){return this._node.numberOfInputs}get numberOfOutputs(){return this._node.numberOfOutputs}_resolveInput(t){return{destination:this._node,input:t}}_resolveOutput(t){return{source:this._node,output:t}}};var Qe=class extends f{constructor(e,t){super("analyser",e,new AnalyserNode(e,t))}get fftSize(){return this._node.fftSize}set fftSize(e){this._node.fftSize=e}get frequencyBinCount(){return this._node.frequencyBinCount}get maxDecibels(){return this._node.maxDecibels}set maxDecibels(e){this._node.maxDecibels=e}get minDecibels(){return this._node.minDecibels}set minDecibels(e){this._node.minDecibels=e}get smoothingTimeConstant(){return this._node.smoothingTimeConstant}set smoothingTimeConstant(e){this._node.smoothingTimeConstant=e}getByteFrequencyData(e){this._node.getByteFrequencyData(e)}getByteTimeDomainData(e){this._node.getByteTimeDomainData(e)}getFloatFrequencyData(e){this._node.getFloatFrequencyData(e)}getFloatTimeDomainData(e){this._node.getFloatTimeDomainData(e)}};var g=class{constructor(e,t,o){this.nodeType=e;this.context=t;this.param=o;this._name=null;this.disposed=!1;this.context._init(this.param,this.nodeType)}get name(){return this._name}set name(e){this._name=e,this.context._name(this,e)}dispose(){this.disposed||(this.disposed=!0,this.onDisposing())}onDisposing(){this.context._dispose(this.param)}get automationRate(){return this.param.automationRate}set automationRate(e){this.param.automationRate=e}get defaultValue(){return this.param.defaultValue}get maxValue(){return this.param.maxValue}get minValue(){return this.param.minValue}get value(){return this.param.value}set value(e){this.param.value=e}cancelAndHoldAtTime(e){return this.param.cancelAndHoldAtTime(e),this}cancelScheduledValues(e){return this.param.cancelScheduledValues(e),this}exponentialRampToValueAtTime(e,t){return this.param.exponentialRampToValueAtTime(e,t),this}linearRampToValueAtTime(e,t){return this.param.linearRampToValueAtTime(e,t),this}setTargetAtTime(e,t,o){return this.param.setTargetAtTime(e,t,o),this}setValueAtTime(e,t){return this.param.setValueAtTime(e,t),this}setValueCurveAtTime(e,t,o){return this.param.setValueCurveAtTime(e,t,o),this}_resolveInput(){return{destination:this.param}}resolveInput(){return this._resolveInput()}};var Ze=class extends f{constructor(t,o){super("audio-buffer-source",t,new AudioBufferSourceNode(t,o));this._node.addEventListener("ended",()=>this.dispatchEvent(new w("ended"))),this.parent(this.playbackRate=new g("playbackRate",t,this._node.playbackRate)),this.parent(this.detune=new g("detune",t,this._node.detune))}get buffer(){return this._node.buffer}set buffer(t){this._node.buffer=t}get loop(){return this._node.loop}set loop(t){this._node.loop=t}get loopEnd(){return this._node.loopEnd}set loopEnd(t){this._node.loopEnd=t}get loopStart(){return this._node.loopStart}set loopStart(t){this._node.loopStart=t}get onended(){return this._node.onended}set onended(t){this._node.onended=t}start(t,o,r){this._node.start(t,o,r)}stop(t){this._node.stop(t)}};var et=class extends f{constructor(e,t){super("destination",e,t)}get maxChannelCount(){return this._node.maxChannelCount}};var Q=class extends f{constructor(t,o){super("biquad-filter",t,new BiquadFilterNode(t,o));this.parent(this.Q=new g("Q",this.context,this._node.Q)),this.parent(this.detune=new g("detune",this.context,this._node.detune)),this.parent(this.frequency=new g("frequency",this.context,this._node.frequency)),this.parent(this.gain=new g("gain",this.context,this._node.gain))}get type(){return this._node.type}set type(t){this._node.type=t}getFrequencyResponse(t,o,r){this._node.getFrequencyResponse(t,o,r)}};var tt=class extends f{constructor(e,t){super("channel-merger",e,new ChannelMergerNode(e,t))}};var nt=class extends f{constructor(e,t){super("channel-splitter",e,new ChannelSplitterNode(e,t))}};var ot=class extends f{constructor(t,o){super("constant-source",t,new ConstantSourceNode(t,o));this._node.addEventListener("ended",()=>this.dispatchEvent(new w("ended"))),this.parent(this.offset=new g("offset",this.context,this._node.offset))}get onended(){return this._node.onended}set onended(t){this._node.onended=t}start(t){this._node.start(t)}stop(t){this._node.stop(t)}};var rt=class extends f{constructor(e,t){super("convolver",e,new ConvolverNode(e,t))}get buffer(){return this._node.buffer}set buffer(e){this._node.buffer=e}get normalize(){return this._node.normalize}set normalize(e){this._node.normalize=e}};var it=class extends f{constructor(t,o){super("delay",t,new DelayNode(t,o));this.parent(this.delayTime=new g("delay",this.context,this._node.delayTime))}};var st=class extends f{constructor(t,o){super("dynamics-compressor",t,new DynamicsCompressorNode(t,o));this.parent(this.attack=new g("attack",this.context,this._node.attack)),this.parent(this.knee=new g("knee",this.context,this._node.knee)),this.parent(this.ratio=new g("ratio",this.context,this._node.ratio)),this.parent(this.release=new g("release",this.context,this._node.release)),this.parent(this.threshold=new g("threshold",this.context,this._node.threshold))}get reduction(){return this._node.reduction}};var U=class extends f{constructor(t,o){super("gain",t,new GainNode(t,o));this.parent(this.gain=new g("gain",this.context,this._node.gain))}};var at=class extends f{constructor(e,t){super("iir-filter",e,new IIRFilterNode(e,t))}getFrequencyResponse(e,t,o){this._node.getFrequencyResponse(e,t,o)}};var Z=class extends f{constructor(e,t){super("media-element-audio-source",e,new MediaElementAudioSourceNode(e,t))}get mediaElement(){return this._node.mediaElement}};var Te=class extends f{constructor(e,t){super("media-stream-audio-destination",e,new MediaStreamAudioDestinationNode(e,t))}get stream(){return this._node.stream}};function le(n){return n}function Pn(){return!0}function In(){return!1}var T=class{constructor(e,t,o,...r){this.key=e;this.value=t;this.bySetAttribute=o;this.tags=r.map(i=>i.toLocaleUpperCase()),Object.freeze(this)}applyToElement(e){let t=this.key.startsWith("data-");if(!(this.tags.length===0||this.tags.indexOf(e.tagName)>-1||t))console.warn(`Element ${e.tagName} does not support Attribute ${this.key}`);else if(t){let r=this.key.substring(5);e.dataset[r]=this.value}else if(this.key==="style")Object.assign(e.style,this.value);else if(this.key==="classList"){let r=this.value.filter(le);r.length>0&&r.forEach(i=>e.classList.add(i))}else this.bySetAttribute?e.setAttribute(this.key,this.value):this.key in e?e[this.key]=this.value:this.value===!1?e.removeAttribute(this.key):this.value===!0?e.setAttribute(this.key,""):e.setAttribute(this.key,this.value)}};function Ee(n){return new T("autoplay",n,!1,"audio","video")}function Mn(...n){return new T("classList",n,!1)}function ie(n){return new T("controls",n,!1,"audio","video")}function kn(n){return new T("height",n,!1,"canvas","embed","iframe","img","input","object","video")}function Pe(n){return new T("loop",n,!1,"audio","bgsound","marquee","video")}function Rn(n){return new T("muted",n,!1,"audio","video")}function Ln(n){return new T("rel",n,!1,"a","area","link")}function vr(n){return n instanceof URL&&(n=n.href),n}function pt(n){return new T("src",vr(n),!1,"audio","embed","iframe","img","input","script","source","track","video")}function Ft(n){return new T("srcObject",n,!1,"audio","video")}function Ie(n){return h(n)||(n=n.value),new T("type",n,!1,"button","input","command","embed","link","object","script","source","style","menu")}function On(n){return new T("value",n,!1,"button","data","input","li","meter","option","progress","param")}function Dn(n){return new T("width",n,!1,"canvas","embed","iframe","img","input","object","video")}function lt(...n){return`rgb(${n.join(", ")})`}var Gt=class{constructor(e){this._value=e}get value(){return this._value}toString(){return this.value}};var zt=class extends Gt{constructor(t,o,r){super(r);this._name=t;this.sep=o}get name(){return this._name}toString(){return this.name+this.sep+this.value+";"}};var Ht=class extends zt{constructor(e,t){super(e,": ",t)}},Me=class extends Ht{constructor(t,o){super(t.replace(/[A-Z]/g,r=>`-${r.toLocaleLowerCase()}`),o.toString());this.key=t;this.priority=""}applyToElement(t){t.style[this.key]=this.value+this.priority}important(){return this.priority=" !important",this}get value(){return super.value+this.priority}};function ct(n){return new Me("cursor",n)}function ke(n){return new Me("display",n)}function dt(n){return new Me("opacity",n)}var ee=class extends Error{constructor(t,o=null){super(t);this.innerError=o}};function Xn(n,e){return"on"+e in n}function C(n,e,t,...o){u(o)&&(o=[]);let r;if(h(t)?o.unshift(t):Y(t)&&(r=t),!(n instanceof we)){if(!Xn(n,e))throw new ee(`Target does not have a ${e} rejection event`);for(let p of o)if(!Xn(n,p))throw new ee(`Target does not have a ${p} rejection event`)}let i=new S;if(Y(r)){let p=setTimeout(i.reject,r,`'${e}' has timed out.`);i.finally(clearTimeout.bind(globalThis,p))}let s=(p,c)=>{n.addEventListener(p,c),i.finally(()=>n.removeEventListener(p,c))};s(e,p=>i.resolve(p));let a=p=>i.reject(p);for(let p of o)s(p,a);return i}function G(n){return n.then(Pn).catch(In)}function Bn(n){return be(n)?n.element instanceof Element:!1}function Wt(n){return Bn(n)?n.element:h(n)?jn(n):n}function Ar(n){return be(n)&&"applyToElement"in n&&A(n.applyToElement)}function Jt(n,e,t=""){n=Wt(n),n.style.display=e?t:"none"}function z(n,...e){n=Wt(n);for(let t of e)l(t)&&(t instanceof Node?n.append(t):Bn(t)?n.append(Wt(t)):Ar(t)?t.applyToElement(n):n.append(document.createTextNode(t.toLocaleString())));return n}function jn(n){return document.querySelector(n)}function Nn(n){return jn(n)}function H(n,...e){let t=null;for(let o of e)if(o instanceof T&&o.key==="id"){t=document.getElementById(o.value);break}return t==null&&(t=document.createElement(n)),z(t,...e),t}async function br(n,e,t){l(t)&&t.start();let o=n==="canplay"?e.HAVE_CURRENT_DATA:e.HAVE_ENOUGH_DATA;if(e.readyState>=o)return!0;try{return await C(e,n,"error"),!0}catch(r){return console.warn(e.error,r),!1}finally{l(t)&&t.end()}}function Fn(n,e){return br("canplaythrough",n,e)}function ce(...n){return H("audio",...n)}function Gn(){return H("br")}function yr(...n){return H("button",...n)}function Sr(...n){return yr(...n,Ie("button"))}function zn(...n){return Sr(...n,Mn("btn","btn-primary"))}function Hn(...n){return H("canvas",...n)}function Wn(...n){return H("div",...n)}function Re(...n){return H("img",...n)}function Jn(...n){return H("link",...n)}function qt(...n){return H("option",...n)}function qn(...n){return H("script",...n)}function Un(...n){return H("select",...n)}function Kn(...n){return H("video",...n)}var Vr="AudioContext"in globalThis,$n=Vr&&"AudioListener"in globalThis,Cr=$n&&"setPosition"in AudioListener.prototype,Yn=$n&&"positionX"in AudioListener.prototype,Ut="createMediaStreamSource"in AudioContext.prototype,Ga=A(HTMLMediaElement.prototype.captureStream)||A(HTMLMediaElement.prototype.mozCaptureStream);var Le=class extends f{constructor(t,o){let r=ce(ie(!1),Rn(Ut),Ee(!0),Pe(!1),ke("none"),Ft(o.mediaStream)),i;Ut?i=new MediaStreamAudioSourceNode(t,o):i=new MediaElementAudioSourceNode(t,{mediaElement:r});super("media-stream-audio-source",t,i);this._stream=o.mediaStream,this._element=r}onDisposing(){this._element.pause(),super.onDisposing()}get mediaStream(){return this._stream}};var mt=class extends f{constructor(t,o){super("oscillator",t,new OscillatorNode(t,o));this._node.addEventListener("ended",()=>this.dispatchEvent(new w("ended"))),this.parent(this.detune=new g("detune",this.context,this._node.detune)),this.parent(this.frequency=new g("frequency",this.context,this._node.frequency))}get type(){return this._node.type}set type(t){this._node.type=t}get onended(){return this._node.onended}set onended(t){this._node.onended=t}setPeriodicWave(t){this._node.setPeriodicWave(t)}start(t){this._node.start(t)}stop(t){this._node.stop(t)}};var Oe=class extends f{constructor(t,o){super("panner",t,new PannerNode(t,o));this.parent(this.positionX=new g("positionX",this.context,this._node.positionX)),this.parent(this.positionY=new g("positionY",this.context,this._node.positionY)),this.parent(this.positionZ=new g("positionZ",this.context,this._node.positionZ)),this.parent(this.orientationX=new g("orientationX",this.context,this._node.orientationX)),this.parent(this.orientationY=new g("orientationY",this.context,this._node.orientationY)),this.parent(this.orientationZ=new g("orientationZ",this.context,this._node.orientationZ))}get coneInnerAngle(){return this._node.coneInnerAngle}set coneInnerAngle(t){this._node.coneInnerAngle=t}get coneOuterAngle(){return this._node.coneOuterAngle}set coneOuterAngle(t){this._node.coneOuterAngle=t}get coneOuterGain(){return this._node.coneOuterGain}set coneOuterGain(t){this._node.coneOuterGain=t}get distanceModel(){return this._node.distanceModel}set distanceModel(t){this._node.distanceModel=t}get maxDistance(){return this._node.maxDistance}set maxDistance(t){this._node.maxDistance=t}get panningModel(){return this._node.panningModel}set panningModel(t){this._node.panningModel=t}get refDistance(){return this._node.refDistance}set refDistance(t){this._node.refDistance=t}get rolloffFactor(){return this._node.rolloffFactor}set rolloffFactor(t){this._node.rolloffFactor=t}setOrientation(t,o,r){this._node.setOrientation(t,o,r)}setPosition(t,o,r){this._node.setPosition(t,o,r)}};var ut=class extends f{constructor(t,o){super("stereo-panner",t,new StereoPannerNode(t,o));this.parent(this.pan=new g("pan",this.context,this._node.pan))}};var xt=class extends f{constructor(e,t){super("wave-shaper",e,new WaveShaperNode(e,t))}get curve(){return this._node.curve}set curve(e){this._node.curve=e}get oversample(){return this._node.oversample}set oversample(e){this._node.oversample=e}};!("AudioContext"in globalThis)&&"webkitAudioContext"in globalThis&&(globalThis.AudioContext=globalThis.webkitAudioContext);!("OfflineAudioContext"in globalThis)&&"webkitOfflineAudioContext"in globalThis&&(globalThis.OfflineAudioContext=globalThis.webkitOfflineAudioContext);var Kt=class{constructor(e,t){this.type=e;this.name=t;this.connections=new Set}};function ft(n,e,t,o,r){return n.type===e&&(u(t)||t===n.destination)&&(u(o)||o===n.output)&&(u(r)||r===n.input)}function de(n,e){let t=null,o=null;return l(n)&&({destination:t,input:o}=n.resolveInput(e)),{destination:t,input:o}}var De=class extends AudioContext{constructor(t){super(t);this.counters=new Map;this.nodes=new Map;this._ready=new S;this._destination=new et(this,super.destination),this.state==="running"?this._ready.resolve():this.state==="closed"?this.resume().then(()=>this._ready.resolve()):ve(()=>this.resume().then(()=>this._ready.resolve())),this.ready.then(()=>console.log("Audio is now ready"))}get ready(){return this._ready}get isReady(){return this._ready.finished&&this._ready.resolved}_init(t,o){if(!this.nodes.has(t)){this.counters.has(o)||this.counters.set(o,0);let r=this.counters.get(o),i=`${o}-${r}`;this.nodes.set(t,new Kt(o,i)),Ve(t)&&(t.name=i),this.counters.set(o,r+1)}}_name(t,o){let{destination:r}=de(t);if(this.nodes.has(r)){let i=this.nodes.get(r);i.name=`${o}-${i.type}`}}_dispose(t){this.nodes.delete(t)}_isConnected(t,o,r,i){let{source:s,output:a}=t.resolveOutput(r),{destination:p,input:c}=de(o,i);if(u(s)||!this.nodes.has(s))return null;{let d=this.nodes.get(s);for(let x of d.connections)if(ft(x,"conn",p,a,c))return!0;return!1}}_parent(t,o){let{source:r}=t.resolveOutput(),{destination:i}=de(o);this.nodes.has(r)&&this.nodes.get(r).connections.add({type:"parent",src:t,dest:o,destination:i,source:r})}_unparent(t,o){let{source:r}=t.resolveOutput(),{destination:i}=de(o);if(this.nodes.has(r)){let s=this.nodes.get(r).connections,a=new Set;for(let p of s)ft(p,"parent",i)&&a.add(p);for(let p of a)s.delete(p)}}_getConnections(t){return this.nodes.has(t)?this.nodes.get(t).connections:null}_connect(t,o,r,i){let{source:s,output:a}=t.resolveOutput(r),{destination:p,input:c}=de(o,i);if(this.nodes.has(s)){let d=this.nodes.get(s).connections,x=!1;for(let m of d)ft(m,"conn",p,a,c)&&(x=!0);x||d.add({type:"conn",src:t,dest:o,outp:r,inp:i,source:s,destination:p,output:a,input:c})}if(p instanceof AudioNode)return o=o,l(c)?(s.connect(p,a,c),o):l(a)?(s.connect(p,a),o):(s.connect(p),o);p instanceof AudioParam?l(a)?s.connect(p,a):l(p)?s.connect(p):y(p):y(p)}_disconnect(t,o,r,i){let s;Y(o)?(s=void 0,r=o):s=o;let{source:a,output:p}=t.resolveOutput(r),{destination:c,input:d}=de(s,i);if(this.nodes.has(a)){let x=this.nodes.get(a).connections,m=new Set;for(let _ of x)ft(_,"conn",c,p,d)&&m.add(_);for(let _ of m)x.delete(_)}c instanceof AudioNode?l(i)?a.disconnect(c,r,i):l(r)?a.disconnect(c,r):l(c)?a.disconnect(c):a.disconnect():l(r)?a.disconnect(c,r):l(c)?a.disconnect(c):a.disconnect()}getAudioGraph(t){let o=new Map;for(let[r,i]of this.nodes){let s=r instanceof AudioNode?"node":r instanceof AudioParam?"param":"unknown";(t||s!=="param")&&o.set(r,new Ye({name:i.name,type:i.type,nodeClass:s}))}for(let[r,i]of this.nodes){let s=o.get(r);for(let a of i.connections){let p=a.destination;if(o.has(p)){let c=o.get(p);s.connectTo(c),c.connectTo(s)}}}return Array.from(o.values())}get destination(){return this._destination}createAnalyser(){return new Qe(this)}createBiquadFilter(){return new Q(this)}createBufferSource(){return new Ze(this)}createChannelMerger(t){return new tt(this,{numberOfInputs:t})}createChannelSplitter(t){return new nt(this,{numberOfOutputs:t})}createConstantSource(){return new ot(this)}createConvolver(){return new rt(this)}createDelay(t){return new it(this,{maxDelayTime:t})}createDynamicsCompressor(){return new st(this)}createGain(){return new U(this)}createIIRFilter(t,o){return new at(this,{feedforward:t,feedback:o})}createMediaElementSource(t){return new Z(this,{mediaElement:t})}createMediaStreamDestination(){return new Te(this)}createMediaStreamSource(t){return new Le(this,{mediaStream:t})}createOscillator(){return new mt(this)}createPanner(){return new Oe(this)}createStereoPanner(){return new ut(this)}createWaveShaper(){return new xt(this)}createScriptProcessor(){throw new Error("Script processor nodes are deprecated")}};function $t(n,...e){if(!be(n))return!1;n=n;for(let t of e){if(!(t in n))return!1;let o=n[t];if(!A(o))return!1}return!0}function wr(n){return $t(n,"dispose")}function Tr(n){return $t(n,"destroy")}function Er(n){return $t(n,"close")}function M(n){wr(n)&&n.dispose(),Er(n)&&n.close(),Tr(n)&&n.destroy()}function Qn(n,e){try{return e(n)}finally{M(n)}}var D=class extends pe{constructor(t,o,r,i,s){super(t,o);r=r||[],s=s||[];let a=i||r;this.inputs=r;let p=r.filter(Ce).map(c=>c);this.outputs=a.filter(Ce).map(c=>c),this.allNodes=Array.from(new Set([...p,...this.outputs,...s]))}get exemplar(){return this.allNodes[0]}add(t){this.allNodes.push(t),this.context._parent(this,t)}remove(t){J(this.allNodes,t),this.context._unparent(this,t)}onDisposing(){this.allNodes.forEach(M),super.onDisposing()}get channelCount(){return this.exemplar.channelCount}set channelCount(t){this.allNodes.forEach(o=>o.channelCount=t)}get channelCountMode(){return this.exemplar.channelCountMode}set channelCountMode(t){this.allNodes.forEach(o=>o.channelCountMode=t)}get channelInterpretation(){return this.exemplar.channelInterpretation}set channelInterpretation(t){this.allNodes.forEach(o=>o.channelInterpretation=t)}get numberOfInputs(){return this.inputs.length}get numberOfOutputs(){return this.outputs.length}static resolve(t,o){return o=o||0,o<0||t.length<=o?null:t[o]}_resolveInput(t){return{destination:D.resolve(this.inputs,t)}}_resolveOutput(t){return{source:D.resolve(this.outputs,t)}}};var Xe=class extends D{constructor(t,o,r,i,s,a){super(t,o,i,s,a);this.spatialized=r;this._minDistance=1;this._maxDistance=10;this._algorithm="inverse"}get minDistance(){return this._minDistance}get maxDistance(){return this._maxDistance}get algorithm(){return this._algorithm}setAudioProperties(t,o,r){this._minDistance=t,this._maxDistance=o,this._algorithm=r}};var Be=class extends Xe{constructor(e){super("no-spatializer",e.context,!1,[e],[e])}readPose(e){}getGainAtDistance(e){return 1}};var je=class extends q{constructor(){super(...arguments);this.attached=new Array;this.soFar=null;this.total=null;this.msg=null;this.est=null}get p(){return this.total>0?this.soFar/this.total:0}report(t,o,r,i){this.soFar=t,this.total=o,this.msg=r,this.est=i;for(let s of this.attached)s.report(t,o,r,i)}attach(t){this.attached.push(t),t.report(this.soFar,this.total,this.msg,this.est)}clear(){this.report(0,0),this._clear()}start(t){this.report(0,1,t||"starting")}end(t){this.report(1,1,t||"done"),this._clear()}_clear(){this.soFar=null,this.total=null,this.msg=null,this.est=null,I(this.attached)}};var Yt=class{constructor(e,t,o){this.name=e;this.callback=t;if(!A(t))throw new Error("A function instance is required for this parameter");this.opts=o,Object.freeze(this)}applyToElement(e){this.add(e)}add(e){e.addEventListener(this.name,this.callback,this.opts)}remove(e){e.removeEventListener(this.name,this.callback)}};function Zn(n,e,t){return new Yt(n,e,t)}function eo(n,e){return Zn("input",n,e)}function _t(...n){return Promise.all(n)}var Ne=class extends je{constructor(t,o){super();this.i=t;this.prog=o}report(t,o,r,i){super.report(t,o,r,i),this.prog.update(this.i,t,o,r)}};var ht=class{constructor(e){this.prog=e;this.weightTotal=0;this.subProgressCallbacks=new Array;this.subProgressWeights=new Array;this.subProgressValues=new Array;this.start=performance.now();for(let t=0;t<this.subProgressWeights.length;++t)this.subProgressValues[t]=0,this.subProgressCallbacks[t]=new Ne(t,this)}addSubProgress(e){e=e||1,this.weightTotal+=e,this.subProgressWeights.push(e),this.subProgressValues.push(0);let t=new Ne(this.subProgressCallbacks.length,this);return this.subProgressCallbacks.push(t),t}update(e,t,o,r){if(this.prog){this.subProgressValues[e]=t/o;let i=0;for(let c=0;c<this.subProgressWeights.length;++c)i+=this.subProgressValues[c]*this.subProgressWeights[c];let s=performance.now(),a=s-this.start,p=this.start-s+a*this.weightTotal/i;this.prog.report(i,this.weightTotal,r,p)}}};function Fe(n,e){return new Qt(e,n).subProgressCallbacks}function to(n,e){let t=new Array(e);for(let o=0;o<e;++o)t[o]=1;return Fe(n,t)}var Qt=class extends ht{constructor(e,t){super(t);for(let o of e)this.addSubProgress(o)}};function no(n){if(n.status>=400)throw new Error("Resource could not be retrieved: "+n.requestPath);return n}function Ge(n){let{content:e}=no(n);return e}var Pr=/OculusBrowser\/(\d+)\.(\d+)\.(\d+)/i,gt=navigator.userAgent.match(Pr),vt=!!gt,ml=vt&&{major:parseFloat(gt[1]),minor:parseFloat(gt[2]),patch:parseFloat(gt[3])},ul=vt&&/pacific/i.test(navigator.userAgent),xl=vt&&/quest/i.test(navigator.userAgent),fl=vt&&/quest 2/i.test(navigator.userAgent);var Ir="Worker"in globalThis;var X=1e-6,E=typeof Float32Array<"u"?Float32Array:Array,te=Math.random;var vl=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});function oo(){var n=new E(9);return E!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}var me={};Sn(me,{add:()=>ki,calculateW:()=>bi,clone:()=>Ei,conjugate:()=>Ci,copy:()=>Ii,create:()=>tn,dot:()=>Mo,equals:()=>Bi,exactEquals:()=>Xi,exp:()=>To,fromEuler:()=>wi,fromMat3:()=>Po,fromValues:()=>Pi,getAngle:()=>hi,getAxisAngle:()=>_i,identity:()=>fi,invert:()=>Vi,len:()=>Oi,length:()=>ko,lerp:()=>Li,ln:()=>Eo,mul:()=>Ri,multiply:()=>wo,normalize:()=>nn,pow:()=>yi,random:()=>Si,rotateX:()=>gi,rotateY:()=>vi,rotateZ:()=>Ai,rotationTo:()=>ji,scale:()=>Io,set:()=>Mi,setAxes:()=>Fi,setAxisAngle:()=>Co,slerp:()=>Vt,sqlerp:()=>Ni,sqrLen:()=>Di,squaredLength:()=>Ro,str:()=>Ti});var F={};Sn(F,{add:()=>Or,angle:()=>ti,bezier:()=>qr,ceil:()=>Dr,clone:()=>kr,copy:()=>Rr,create:()=>bt,cross:()=>ze,dist:()=>li,distance:()=>po,div:()=>pi,divide:()=>ao,dot:()=>St,equals:()=>ii,exactEquals:()=>ri,floor:()=>Xr,forEach:()=>mi,fromValues:()=>yt,hermite:()=>Jr,inverse:()=>Hr,len:()=>en,length:()=>ro,lerp:()=>Wr,max:()=>jr,min:()=>Br,mul:()=>ai,multiply:()=>so,negate:()=>zr,normalize:()=>Zt,random:()=>Ur,rotateX:()=>Qr,rotateY:()=>Zr,rotateZ:()=>ei,round:()=>Nr,scale:()=>Fr,scaleAndAdd:()=>Gr,set:()=>Lr,sqrDist:()=>ci,sqrLen:()=>di,squaredDistance:()=>lo,squaredLength:()=>co,str:()=>oi,sub:()=>si,subtract:()=>io,transformMat3:()=>$r,transformMat4:()=>Kr,transformQuat:()=>Yr,zero:()=>ni});function bt(){var n=new E(3);return E!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function kr(n){var e=new E(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function ro(n){var e=n[0],t=n[1],o=n[2];return Math.hypot(e,t,o)}function yt(n,e,t){var o=new E(3);return o[0]=n,o[1]=e,o[2]=t,o}function Rr(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function Lr(n,e,t,o){return n[0]=e,n[1]=t,n[2]=o,n}function Or(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function io(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function so(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n}function ao(n,e,t){return n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n}function Dr(n,e){return n[0]=Math.ceil(e[0]),n[1]=Math.ceil(e[1]),n[2]=Math.ceil(e[2]),n}function Xr(n,e){return n[0]=Math.floor(e[0]),n[1]=Math.floor(e[1]),n[2]=Math.floor(e[2]),n}function Br(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n}function jr(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n}function Nr(n,e){return n[0]=Math.round(e[0]),n[1]=Math.round(e[1]),n[2]=Math.round(e[2]),n}function Fr(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function Gr(n,e,t,o){return n[0]=e[0]+t[0]*o,n[1]=e[1]+t[1]*o,n[2]=e[2]+t[2]*o,n}function po(n,e){var t=e[0]-n[0],o=e[1]-n[1],r=e[2]-n[2];return Math.hypot(t,o,r)}function lo(n,e){var t=e[0]-n[0],o=e[1]-n[1],r=e[2]-n[2];return t*t+o*o+r*r}function co(n){var e=n[0],t=n[1],o=n[2];return e*e+t*t+o*o}function zr(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}function Hr(n,e){return n[0]=1/e[0],n[1]=1/e[1],n[2]=1/e[2],n}function Zt(n,e){var t=e[0],o=e[1],r=e[2],i=t*t+o*o+r*r;return i>0&&(i=1/Math.sqrt(i)),n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n}function St(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function ze(n,e,t){var o=e[0],r=e[1],i=e[2],s=t[0],a=t[1],p=t[2];return n[0]=r*p-i*a,n[1]=i*s-o*p,n[2]=o*a-r*s,n}function Wr(n,e,t,o){var r=e[0],i=e[1],s=e[2];return n[0]=r+o*(t[0]-r),n[1]=i+o*(t[1]-i),n[2]=s+o*(t[2]-s),n}function Jr(n,e,t,o,r,i){var s=i*i,a=s*(2*i-3)+1,p=s*(i-2)+i,c=s*(i-1),d=s*(3-2*i);return n[0]=e[0]*a+t[0]*p+o[0]*c+r[0]*d,n[1]=e[1]*a+t[1]*p+o[1]*c+r[1]*d,n[2]=e[2]*a+t[2]*p+o[2]*c+r[2]*d,n}function qr(n,e,t,o,r,i){var s=1-i,a=s*s,p=i*i,c=a*s,d=3*i*a,x=3*p*s,m=p*i;return n[0]=e[0]*c+t[0]*d+o[0]*x+r[0]*m,n[1]=e[1]*c+t[1]*d+o[1]*x+r[1]*m,n[2]=e[2]*c+t[2]*d+o[2]*x+r[2]*m,n}function Ur(n,e){e=e||1;var t=te()*2*Math.PI,o=te()*2-1,r=Math.sqrt(1-o*o)*e;return n[0]=Math.cos(t)*r,n[1]=Math.sin(t)*r,n[2]=o*e,n}function Kr(n,e,t){var o=e[0],r=e[1],i=e[2],s=t[3]*o+t[7]*r+t[11]*i+t[15];return s=s||1,n[0]=(t[0]*o+t[4]*r+t[8]*i+t[12])/s,n[1]=(t[1]*o+t[5]*r+t[9]*i+t[13])/s,n[2]=(t[2]*o+t[6]*r+t[10]*i+t[14])/s,n}function $r(n,e,t){var o=e[0],r=e[1],i=e[2];return n[0]=o*t[0]+r*t[3]+i*t[6],n[1]=o*t[1]+r*t[4]+i*t[7],n[2]=o*t[2]+r*t[5]+i*t[8],n}function Yr(n,e,t){var o=t[0],r=t[1],i=t[2],s=t[3],a=e[0],p=e[1],c=e[2],d=r*c-i*p,x=i*a-o*c,m=o*p-r*a,_=r*m-i*x,O=i*d-o*m,P=o*x-r*d,j=s*2;return d*=j,x*=j,m*=j,_*=2,O*=2,P*=2,n[0]=a+d+_,n[1]=p+x+O,n[2]=c+m+P,n}function Qr(n,e,t,o){var r=[],i=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],i[0]=r[0],i[1]=r[1]*Math.cos(o)-r[2]*Math.sin(o),i[2]=r[1]*Math.sin(o)+r[2]*Math.cos(o),n[0]=i[0]+t[0],n[1]=i[1]+t[1],n[2]=i[2]+t[2],n}function Zr(n,e,t,o){var r=[],i=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],i[0]=r[2]*Math.sin(o)+r[0]*Math.cos(o),i[1]=r[1],i[2]=r[2]*Math.cos(o)-r[0]*Math.sin(o),n[0]=i[0]+t[0],n[1]=i[1]+t[1],n[2]=i[2]+t[2],n}function ei(n,e,t,o){var r=[],i=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],i[0]=r[0]*Math.cos(o)-r[1]*Math.sin(o),i[1]=r[0]*Math.sin(o)+r[1]*Math.cos(o),i[2]=r[2],n[0]=i[0]+t[0],n[1]=i[1]+t[1],n[2]=i[2]+t[2],n}function ti(n,e){var t=n[0],o=n[1],r=n[2],i=e[0],s=e[1],a=e[2],p=Math.sqrt(t*t+o*o+r*r),c=Math.sqrt(i*i+s*s+a*a),d=p*c,x=d&&St(n,e)/d;return Math.acos(Math.min(Math.max(x,-1),1))}function ni(n){return n[0]=0,n[1]=0,n[2]=0,n}function oi(n){return"vec3("+n[0]+", "+n[1]+", "+n[2]+")"}function ri(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]}function ii(n,e){var t=n[0],o=n[1],r=n[2],i=e[0],s=e[1],a=e[2];return Math.abs(t-i)<=X*Math.max(1,Math.abs(t),Math.abs(i))&&Math.abs(o-s)<=X*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(r-a)<=X*Math.max(1,Math.abs(r),Math.abs(a))}var si=io,ai=so,pi=ao,li=po,ci=lo,en=ro,di=co,mi=function(){var n=bt();return function(e,t,o,r,i,s){var a,p;for(t||(t=3),o||(o=0),r?p=Math.min(r*t+o,e.length):p=e.length,a=o;a<p;a+=t)n[0]=e[a],n[1]=e[a+1],n[2]=e[a+2],i(n,n,s),e[a]=n[0],e[a+1]=n[1],e[a+2]=n[2];return e}}();function ui(){var n=new E(4);return E!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function mo(n){var e=new E(4);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}function uo(n,e,t,o){var r=new E(4);return r[0]=n,r[1]=e,r[2]=t,r[3]=o,r}function xo(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}function fo(n,e,t,o,r){return n[0]=e,n[1]=t,n[2]=o,n[3]=r,n}function _o(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n}function ho(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function go(n){var e=n[0],t=n[1],o=n[2],r=n[3];return Math.hypot(e,t,o,r)}function vo(n){var e=n[0],t=n[1],o=n[2],r=n[3];return e*e+t*t+o*o+r*r}function Ao(n,e){var t=e[0],o=e[1],r=e[2],i=e[3],s=t*t+o*o+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),n[0]=t*s,n[1]=o*s,n[2]=r*s,n[3]=i*s,n}function bo(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]}function yo(n,e,t,o){var r=e[0],i=e[1],s=e[2],a=e[3];return n[0]=r+o*(t[0]-r),n[1]=i+o*(t[1]-i),n[2]=s+o*(t[2]-s),n[3]=a+o*(t[3]-a),n}function So(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]}function Vo(n,e){var t=n[0],o=n[1],r=n[2],i=n[3],s=e[0],a=e[1],p=e[2],c=e[3];return Math.abs(t-s)<=X*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(o-a)<=X*Math.max(1,Math.abs(o),Math.abs(a))&&Math.abs(r-p)<=X*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(i-c)<=X*Math.max(1,Math.abs(i),Math.abs(c))}var Al=function(){var n=ui();return function(e,t,o,r,i,s){var a,p;for(t||(t=4),o||(o=0),r?p=Math.min(r*t+o,e.length):p=e.length,a=o;a<p;a+=t)n[0]=e[a],n[1]=e[a+1],n[2]=e[a+2],n[3]=e[a+3],i(n,n,s),e[a]=n[0],e[a+1]=n[1],e[a+2]=n[2],e[a+3]=n[3];return e}}();function tn(){var n=new E(4);return E!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function fi(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function Co(n,e,t){t=t*.5;var o=Math.sin(t);return n[0]=o*e[0],n[1]=o*e[1],n[2]=o*e[2],n[3]=Math.cos(t),n}function _i(n,e){var t=Math.acos(e[3])*2,o=Math.sin(t/2);return o>X?(n[0]=e[0]/o,n[1]=e[1]/o,n[2]=e[2]/o):(n[0]=1,n[1]=0,n[2]=0),t}function hi(n,e){var t=Mo(n,e);return Math.acos(2*t*t-1)}function wo(n,e,t){var o=e[0],r=e[1],i=e[2],s=e[3],a=t[0],p=t[1],c=t[2],d=t[3];return n[0]=o*d+s*a+r*c-i*p,n[1]=r*d+s*p+i*a-o*c,n[2]=i*d+s*c+o*p-r*a,n[3]=s*d-o*a-r*p-i*c,n}function gi(n,e,t){t*=.5;var o=e[0],r=e[1],i=e[2],s=e[3],a=Math.sin(t),p=Math.cos(t);return n[0]=o*p+s*a,n[1]=r*p+i*a,n[2]=i*p-r*a,n[3]=s*p-o*a,n}function vi(n,e,t){t*=.5;var o=e[0],r=e[1],i=e[2],s=e[3],a=Math.sin(t),p=Math.cos(t);return n[0]=o*p-i*a,n[1]=r*p+s*a,n[2]=i*p+o*a,n[3]=s*p-r*a,n}function Ai(n,e,t){t*=.5;var o=e[0],r=e[1],i=e[2],s=e[3],a=Math.sin(t),p=Math.cos(t);return n[0]=o*p+r*a,n[1]=r*p-o*a,n[2]=i*p+s*a,n[3]=s*p-i*a,n}function bi(n,e){var t=e[0],o=e[1],r=e[2];return n[0]=t,n[1]=o,n[2]=r,n[3]=Math.sqrt(Math.abs(1-t*t-o*o-r*r)),n}function To(n,e){var t=e[0],o=e[1],r=e[2],i=e[3],s=Math.sqrt(t*t+o*o+r*r),a=Math.exp(i),p=s>0?a*Math.sin(s)/s:0;return n[0]=t*p,n[1]=o*p,n[2]=r*p,n[3]=a*Math.cos(s),n}function Eo(n,e){var t=e[0],o=e[1],r=e[2],i=e[3],s=Math.sqrt(t*t+o*o+r*r),a=s>0?Math.atan2(s,i)/s:0;return n[0]=t*a,n[1]=o*a,n[2]=r*a,n[3]=.5*Math.log(t*t+o*o+r*r+i*i),n}function yi(n,e,t){return Eo(n,e),Io(n,n,t),To(n,n),n}function Vt(n,e,t,o){var r=e[0],i=e[1],s=e[2],a=e[3],p=t[0],c=t[1],d=t[2],x=t[3],m,_,O,P,j;return _=r*p+i*c+s*d+a*x,_<0&&(_=-_,p=-p,c=-c,d=-d,x=-x),1-_>X?(m=Math.acos(_),O=Math.sin(m),P=Math.sin((1-o)*m)/O,j=Math.sin(o*m)/O):(P=1-o,j=o),n[0]=P*r+j*p,n[1]=P*i+j*c,n[2]=P*s+j*d,n[3]=P*a+j*x,n}function Si(n){var e=te(),t=te(),o=te(),r=Math.sqrt(1-e),i=Math.sqrt(e);return n[0]=r*Math.sin(2*Math.PI*t),n[1]=r*Math.cos(2*Math.PI*t),n[2]=i*Math.sin(2*Math.PI*o),n[3]=i*Math.cos(2*Math.PI*o),n}function Vi(n,e){var t=e[0],o=e[1],r=e[2],i=e[3],s=t*t+o*o+r*r+i*i,a=s?1/s:0;return n[0]=-t*a,n[1]=-o*a,n[2]=-r*a,n[3]=i*a,n}function Ci(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n}function Po(n,e){var t=e[0]+e[4]+e[8],o;if(t>0)o=Math.sqrt(t+1),n[3]=.5*o,o=.5/o,n[0]=(e[5]-e[7])*o,n[1]=(e[6]-e[2])*o,n[2]=(e[1]-e[3])*o;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[r*3+r]&&(r=2);var i=(r+1)%3,s=(r+2)%3;o=Math.sqrt(e[r*3+r]-e[i*3+i]-e[s*3+s]+1),n[r]=.5*o,o=.5/o,n[3]=(e[i*3+s]-e[s*3+i])*o,n[i]=(e[i*3+r]+e[r*3+i])*o,n[s]=(e[s*3+r]+e[r*3+s])*o}return n}function wi(n,e,t,o){var r=.5*Math.PI/180;e*=r,t*=r,o*=r;var i=Math.sin(e),s=Math.cos(e),a=Math.sin(t),p=Math.cos(t),c=Math.sin(o),d=Math.cos(o);return n[0]=i*p*d-s*a*c,n[1]=s*a*d+i*p*c,n[2]=s*p*c-i*a*d,n[3]=s*p*d+i*a*c,n}function Ti(n){return"quat("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"}var Ei=mo,Pi=uo,Ii=xo,Mi=fo,ki=_o,Ri=wo,Io=ho,Mo=bo,Li=yo,ko=go,Oi=ko,Ro=vo,Di=Ro,nn=Ao,Xi=So,Bi=Vo,ji=function(){var n=bt(),e=yt(1,0,0),t=yt(0,1,0);return function(o,r,i){var s=St(r,i);return s<-.999999?(ze(n,e,r),en(n)<1e-6&&ze(n,t,r),Zt(n,n),Co(o,n,Math.PI),o):s>.999999?(o[0]=0,o[1]=0,o[2]=0,o[3]=1,o):(ze(n,r,i),o[0]=n[0],o[1]=n[1],o[2]=n[2],o[3]=1+s,nn(o,o))}}(),Ni=function(){var n=tn(),e=tn();return function(t,o,r,i,s,a){return Vt(n,o,s,a),Vt(e,r,i,a),Vt(t,n,e,2*a*(1-a)),t}}(),Fi=function(){var n=oo();return function(e,t,o,r){return n[0]=o[0],n[3]=o[1],n[6]=o[2],n[1]=r[0],n[4]=r[1],n[7]=r[2],n[2]=-t[0],n[5]=-t[1],n[8]=-t[2],nn(e,Po(e,n))}}();var wl=F.create(),Tl=F.create();var He=class{constructor(){this.p=F.create();this.q=me.create();Object.seal(this)}set(e,t,o,r,i,s,a){this.setPosition(e,t,o),this.setOrientation(r,i,s,a)}setPosition(e,t,o){F.set(this.p,e,t,o)}setOrientation(e,t,o,r){me.set(this.q,e,t,o,r)}copy(e){F.copy(this.p,e.p),me.copy(this.q,e.q)}};var Fl=F.create();var on=class extends D{constructor(e){let t=new Q(e,{type:"bandpass",frequency:2500,Q:4.5}),o=new U(e,{gain:10});t.connect(o),super("radio-effect",e,[t],[o])}};function Lo(n,e){let t=new on(e);return t.name=`${n}-radio-effect`,t}function Oo(n,e){let t=new Q(e,{type:"bandpass",frequency:400,Q:4.5});return t.name=`${n}-wall-effect`,t}var Do=new Map([["Radio",Lo],["Wall",Oo]]);var ue=class extends D{constructor(t,o,r,i,s){let a=new U(o);a.name="volume-control",s=s||[];super(t,o,[],[r],s);this.spatializer=r;this.effects=new Array;this.pose=new He;this.volumeControl=a,this.setEffects(...i)}onDisposing(){I(this.effects),super.onDisposing()}setEffects(...t){this.disable();for(let r of this.effects)this.remove(r),M(r);I(this.effects);let o=this.volumeControl;for(let r of t)if(l(r)){let i=Do.get(r);if(l(i)){let s=i(r,this.context);this.add(s),this.effects.push(s),o=o.connect(s)}}this.enable()}get spatialized(){return this.spatializer.spatialized}get lastInternal(){return this.effects[this.effects.length-1]||this.volumeControl}enable(){this.lastInternal.isConnected()||this.lastInternal.connect(this.spatializer)}disable(){this.lastInternal.isConnected()&&this.lastInternal.disconnect()}tog(){this.lastInternal.isConnected()?this.disable():this.enable()}get volume(){return this.volumeControl.gain.value}set volume(t){this.volumeControl.gain.value=t}get minDistance(){return l(this.spatializer)?this.spatializer.minDistance:null}get maxDistance(){return l(this.spatializer)?this.spatializer.maxDistance:null}get algorithm(){return l(this.spatializer)?this.spatializer.algorithm:null}setPosition(t,o,r){l(this.spatializer)&&(this.pose.setPosition(t,o,r),this.spatializer.readPose(this.pose))}setOrientation(t,o,r,i){l(this.spatializer)&&(this.pose.setOrientation(t,o,r,i),this.spatializer.readPose(this.pose))}set(t,o,r,i,s,a,p){l(this.spatializer)&&(this.pose.set(t,o,r,i,s,a,p),this.spatializer.readPose(this.pose))}setAudioProperties(t,o,r){l(this.spatializer)&&this.spatializer.setAudioProperties(t,o,r)}};var K=class extends w{constructor(t,o){super(t);this.source=o}},We=class extends K{constructor(e){super("loaded",e)}};var Je=class extends K{constructor(e){super("played",e)}},qe=class extends K{constructor(e){super("paused",e)}},Ue=class extends K{constructor(e){super("stopped",e)}},Ke=class extends K{constructor(t){super("progress",t);this.value=0;this.total=0}};var Kc=new w("disposing");var md=A(HTMLAudioElement.prototype.setSinkId);var Hd=new w("useheadphonestoggled");var rn=new w("released");var sn=class extends K{constructor(e,t){super(e,t)}},Ct=class extends sn{constructor(e){super("loading",e)}};var B=class{constructor(e){this.items=new Map;this.defaultItems=new Array;if(l(e))for(let[t,o]of e)this.add(t,o)}add(e,...t){for(let o of t)if(u(e))this.defaultItems.push(o);else{let r=this.items.get(e);u(r)&&this.items.set(e,r=[]),r.push(o)}return this}entries(){return this.items.entries()}[Symbol.iterator](){return this.entries()}keys(){return this.items.keys()}*values(){for(let e of this.defaultItems)yield e;for(let e of this.items.values())for(let t of e)yield t}has(e){return l(e)?this.items.has(e):this.defaultItems.length>0}get(e){return u(e)?this.defaultItems:this.items.get(e)||[]}count(e){if(u(e))return this.defaultItems.length;let t=this.get(e);return l(t)?t.length:0}get size(){let e=this.defaultItems.length;for(let t of this.items.values())e+=t.length;return e}delete(e){return u(e)?I(this.defaultItems).length>0:this.items.delete(e)}remove(e,t){if(u(e))J(this.defaultItems,t);else{let o=this.items.get(e);l(o)&&(J(o,t),o.length===0&&this.items.delete(e))}}clear(){this.items.clear(),I(this.defaultItems)}};var Xo=/([^\/]+)\/(.+)/,Wi=/(?:([^\.]+)\.)?([^\+;]+)(?:\+([^;]+))?((?:; *([^=]+)=([^;]+))*)/;var ne=class{constructor(e,t,o){this._type=e;this._fullSubType=t;this._primaryExtension=null;this.depMessage=null;let r=new Map;this._parameters=r;let i=this._fullSubType.match(Wi);this._tree=i[1],this._subType=i[2],this._suffix=i[3];let s=i[4];if(this._value=this._fullValue=this._type+"/",l(this._tree)&&(this._value=this._fullValue+=this._tree+"."),this._value=this._fullValue+=this._subType,l(this._suffix)&&(this._value=this._fullValue+="+"+this._suffix),l(s)){let a=s.split(";").map(p=>p.trim()).filter(p=>p.length>0).map(p=>p.split("="));for(let[p,...c]of a){let d=c.join("=");r.set(p,d);let x=`; ${p}=${d}`;this._fullValue+=x,p!=="q"&&(this._value+=x)}}this._extensions=o||[],this._primaryExtension=this._extensions[0]||null}static parse(e){if(!e)return null;let t=e.match(Xo);if(!t)return null;let o=t[1],r=t[2];return new ne(o,r)}deprecate(e){return this.depMessage=e,this}check(){l(this.depMessage)&&console.warn(`${this._value} is deprecated ${this.depMessage}`)}matches(e){if(u(e))return!1;if(this.typeName==="*"&&this.subTypeName==="*")return!0;let t=null,o=null;if(h(e)){let r=e.match(Xo);if(!r)return!1;t=r[1],o=r[2]}else t=e.typeName,o=e._fullSubType;return this.typeName===t&&(this._fullSubType==="*"||this._fullSubType===o)}withParameter(e,t){let o=`${this._fullSubType}; ${e}=${t}`;return new ne(this.typeName,o,this.extensions)}get typeName(){return this.check(),this._type}get tree(){return this.check(),this._tree}get suffix(){return this._suffix}get subTypeName(){return this.check(),this._subType}get value(){return this.check(),this._value}__getValueUnsafe(){return this._value}get fullValue(){return this.check(),this._fullValue}get parameters(){return this.check(),this._parameters}get extensions(){return this.check(),this._extensions}__getExtensionsUnsafe(){return this._extensions}get primaryExtension(){return this.check(),this._primaryExtension}toString(){return this.parameters.get("q")==="1"?this.value:this.fullValue}addExtension(e){if(!e)throw new Error("File name is not defined");if(this.primaryExtension){let t=e.lastIndexOf(".");if(t>-1){let o=e.substring(t+1);this.extensions.indexOf(o)>-1&&(e=e.substring(0,t))}e=`${e}.${this.primaryExtension}`}return e}};function Ji(n,e,...t){return new ne(n,e,t)}function k(n){return Ji.bind(null,n)}var an=k("application");var xe=an("javascript","js");var pn=an("json","json");var ln=an("wasm","wasm");var cn=k("text");var wt=cn("css","css");var Bo=cn("plain","txt","text","conf","def","list","log","in");var jo=cn("xml");var qi=k("video");var No=qi("vnd.mpeg.dash.mpd","mpd");async function dn(n,e){let t=new Array(e.length),o=new Array(e.length);for(let s=0;s<e.length;++s){let a=e[s];t[s]=a[0],o[s]=a[1]}let r=Fe(n,t),i=new Array(e.length);for(let s=0;s<e.length;++s)i[s]=o[s](r[s]);return await Promise.all(i)}function Fo(n,...e){let t=e.map(o=>[1,o]);return dn(n,t)}function Go(n){return h(n.vcodec)}var se=class extends ue{constructor(t,o,r){let i=se.createMediaElement(Kn,ie(!0)),s=se.createMediaElement(ce,ie(!1)),a=new Z(o,{mediaElement:i});a.name=`${t}-video`;let p=new Z(o,{mediaElement:s});p.name=`${t}-audio`;super(t,o,r,[],[a,p]);this.onTimeUpdate=null;this.wasUsingAudioElement=!1;this.nextStartTime=null;this._data=null;this._loaded=!1;this.onError=new Map;this.sourcesByURL=new Map;this.sources=new B;this.potatoes=new B;a.connect(this.volumeControl),p.connect(this.volumeControl),this.video=i,this.audio=s,this.loadingEvt=new Ct(this),this.loadEvt=new We(this),this.playEvt=new Je(this),this.pauseEvt=new qe(this),this.stopEvt=new Ue(this),this.progEvt=new Ke(this),this.onSeeked=()=>{this.useAudioElement&&(this.audio.currentTime=this.video.currentTime)},this.onPlay=async()=>{this.onSeeked(),this.useAudioElement&&(await this.context.ready,await this.audio.play()),this.dispatchEvent(this.playEvt)},this.onPause=d=>{this.useAudioElement&&(this.onSeeked(),this.audio.pause()),this.video.currentTime===0||d.type==="ended"?this.dispatchEvent(this.stopEvt):this.dispatchEvent(this.pauseEvt)};let c=!1;this.onWaiting=()=>{this.useAudioElement&&(c=!0,this.audio.pause())},this.onCanPlay=async()=>{this.useAudioElement&&c&&(await this.context.ready,await this.audio.play(),c=!1)},this.wasUsingAudioElement=!1,this.onTimeUpdate=async()=>{if(this.video.getVideoPlaybackQuality().totalVideoFrames===0){let x=this.onError.get(this.video);l(x)&&await x()}else if(this.useAudioElement){this.wasUsingAudioElement=!1;let x=this.video.currentTime-this.audio.currentTime;Math.abs(x)>.25&&(this.audio.currentTime=this.video.currentTime)}else this.wasUsingAudioElement||(this.wasUsingAudioElement=!0,this.audio.pause());this.progEvt.value=this.video.currentTime,this.progEvt.total=this.video.duration,this.dispatchEvent(this.progEvt)},this.video.addEventListener("seeked",this.onSeeked),this.video.addEventListener("play",this.onPlay),this.video.addEventListener("pause",this.onPause),this.video.addEventListener("ended",this.onPause),this.video.addEventListener("waiting",this.onWaiting),this.video.addEventListener("canplay",this.onCanPlay),this.video.addEventListener("timeupdate",this.onTimeUpdate),Object.assign(window,{videoPlayer:this})}get data(){return this._data}get loaded(){return this._loaded}get title(){return this.video.title}setTitle(t){this.video.title=t,this.audio.title=t}elementHasAudio(t){let o=this.sourcesByURL.get(t.src);return l(o)&&o.acodec!=="none"||l(t.audioTracks)&&t.audioTracks.length>0||l(t.webkitAudioDecodedByteCount)&&t.webkitAudioDecodedByteCount>0||l(t.mozHasAudio)&&t.mozHasAudio}get useAudioElement(){return!this.elementHasAudio(this.video)&&this.elementHasAudio(this.audio)}onDisposing(){this.clear(),this.video.removeEventListener("seeked",this.onSeeked),this.video.removeEventListener("play",this.onPlay),this.video.removeEventListener("pause",this.onPause),this.video.removeEventListener("ended",this.onPause),this.video.removeEventListener("waiting",this.onWaiting),this.video.removeEventListener("canplay",this.onCanPlay),this.video.removeEventListener("timeupdate",this.onTimeUpdate),super.onDisposing(),this.audio.dispatchEvent(rn),this.video.dispatchEvent(rn)}clear(){this.stop();for(let[t,o]of this.onError)t.removeEventListener("error",o);this.onError.clear(),this.sourcesByURL.clear(),this.sources.clear(),this.potatoes.clear(),this.video.src="",this.audio.src="",this.wasUsingAudioElement=!1,this._data=null,this._loaded=!1}async load(t,o){if(this.clear(),this._data=t,h(t)?(this.setTitle(t),this.potatoes.add(this.video,t)):(this.setTitle(t.title),this.fillSources(this.video,t.videos),this.fillSources(this.audio,t.audios)),!this.hasSources(this.video))throw new Error("No video sources found");if(this.dispatchEvent(this.loadingEvt),await Fo(o,r=>this.loadMediaElement(this.audio,r),r=>this.loadMediaElement(this.video,r)),h(t)?this.nextStartTime=null:this.nextStartTime=t.startTime,!this.hasSources(this.video))throw new Error("No video playable sources");return this._loaded=!0,this.dispatchEvent(this.loadEvt),this}fillSources(t,o){En(o,r=>-r.resolution);for(let r of o)No.matches(r.contentType)||(this.sources.add(t,r),this.sourcesByURL.set(r.url,r))}static createMediaElement(t,...o){return t(Ee(!1),Pe(!1),...o)}async getMediaCapabilities(t){let o={type:"file"};Go(t)?o.video={contentType:t.contentType,bitrate:t.vbr*1024,framerate:t.fps,width:t.width,height:t.height}:t.acodec!=="none"&&(o.audio={contentType:t.contentType,bitrate:t.abr*1024,samplerate:t.asr});try{return await navigator.mediaCapabilities.decodingInfo(o)}catch{return{supported:!0,powerEfficient:!1,smooth:!1,configuration:o}}}hasSources(t){return this.sources.get(t).length>0||this.potatoes.count(t)>0}async loadMediaElement(t,o){for(l(o)&&o.start(),this.onError.has(t)&&(t.removeEventListener("error",this.onError.get(t)),this.onError.delete(t));this.hasSources(t);){let r=null,i=this.sources.get(t).shift();if(l(i)){let s=await this.getMediaCapabilities(i);if(!s.smooth||!s.powerEfficient){this.potatoes.add(t,i.url);continue}else r=i.url}else r=this.potatoes.get(t).shift();if(t.src=r,t.load(),await Fn(t)){l(i)?this.sources.get(t).unshift(i):this.potatoes.get(t).unshift(r);let s=()=>this.loadMediaElement(t,o);t.addEventListener("error",s),this.onError.set(t,s),this.wasUsingAudioElement=this.wasUsingAudioElement,l(o)&&o.end();return}}}get width(){return this.video.videoWidth}get height(){return this.video.videoHeight}get playbackState(){return u(this.data)?"empty":this.loaded?this.video.error?"errored":this.video.ended||this.video.paused&&this.video.currentTime===0?"stopped":this.video.paused?"paused":"playing":"loading"}async play(){await this.context.ready,l(this.nextStartTime)&&this.nextStartTime>0&&(this.video.pause(),this.video.currentTime=this.nextStartTime,this.nextStartTime=null),await this.video.play()}async playThrough(){let t=C(this,"stopped");await this.play(),await t}pause(){this.video.pause()}stop(){this.pause(),this.video.currentTime=0}restart(){return this.stop(),this.play()}};var zo="wait",Ui="pointer",Ki="not-allowed",Tt=class extends se{constructor(t,o){super("video-player",t,o);this.element=Wn(ke("inline-block"),this.thumbnail=Re(ct(zo)),this.video,this.audio),this.thumbnail.addEventListener("click",()=>{this.loaded&&this.play()}),this.addEventListener("played",()=>this.showVideo(!0)),this.addEventListener("stopped",()=>this.showVideo(!1)),this.showVideo(!1)}onDisposing(){super.onDisposing(),l(this.element.parentElement)&&this.element.remove()}showVideo(t){Jt(this.video,t,"inline-block"),Jt(this.thumbnail,!t,"inline-block")}async load(t,o){try{z(this.thumbnail,dt(.5),ct(zo));let r=Fe(o,[1,10]);return await _t(super.load(t,r.shift()),this.loadThumbnail(t,r.shift())),this}finally{z(this.thumbnail,dt(1),ct(this.loaded?Ui:Ki))}}clear(){super.clear(),this.thumbnail.src=""}setTitle(t){super.setTitle(t),this.thumbnail.title=t}async loadThumbnail(t,o){if(o.start(),l(t)){z(this.thumbnail,pt(t.thumbnail.url),dt(.5));let r=C(this.thumbnail,"load","error");await G(r)}o.end()}};function mn(n){return n.hostname==="www.youtube.com"||n.hostname==="youtube.com"||n.hostname==="youtu.be"}var $i=new Map([["vp9","vp09.00.10.08"]]);function Yi(n){return u(n.vcodec)||n.vcodec==="none"?"audio":"video"}function Ho(n,e){let t=[n];if(l(e)&&e.length>0&&e!=="none"&&(e=$i.get(e)||e),l(e)&&e.length>0&&e!=="none"){let o=encodeURI(e)!==e?"*":"";t.push(`codecs${o}="${e}"`)}return t.join(";")}var Et=class{constructor(e,t){this.fetcher=e;this.makeProxyURL=t}makeVideoRecord(e){let{content_type:t,acodec:o,vcodec:r}=e;return{contentType:Ho(t,r),url:this.makeProxyURL(e.url).href,acodec:o,abr:e.abr*1024,asr:e.asr,vcodec:r,vbr:e.vbr*1024,fps:e.fps,width:e.width,height:e.height,resolution:e.width*e.height}}makeAudioRecord(e){let{content_type:t,acodec:o}=e;return{contentType:Ho(t,o),url:this.makeProxyURL(e.url).href,acodec:o,abr:e.abr*1024,asr:e.asr,resolution:e.abr}}makeImageRecord(e){let{content_type:t,url:o,width:r,height:i}=e;return{contentType:t,url:this.makeProxyURL(o).href,width:r,height:i,resolution:r*i}}async loadData(e,t){if(u(e))throw new Error("must provide a YouTube URL or a YTMetadata object");l(t)&&t.start();let o=null;h(e)?o=await this.fetcher.get(e).progress(t).object().then(Ge):(l(t)&&t.end(e.title),o=e);let r=0;if(l(o.original_url)){let m=new URL(o.original_url);mn(m)&&m.searchParams.has("t")&&(r=parseFloat(m.searchParams.get("t")))}let i=new B((await Promise.all(o.formats)).map(m=>[Yi(m),m])),s=o.title,a=o.thumbnails||[],p=o.thumbnail&&this.makeImageRecord(Se(a,m=>m.url===o.thumbnail)),c=i.get("video").map(m=>this.makeVideoRecord(m)),d=i.get("audio").map(m=>this.makeAudioRecord(m));return{title:s,thumbnail:p,videos:c,audios:d,startTime:r}}};function Jo(n){return l(n)&&A(n.then)&&A(n.catch)&&A(n.finally)&&A(n.fetch)&&A(n.getSize)}var Wo=class{constructor(e,t){this.path=e;this.type=t;this._result=null;this._error=null;this._started=!1;this._finished=!1;this.resolve=null;this.reject=null;this.promise=new Promise((o,r)=>{this.resolve=i=>{this._result=i,this._finished=!0,o(i)},this.reject=i=>{this._error=i,this._finished=!0,r(i)}})}get result(){if(l(this.error))throw this.error;return this._result}get error(){return this._error}get started(){return this._started}get finished(){return this._finished}async getSize(e){try{let{contentLength:t}=await e.head(this.path).accept(this.type).exec();return[this,t||1]}catch(t){return console.warn(t),[this,1]}}async fetch(e,t){try{let o=await this.getResult(e,t);this.resolve(o)}catch(o){this.reject(o)}}get[Symbol.toStringTag](){return this.promise.toString()}then(e,t){return this.promise.then(e,t)}catch(e){return this.promise.catch(e)}finally(e){return this.promise.finally(e)}};var Ou="HTMLCanvasElement"in globalThis,Du="HTMLImageElement"in globalThis,un=!1,fe=!un&&"OffscreenCanvas"in globalThis,Xu=!un&&"createImageBitmap"in globalThis;function Qi(){try{return new OffscreenCanvas(1,1).getContext("2d")!=null}catch{return!1}}var Bu=fe&&Qi();function Zi(){try{return new OffscreenCanvas(1,1).getContext("webgl2")!=null}catch{return!1}}var ju=fe&&Zi();function qo(n,e){return new OffscreenCanvas(n,e)}function Uo(n,e){return Hn(Dn(n),kn(e))}function xn(n,e){let t=n.getContext("2d");if(u(t))throw new Error("Could not create 2d context for canvas");t.drawImage(e,0,0)}function Ko(n){let e=new S,t=setInterval(()=>{n()&&(clearInterval(t),e.resolve())},100);return e}async function b(n,e){let{status:t,requestPath:o,responsePath:r,content:i,contentType:s,contentLength:a,fileName:p,headers:c,date:d}=n;return{status:t,requestPath:o,responsePath:r,content:l(e)?await e(i):void 0,contentType:s,contentLength:a,fileName:p,headers:c,date:d}}var fn=null;function $o(n){return fn===null&&(fn=new Audio),fn.canPlayType(n)!==""}var Pt=class{constructor(e,t,o,r=!1){this.fetcher=e;this.method=t;this.path=o;this.useBLOBs=r;this.prog=null;this.request={method:t,path:this.path.href,body:null,headers:null,timeout:null,withCredentials:!1,useCache:!1,retryCount:3}}retries(e){return this.request.retryCount=e,this}query(e,t){return this.path.searchParams.set(e,t),this.request.path=this.path.href,this}header(e,t){return this.request.headers===null&&(this.request.headers=new Map),this.request.headers.set(e.toLowerCase(),t),this}headers(e){for(let[t,o]of e.entries())this.header(t,o);return this}timeout(e){return this.request.timeout=e,this}progress(e){return this.prog=e,this}body(e,t){if(l(e)){let o=new Set,r=new Array;r.push(e);let i=!1;for(;!i&&r.length>0;){let s=r.shift();if(s&&!o.has(s))if(o.add(s),s instanceof Blob){i=!0;break}else h(s)||r.push(...Object.values(s))}if(i){let s=new FormData,a=new Map,p=new Set;for(let[c,d]of Object.entries(e))if(d instanceof Blob){let x=c+".name",m=e[x];h(m)&&(a.set(d,m),p.add(x))}for(let[c,d]of Object.entries(e))p.has(c)||(d instanceof Blob?s.append(c,d,a.get(d)):h(d)?s.append(c,d):l(d)&&A(d.toString)?s.append(c,d.toString()):console.warn("Can't serialize value to formdata",c,d));e=s,t=void 0}this.request.body=e,this.content(t)}return this}withCredentials(){return this.request.withCredentials=!0,this}useCache(e=!0){return this.request.useCache=e,this}media(e,t){l(t)&&(h(t)||(t=t.value),this.header(e,t))}content(e){this.media("content-type",e)}accept(e){return this.media("accept",e),this}blob(e){if(this.accept(e),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetBlob(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetBlob(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);y(this.method)}buffer(e){if(this.accept(e),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetBuffer(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetBuffer(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);y(this.method)}async file(e){if(this.accept(e),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return await this.fetcher.sendObjectGetFile(this.request,this.prog);if(this.method==="GET"){if(this.useBLOBs)return await this.fetcher.sendNothingGetFile(this.request,this.prog);{let t=await this.fetcher.sendNothingGetNothing(this.request);return b(t,()=>this.request.path)}}else{if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);y(this.method)}}text(e){if(this.accept(e||Bo),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetText(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetText(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);y(this.method)}object(e){if(this.accept(e||pn),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetObject(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetObject(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);y(this.method)}xml(e){if(this.accept(e||jo),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetXml(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetXml(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);y(this.method)}imageBitmap(e){if(this.accept(e),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetImageBitmap(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetImageBitmap(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);y(this.method)}exec(){if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetNothing(this.request,this.prog);if(this.method==="GET")throw new ee("GET requests should expect a response type");if(this.method==="HEAD"||this.method==="OPTIONS")return this.fetcher.sendNothingGetNothing(this.request);y(this.method)}async audioBlob(e){if(l(e)&&(h(e)||(e=e.value),!$o(e)))throw new Error(`Probably can't play file of type "${e}" at path: ${this.request.path}`);let t=await this.blob(e);if($o(t.contentType))return t;throw new Error(`Cannot play file of type "${t.contentType}" at path: ${this.request.path}`)}async audioBuffer(e,t){return b(await this.audioBlob(t),async o=>await e.decodeAudioData(await o.arrayBuffer()))}async htmlElement(e,t,o){let r=await this.file(o),i=C(e,t,"error");return e instanceof HTMLLinkElement?e.href=r.content:e.src=r.content,await i,await b(r,()=>e)}image(e){return this.htmlElement(Re(),"load",e)}async htmlCanvas(e){let t=Uo(1,1);if(this.method==="GET")if(fe){this.accept(e);let o=await this.fetcher.drawImageToCanvas(this.request,t.transferControlToOffscreen(),this.prog);return await b(o,()=>t)}else{let o=await this.image(e);return await b(o,r=>(t.width=r.width,t.height=r.height,xn(t,r),M(r),t))}else{if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE"||this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);y(this.method)}}canvas(e){return fe?this.offscreenCanvas(e):this.htmlCanvas(e)}async offscreenCanvas(e){if(!fe)throw new Error("This system does not support OffscreenCanvas");if(this.method==="GET"){let t=await this.image(e);return await b(t,o=>{let r=qo(o.width,o.height);return xn(r,o),M(o),r})}else{if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE"||this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);y(this.method)}}async style(){let e=Jn(Ie(wt),Ln("stylesheet"));document.head.append(e);let t=await this.htmlElement(e,"load",wt);return b(t)}async getScript(){let e=qn(Ie(xe));document.head.append(e);let t=await this.htmlElement(e,"load",xe);return b(t)}async script(e){let t=null,o=this.request.path;if(!e)t=await this.getScript();else if(!e()){let r=Ko(e);t=await this.getScript(),await r}return this.prog&&this.prog.end(o),t}async module(){let e=this.request.path,t=await this.file(xe),o=await import(t.content);return this.prog&&this.prog.end(e),b(t,()=>o)}async wasm(e){let t=await this.buffer(ln);if(!ln.matches(t.contentType))throw new Error(`Server did not respond with WASM file. Was: ${t.contentType}`);let o=await WebAssembly.compile(t.content),r=await WebAssembly.instantiate(o,e);return b(t,()=>r.exports)}async worker(e="module"){let t=this.request.path,o=await this.file(xe);this.prog=null,this.request.timeout=null;let r=new Worker(o.content,{type:e});return this.prog&&this.prog.end(t),b(o,()=>r)}};var It=class{constructor(e,t=!1){this.service=e;this.useBLOBs=t;{let o=Nn("input[name=__RequestVerificationToken]");o&&this.service.setRequestVerificationToken(o.value)}}clearCache(){return this.service.clearCache()}evict(e,t){return this.service.evict(new URL(e,t||location.href).href)}request(e,t,o){return new Pt(this.service,e,new URL(t,o||location.href),this.useBLOBs)}head(e,t){return this.request("HEAD",e,t)}options(e,t){return this.request("OPTIONS",e,t)}get(e,t){return this.request("GET",e,t)}post(e,t){return this.request("POST",e,t)}put(e,t){return this.request("PUT",e,t)}patch(e,t){return this.request("PATCH",e,t)}delete(e,t){return this.request("DELETE",e,t)}async assets(e,t,...o){u(o)&&(o=[]),o.unshift(t);let r;Jo(e)?o.unshift(e):l(e)&&(r=e),o=o.filter(l);let i=await Promise.all(o.map(a=>a.getSize(this))),s=new Map(i);await dn(r,o.map(a=>[s.get(a),p=>a.fetch(this,p)]))}};var Mt=class{constructor(e){this.impl=e;this.defaultPostHeaders=new Map}setRequestVerificationToken(e){this.defaultPostHeaders.set("RequestVerificationToken",e)}clearCache(){return this.impl.clearCache()}evict(e){return this.impl.evict(e)}sendNothingGetNothing(e){return this.impl.sendNothingGetNothing(e)}sendNothingGetBlob(e,t){return this.impl.sendNothingGetSomething("blob",e,t)}sendObjectGetBlob(e,t){return this.impl.sendSomethingGetSomething("blob",e,this.defaultPostHeaders,t)}sendNothingGetBuffer(e,t){return this.impl.sendNothingGetSomething("arraybuffer",e,t)}sendObjectGetBuffer(e,t){return this.impl.sendSomethingGetSomething("arraybuffer",e,this.defaultPostHeaders,t)}sendNothingGetText(e,t){return this.impl.sendNothingGetSomething("text",e,t)}sendObjectGetText(e,t){return this.impl.sendSomethingGetSomething("text",e,this.defaultPostHeaders,t)}sendNothingGetObject(e,t){return this.impl.sendNothingGetSomething("json",e,t)}sendObjectGetObject(e,t){return this.impl.sendSomethingGetSomething("json",e,this.defaultPostHeaders,t)}sendObjectGetNothing(e,t){return this.impl.sendSomethingGetSomething("",e,this.defaultPostHeaders,t)}drawImageToCanvas(e,t,o){return this.impl.drawImageToCanvas(e,t,o)}async sendNothingGetFile(e,t){return b(await this.sendNothingGetBlob(e,t),URL.createObjectURL)}async sendObjectGetFile(e,t){return b(await this.sendObjectGetBlob(e,t),URL.createObjectURL)}async sendNothingGetXml(e,t){return b(await this.impl.sendNothingGetSomething("document",e,t),o=>o.documentElement)}async sendObjectGetXml(e,t){return b(await this.impl.sendSomethingGetSomething("document",e,this.defaultPostHeaders,t),o=>o.documentElement)}async sendNothingGetImageBitmap(e,t){return b(await this.sendNothingGetBlob(e,t),createImageBitmap)}async sendObjectGetImageBitmap(e,t){return b(await this.sendObjectGetBlob(e,t),createImageBitmap)}};function Yo(n,e,t){return new Map(n.map(o=>[e(o),t(o)]))}function Qo(n,e){return Yo(n,e,le)}var ae=class{constructor(e){this.items=new Map;if(l(e))for(let[t,o,r]of e)this.add(t,o,r)}add(e,t,o){let r=this.items.get(e);return u(r)&&this.items.set(e,r=new Map),r.set(t,o),this}*entries(){for(let[e,t]of this.items)for(let[o,r]of t)yield[e,o,r]}keys(e){return u(e)?this.items.keys():this.items.get(e).keys()}*values(){for(let e of this.items.values())for(let t of e.values())yield t}has(e,t){return this.items.has(e)&&(u(t)||this.items.get(e).has(t))}get(e,t){return u(t)?this.items.get(e):this.items.has(e)?this.items.get(e).get(t):null}count(e){return this.items.has(e)?this.items.get(e).size:null}get size(){let e=0;for(let t of this.items.values())e+=t.size;return e}delete(e,t){if(u(t))return this.items.delete(e);if(this.items.has(e)){let o=this.items.get(e),r=o.delete(t);return o.size===0&&this.items.delete(e),r}else return!1}clear(){this.items.clear()}};var _e=class{constructor(e){this.db=e}static delete(e){let t=indexedDB.deleteDatabase(e),o=C(t,"success","error","blocked");return G(o)}static async open(e,...t){let o=Qo(t,V=>V.name),r=new ae(t.filter(V=>l(V.indexes)).flatMap(V=>V.indexes.map(N=>[V.name,N.name,N]))),i=new Array,s=new Array,a=new Array,p=new B,c=new B,d=null,x=indexedDB.open(e);if(await G(C(x,"success","error","blocked"))){let V=x.result;d=V.version;let N=new Array;for(let R of V.objectStoreNames)o.has(R)||s.push(R);for(let R of o.keys())V.objectStoreNames.contains(R)?N.push(R):i.push(R);if(N.length>0){let R=V.transaction(N),L=C(R,"complete","error","abort"),$=G(L);for(let v of N){let oe=R.objectStore(v),yn=o.get(v);l(yn.options)&&oe.keyPath!==yn.options.keyPath&&(s.push(v),i.push(v));for(let W of oe.indexNames)r.has(v,W)||(a.indexOf(v)===-1&&a.push(v),c.add(v,W));if(r.has(v))for(let W of r.get(v).keys())if(!oe.indexNames.contains(W))a.indexOf(v)===-1&&a.push(v),p.add(v,W);else{let he=r.get(v,W),ge=oe.index(W);(h(he.keyPath)!==h(ge.keyPath)||h(he.keyPath)&&h(ge.keyPath)&&he.keyPath!==ge.keyPath||ye(he.keyPath)&&ye(ge.keyPath)&&Tn(he.keyPath,ge.keyPath))&&(a.indexOf(v)===-1&&a.push(v),c.add(v,W),p.add(v,W))}}R.commit(),await $}M(V)}else{d=0,i.push(...o.keys());for(let V of t)if(l(V.indexes))for(let N of V.indexes)p.add(V.name,N.name)}(i.length>0||s.length>0||p.size>0||c.size>0)&&++d;let m=new S,_=l(d)?indexedDB.open(e,d):indexedDB.open(e),O=C(_,"success","error","blocked"),P=G(m),j=G(O),bn=m.resolver(!1);if(_.addEventListener("success",bn),_.addEventListener("upgradeneeded",()=>{let V=C(_.transaction,"complete","error","abort"),N=_.result;for(let L of s)N.deleteObjectStore(L);let R=new Map;for(let L of i){let $=o.get(L),v=N.createObjectStore(L,$.options);R.set(L,v)}for(let L of a){let $=_.transaction.objectStore(L);R.set(L,$)}for(let[L,$]of R){for(let v of c.get(L))$.deleteIndex(v);for(let v of p.get(L)){let oe=r.get(L,v);$.createIndex(v,oe.keyPath,oe.options)}}G(V).then(m.resolve).catch(m.reject).finally(()=>_.removeEventListener("success",bn))}),!await P)throw m.error;if(!await j)throw O.error;return new _e(_.result)}dispose(){M(this.db)}get name(){return this.db.name}get version(){return this.db.version}get storeNames(){return Array.from(this.db.objectStoreNames)}getStore(e){return new _n(this.db,e)}},_n=class{constructor(e,t){this.db=e;this.storeName=t}async request(e,t){let o=this.db.transaction(this.storeName,t),r=C(o,"complete","error"),i=o.objectStore(this.storeName),s=e(i),a=C(s,"success","error");if(!await G(a))throw o.abort(),a.error;if(o.commit(),!await G(r))throw r.error;return s.result}add(e,t){return this.request(o=>o.add(e,t),"readwrite")}clear(){return this.request(e=>e.clear(),"readwrite")}getCount(e){return this.request(t=>t.count(e),"readonly")}async has(e){return await this.getCount(e)>0}delete(e){return this.request(t=>t.delete(e),"readwrite")}get(e){return this.request(t=>t.get(e),"readonly")}getAll(){return this.request(e=>e.getAll(),"readonly")}getAllKeys(){return this.request(e=>e.getAllKeys(),"readonly")}getKey(e){return this.request(t=>t.getKey(e),"readonly")}openCursor(e,t){return this.request(o=>o.openCursor(e,t),"readonly")}openKeyCursor(e,t){return this.request(o=>o.openKeyCursor(e,t),"readonly")}put(e,t){return this.request(o=>o.put(e,t),"readwrite")}};function Zo(n,...e){for(let t of e)if(l(t))for(let[o,r]of t)n.set(o,r);return n}var hn=class extends S{constructor(t){super(!1);this.milliseconds=t;this._timer=null}start(){super.start(),this._timer=setTimeout(()=>{this._timer=null,this.resolve()},this.milliseconds)}reset(){super.reset(),l(this._timer)&&(clearTimeout(this._timer),this._timer=null)}};function er(n){let e=new hn(n);return e.start(),e}function kt(n,e){return async()=>{let t=null,o=500;for(let r=0;r<=n;++r)try{return r>0&&(await er(o),o*=2),await e()}catch(i){t=i}throw t}}function es(n){return h(n)||Cn(n)||n instanceof Blob||n instanceof FormData||wn(n)||"Document"in globalThis&&n instanceof Document}function Rt(n,e,t,o,r,i){let s=!i;i&&i.then(()=>s=!0);let a=!1,p=r,c=new S;t.addEventListener("loadstart",()=>{s&&!a&&o&&o.start(n)}),t.addEventListener("progress",x=>{if(s&&!a){let m=x;o&&o.report(m.loaded,Math.max(m.loaded,m.total),n),m.loaded===m.total&&(p=!0,a&&c.resolve())}}),t.addEventListener("load",()=>{s&&!a&&(o&&o.end(n),a=!0,p&&c.resolve())});let d=x=>()=>{s&&c.reject(`${x} (${e.status})`)};return t.addEventListener("error",d("error")),t.addEventListener("abort",d("abort")),t.addEventListener("timeout",d("timeout")),c}function gn(n,e,t,o,r,i){if(n.open(e,t),n.responseType="blob",n.timeout=o,r)for(let[s,a]of r)n.setRequestHeader(s,a);l(i)?n.send(i):n.send()}function Lt(n,e,t){if(!n.has(e))return null;let o=n.get(e);try{let r=t(o);return n.delete(e),r}catch(r){console.warn(e,r)}return null}var ts=/filename=\"(.+)\"(;|$)/,ns="Juniper:Fetcher:Cache",Ot=class{constructor(){this.cache=null;this.store=null;this.tasks=new ae;this.cacheReady=this.openCache()}async drawImageToCanvas(e,t,o){let r=await this.sendNothingGetSomething("blob",e,o),i=r.content;return Qn(await createImageBitmap(i,{imageOrientation:"from-image"}),s=>(t.width=s.width,t.height=s.height,t.getContext("2d").drawImage(s,0,0),b(r)))}async openCache(){let e={keyPath:"requestPath"};this.cache=await _e.open(ns,{name:"files",options:e}),this.store=await this.cache.getStore("files")}async clearCache(){await this.cacheReady,await this.store.clear()}async evict(e){await this.cacheReady,this.store.has(e)&&await this.store.delete(e)}async readResponseHeaders(e,t){let o=t.getAllResponseHeaders().split(/[\r\n]+/).map(m=>m.trim()).filter(m=>m.length>0).map(m=>{let _=m.split(": "),O=_.shift().toLowerCase(),P=_.join(": ");return[O,P]}),r=new B(o),i=Array.from(r.keys()).map(m=>[m,r.get(m).join(", ")]),s=new Map(i),a=Lt(s,"content-type",le),p=Lt(s,"content-length",parseFloat),c=Lt(s,"date",m=>new Date(m)),d=Lt(s,"content-disposition",m=>{if(l(m)){let _=m.match(ts);if(l(_))return _[1]}return null});return{status:t.status,requestPath:e,responsePath:t.responseURL,content:void 0,contentType:a,contentLength:p,fileName:d,date:c,headers:s}}async readResponse(e,t){let{responsePath:o,status:r,contentType:i,contentLength:s,fileName:a,date:p,headers:c}=await this.readResponseHeaders(e,t),d={requestPath:e,responsePath:o,status:r,contentType:i,contentLength:s,fileName:a,date:p,headers:c,content:t.response};return l(d.content)&&(d.contentType=d.contentType||d.content.type,d.contentLength=d.contentLength||d.content.size),d}async decodeContent(e,t){return b(t,async o=>{if(e==="")return null;if(u(t.contentType)){let r=Array.from(t.headers.entries()).map(i=>i.join(": ")).join(`
  `);throw new Error(`No content type found in headers: 
  `+r)}else{if(e==="blob")return o;if(e==="arraybuffer")return await o.arrayBuffer();if(e==="json"){let r=await o.text();return r.length>0?JSON.parse(r):null}else if(e==="document"){let r=new DOMParser;if(t.contentType==="application/xhtml+xml"||t.contentType==="text/html"||t.contentType==="application/xml"||t.contentType==="image/svg+xml"||t.contentType==="text/xml")return r.parseFromString(await o.text(),t.contentType);throw new Error("Couldn't parse document")}else{if(e==="text")return await o.text();y(e)}}})}async withCachedTask(e,t){return e.method!=="GET"&&e.method!=="HEAD"&&e.method!=="OPTIONS"?await t():(this.tasks.has(e.method,e.path)||this.tasks.add(e.method,e.path,t().finally(()=>this.tasks.delete(e.method,e.path))),this.tasks.get(e.method,e.path))}sendNothingGetNothing(e){return this.withCachedTask(e,kt(e.retryCount,async()=>{let t=new XMLHttpRequest,o=Rt(`requesting: ${e.path}`,t,t,null,!0);return gn(t,e.method,e.path,e.timeout,e.headers),await o,await this.readResponseHeaders(e.path,t)}))}sendNothingGetSomething(e,t,o){return this.withCachedTask(t,kt(t.retryCount,async()=>{let r=null,i=t.useCache&&t.method==="GET";i&&(l(o)&&o.start(),await this.cacheReady,r=await this.store.get(t.path));let s=u(r);if(s){let p=new XMLHttpRequest,c=Rt(`requesting: ${t.path}`,p,p,o,!0);gn(p,t.method,t.path,t.timeout,t.headers),await c,r=await this.readResponse(t.path,p),i&&await this.store.add(r)}let a=await this.decodeContent(e,r);return s&&l(o)&&o.end(),a}))}sendSomethingGetSomething(e,t,o,r){let i=null,s=Zo(new Map,o,t.headers);if(t.body instanceof FormData&&l(s)){let m=new Array;for(let _ of s.keys())_.toLowerCase()==="content-type"&&m.push(_);for(let _ of m)s.delete(_)}es(t.body)&&!h(t.body)?i=t.body:l(t.body)&&(i=JSON.stringify(t.body));let a=l(i),p=to(r,a?2:1),[c,d]=p,x=async()=>{let m=new XMLHttpRequest,_=a?Rt("uploading",m,m.upload,c,!1):Promise.resolve(),O=Rt("saving",m,m,d,!0,_);gn(m,t.method,t.path,t.timeout,s,i),await _,await O;let P=await this.readResponse(t.path,m);return await this.decodeContent(e,P)};return kt(t.retryCount,x)()}};var tr=new URL(globalThis.location.href),Dt=tr.searchParams.has("DEBUG")&&!tr.searchParams.has("RELEASE");function nr(n,e){let t=globalThis,o=t[n];if(u(o)){if(u(e))throw new Error(`No value ${n} found`);o=e(),t[n]=o}return o}var If=nr("juniper::loadedFonts",()=>[]);var os="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ";function or(n,e){if(n<0)throw new Error("Length must be greater than 0");u(e)&&(e=os);let t="";for(let o=0;o<n;++o){let r=Math.floor(Math.random()*e.length);t+=e[r]}return t}var rr="3.7.24";var Qf=Dt?or(10):rr;var is=50,ss=12,Zf=is*ss;var ir={fontFamily:"Lato",fontSize:20};var e_=lt(30,67,136),t_=lt(78,77,77),sr={fontFamily:ir.fontFamily,fontSize:ir.fontSize,textFillColor:"white"},n_=Object.assign({},sr,{bgFillColor:lt(0,120,215),bgStrokeColor:"black",bgStrokeSize:.02,padding:{top:.025,left:.05,bottom:.025,right:.05},minHeight:.2,maxHeight:.2,scale:300}),o_=Object.assign({},sr,{textStrokeColor:"black",textStrokeSize:.01,minHeight:.25,maxHeight:.25});function ar(n=!0){let e=new Mt(new Ot);return new It(e,!Dt)}function vn(n){return l(n)&&n.length>0?parseFloat(n):null}var Xt=class{constructor(e,t){this._url=null;this._base=void 0;this._protocol=null;this._host=null;this._hostName=null;this._userName=null;this._password=null;this._port=null;this._pathName=null;this._hash=null;this._query=new Map;e!==void 0&&(this._url=new URL(e,t),this.rehydrate())}rehydrate(){l(this._protocol)&&this._protocol!==this._url.protocol&&(this._url.protocol=this._protocol),l(this._host)&&this._host!==this._url.host&&(this._url.host=this._host),l(this._hostName)&&this._hostName!==this._url.hostname&&(this._url.hostname=this._hostName),l(this._userName)&&this._userName!==this._url.username&&(this._url.username=this._userName),l(this._password)&&this._password!==this._url.password&&(this._url.password=this._password),l(this._port)&&this._port.toFixed(0)!==this._url.port&&(this._url.port=this._port.toFixed(0)),l(this._pathName)&&this._pathName!==this._url.pathname&&(this._url.pathname=this._pathName),l(this._hash)&&this._hash!==this._url.hash&&(this._url.hash=this._hash);for(let[e,t]of this._query)this._url.searchParams.set(e,t);this._protocol=this._url.protocol,this._host=this._url.host,this._hostName=this._url.hostname,this._userName=this._url.username,this._password=this._url.password,this._port=vn(this._url.port),this._pathName=this._url.pathname,this._hash=this._url.hash,this._url.searchParams.forEach((e,t)=>this._query.set(t,e))}refresh(){if(this._url===null){if(l(this._protocol)&&(l(this._host)||l(this._hostName))){if(l(this._host))return this._url=new URL(`${this._protocol}//${this._host}`,this._base),this._port=vn(this._url.port),this.rehydrate(),!1;if(l(this._hostName))return this._url=new URL(`${this._protocol}//${this._hostName}`,this._base),this.rehydrate(),!1}else if(l(this._pathName)&&l(this._base))return this._url=new URL(this._pathName,this._base),this.rehydrate(),!1}return l(this._url)}base(e){if(this._url!==null)throw new Error("Cannot redefine base after defining the protocol and domain");return this._base=e,this.refresh(),this}protocol(e){return this._protocol=e,this.refresh()&&(this._url.protocol=e),this}host(e){return this._host=e,this.refresh()&&(this._url.host=e,this._hostName=this._url.hostname,this._port=vn(this._url.port)),this}hostName(e){return this._hostName=e,this.refresh()&&(this._url.hostname=e,this._host=`${this._url.hostname}:${this._url.port}`),this}port(e){return this._port=e,this.refresh()&&(this._url.port=e.toFixed(0),this._host=`${this._url.hostname}:${this._url.port}`),this}userName(e){return this._userName=e,this.refresh()&&(this._url.username=e),this}password(e){return this._password=e,this.refresh()&&(this._url.password=e),this}path(e){return this._pathName=e,this.refresh()&&(this._url.pathname=e),this}pathPop(e){return e=e||/\/[^/]+\/?$/,this.path(this._pathName.replace(e,""))}pathPush(e){let t=this._pathName;return t.endsWith("/")||(t+="/"),t+=e,this.path(t)}query(e,t){return this._query.set(e,t),this.refresh()&&this._url.searchParams.set(e,t),this}hash(e){return this._hash=e,this.refresh()&&(this._url.hash=e),this}toURL(){return this._url}toString(){return this._url.href}[Symbol.toStringTag](){return this.toString()}};function pr(n){return u(n)?null:(h(n)&&(n=new URL(n,location.href)),n)}function as(n){if(u(n))throw new Error("URL is undefined");if(n=pr(n),mn(n)){let e=Array.from(n.searchParams.keys()).filter(t=>t!=="v"&&t!=="t");for(let t of e)n.searchParams.delete(t)}return n}function An(n){if(n=pr(n),u(n))throw new Error("URL is undefined");return n=as(n),new Xt("/vr/link",location.href).query("q",n.href).toURL()}(async function(){let n=["https://www.youtube.com/watch?v=sPyAQQklc1s","https://www.youtube.com/watch?v=MgJITGvVfR0","https://www.youtube.com/watch?v=UUzQcPuK8uk","https://www.youtube.com/watch?v=K6uGXtPCjEw","https://www.youtube.com/watch?v=7NGExT9cPKA","https://www.youtube.com/watch?v=mlbWpufL_5s","https://www.youtube.com/watch?v=PqpVB72lZa8","https://www.youtube.com/watch?v=uC7ELzPyrcE"],e=new De,t=new Tt(e,new Be(e.destination)),o=ar(),r=new Et(o,An),i=Un(eo(async()=>{try{i.disabled=!0;let a=s.get(i.value);l(a)?await t.load(a):t.clear()}finally{i.disabled=!1}}),qt("NONE"));if(e.state!=="running"){let a=zn("Load");z("main",a),await e.ready,a.remove()}z("main",i,Gn(),t),i.disabled=!0;let s=new Map(await Promise.all(n.map(async a=>{let p=await r.loadData(An(a).href);return[p.title,p]})));z(i,...Array.from(s.keys()).map(a=>qt(a,On(a)))),i.disabled=!1})();
