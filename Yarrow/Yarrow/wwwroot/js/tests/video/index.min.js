var mr=Object.defineProperty;var Mo=(o,t)=>{for(var e in t)mr(o,e,{get:t[e],enumerable:!0})};var ko=["change","click","contextmenu","dblclick","mouseup","pointerup","reset","submit","touchend"];function gt(o,t=!1){let e=async n=>{if(n.isTrusted){if(!t)for(let r of ko)window.removeEventListener(r,e);o()}};for(let n of ko)window.addEventListener(n,e)}function At(o,t,e){return typeof o===t||o instanceof e}function g(o){return At(o,"function",Function)}function x(o){return At(o,"string",String)}function Vt(o){return At(o,"boolean",Boolean)}function q(o){return At(o,"number",Number)}function ot(o){return c(o)&&At(o,"object",Object)}function it(o){return o instanceof Array}function S(o,t){throw new Error((t||"Unexpected object: ")+o)}function u(o){return o==null}function c(o){return!u(o)}function To(o){return o instanceof Uint8Array||o instanceof Uint8ClampedArray||o instanceof Int8Array||o instanceof Uint16Array||o instanceof Int16Array||o instanceof Uint32Array||o instanceof Int32Array||o instanceof Float32Array||o instanceof Float64Array||"BigUint64Array"in globalThis&&o instanceof globalThis.BigUint64Array||"BigInt64Array"in globalThis&&o instanceof globalThis.BigInt64Array}function Co(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function Eo(o){return ot(o)&&"compareTo"in o&&g(o.compareTo)}function st(o,...t){let e=null;x(o)?e=o:(e="ascending",t.unshift(o));let n=e==="ascending"?1:-1;return Object.assign((i,s)=>{if(i===s)return 0;for(let p of t){let a=u(i)?null:p(i),l=u(s)?null:p(s),d=a===l?0:x(a)&&x(l)?n*a.localeCompare(l):Eo(a)&&Eo(l)?n*a.compareTo(l):e==="ascending"&&a>l||e==="descending"&&a<l?1:-1;if(d!==0)return d}return 0},{direction:e})}function ur(o,t,e,n="search"){let r=0,i=o.length-1;for(;r<=i;){let s=r+i>>1,p=e(o[s],t);if(p===0){if(n!=="search"){let a=n==="append"?1:-1;for(a>0&&(s+=a);0<=s&&s<o.length&&(p=e(o[s],t))===0;)s+=a;a<0&&(s-=a)}return s}else p<0?r=s-p:i=s-p}return-r-1}function Be(o,t,e,n="search"){let r=n!=="set";n==="set"&&(n="search");let i=null;if(q(e)?i=e:i=ur(o,t,e,n),i<0)i=-i-1;else if(!r)return-1;return Fe(o,t,i),i}function E(o){return o.splice(0)}function Po(o,t){for(let e=0;e<o.length;++e)if(o[e]!==t[e])return e;return-1}function Fe(o,t,e){o.splice(e,0,t)}function F(o,t){let e=o.indexOf(t);return e>-1?(ze(o,e),!0):!1}function ze(o,t){return o.splice(t,1)[0]}function xr(o,t,e){let n=o?0:t.length-1,r=o?t.length:-1,i=o?1:-1;for(let s of e)for(let p=n;p!=r;p+=i){let a=t[p];if(s(a))return a}return null}function wt(o,...t){return xr(!0,o,t)}function fr(o){return o[0]}function _r(o){return o.shift()}function hr(o){return o[o.length-1]}function vr(o){return o.pop()}var $t=class{constructor(t){this.value=t,this._forward=new Array,this._reverse=new Array}connectSorted(t,e){if(c(e)){let n=st(r=>e(r.value));Be(this._forward,t,n),Be(t._reverse,this,n)}else this.connectTo(t)}connectTo(t){this.connectAt(t,this._forward.length)}connectAt(t,e){Fe(this._forward,t,e),t._reverse.push(this)}disconnectFrom(t){F(this._forward,t),F(t._reverse,this)}isConnectedTo(t){return this._forward.indexOf(t)>=0||this._reverse.indexOf(t)>=0}flatten(){let t=new Set,e=[this];for(;e.length>0;){let n=e.shift();c(n)&&!t.has(n)&&(t.add(n),e.push(...n._forward))}return Array.from(t)}*traverse(t){let e=new Set,n=[this],r=t?fr:hr,i=t?_r:vr;for(;n.length>0;){let s=r(n);e.has(s)?t||(i(n),yield s):(e.add(s),t&&(i(n),yield s),s._forward.length>0&&n.push(...s._forward))}}breadthFirst(){return this.traverse(!0)}depthFirst(){return this.traverse(!1)}search(t,e=!0){for(let n of this.traverse(e))if(t(n))return n;return null}*searchAll(t,e=!0){for(let n of this.traverse(e))t(n)&&(yield n)}find(t,e=!0){return this.search(n=>n.value===t,e)}findAll(t,e=!0){return this.searchAll(n=>n.value===t,e)}contains(t,e=!0){for(let n of this.traverse(e))if(n===t)return!0;return!1}containsValue(t,e=!0){for(let n of this.traverse(e))if(n.value===t)return!0;return!1}get _isEntryPoint(){return this._reverse.length===0}get _isExitPoint(){return this._forward.length===0}get isDisconnected(){return this._isEntryPoint&&this._isExitPoint}get isConnected(){return!this._isExitPoint||!this._isEntryPoint}get isTerminus(){return this._isEntryPoint||this._isExitPoint}get isInternal(){return!this._isEntryPoint&&!this._isExitPoint}};var Kt=class extends $t{get connections(){return this._forward}get isEntryPoint(){return this._isEntryPoint}get isExitPoint(){return this._isExitPoint}};var b=class{constructor(t=!0){this.autoStart=t,this.onThens=new Array,this.onCatches=new Array,this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",this.resolve=e=>{if(this.running){this._result=e,this._resultState="resolved";for(let n of this.onThens)n(e);this.clear(),this._executionState="finished"}},this.reject=e=>{if(this.running){this._error=e,this._resultState="errored";for(let n of this.onCatches)n(e);this.clear(),this._executionState="finished"}},this.autoStart&&this.start()}clear(){E(this.onThens),E(this.onCatches)}start(){this._executionState="running"}resolver(t){return()=>this.resolve(t)}resolveOn(t,e,n){let r=this.resolver(n);t.addEventListener(e,r),this.finally(()=>t.removeEventListener(e,r))}get result(){if(c(this.error))throw this.error;return this._result}get error(){return this._error}get executionState(){return this._executionState}get waiting(){return this.executionState==="waiting"}get started(){return this.executionState!=="waiting"}get running(){return this.executionState==="running"}get finished(){return this.executionState==="finished"}get resultState(){return this._resultState}get resolved(){return this.resultState==="resolved"}get errored(){return this.resultState==="errored"}get[Symbol.toStringTag](){return this.toString()}project(){return new Promise((t,e)=>{this.finished?this.errored?e(this.error):t(this.result):(this.onThens.push(t),this.onCatches.push(e))})}then(t,e){return this.project().then(t,e)}catch(t){return this.project().catch(t)}finally(t){return this.project().finally(t)}reset(){this._reset(this.autoStart)}restart(){this._reset(!0)}_reset(t){this.running&&this.reject("Resetting previous invocation"),this.clear(),this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",t&&this.start()}};function bt(o){return c(o)&&"_resolveInput"in o}function yt(o){return bt(o)&&"_resolveOutput"in o}var pt=class{constructor(){this.listeners=new Map,this.listenerOptions=new Map,this.bubblers=new Set,this.scopes=new WeakMap}addBubbler(t){this.bubblers.add(t)}removeBubbler(t){this.bubblers.delete(t)}addScopedEventListener(t,e,n,r){this.scopes.has(t)||this.scopes.set(t,[]),this.scopes.get(t).push([e,n]),this.addEventListener(e,n,r)}removeScope(t){let e=this.scopes.get(t);if(e){this.scopes.delete(t);for(let[n,r]of e)this.removeEventListener(n,r)}}addEventListener(t,e,n){let r=this.listeners.get(t);r||(r=new Array,this.listeners.set(t,r)),r.find(i=>i===e)||(r.push(e),n&&this.listenerOptions.set(e,n))}removeEventListener(t,e){let n=this.listeners.get(t);n&&this.removeListener(n,e)}clearEventListeners(t){for(let[e,n]of this.listeners)if(u(t)||t===e){for(let r of n)this.removeEventListener(t,r);E(n),this.listeners.delete(e)}}removeListener(t,e){let n=t.findIndex(r=>r===e);n>=0&&(ze(t,n),this.listenerOptions.has(e)&&this.listenerOptions.delete(e))}dispatchEvent(t){let e=this.listeners.get(t.type);if(e)for(let n of e){let r=this.listenerOptions.get(n);c(r)&&!Vt(r)&&r.once&&this.removeListener(e,n),g(n)?n.call(this,t):n.handleEvent(t)}if(t.defaultPrevented)return!1;for(let n of this.bubblers)if(!n.dispatchEvent(t))return!1;return!0}};var M=class extends Event{get type(){return super.type}constructor(t,e){super(t,e)}},H=class extends pt{addBubbler(t){super.addBubbler(t)}removeBubbler(t){super.removeBubbler(t)}addScopedEventListener(t,e,n,r){super.addScopedEventListener(t,e,n,r)}addEventListener(t,e,n){super.addEventListener(t,e,n)}removeEventListener(t,e){super.removeEventListener(t,e)}clearEventListeners(t){return super.clearEventListeners(t)}};var at=class extends H{get name(){return this._name}set name(t){this._name=t,this.context._name(this,t)}constructor(t,e){super(),this.nodeType=t,this.context=e,this._name=null,this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.onDisposing())}onDisposing(){}isConnected(t,e,n){return this.context._isConnected(this,t,e,n)}resolveOutput(t){let e={source:this,output:t};for(;yt(e.source);)e=e.source._resolveOutput(e.output);return e}resolveInput(t){let e={destination:this,input:t};for(;bt(e.destination);)e=e.destination._resolveInput(e.input);return e}toggle(t,e,n){this._toggle(t,e,n)}_toggle(t,e,n){if(this.isConnected(t,e,n))this._disconnect(t,e,n);else return this._connect(t,e,n)}connect(t,e,n){return this._connect(t,e,n)}_connect(t,e,n){return this.context._connect(this,t,e,n)}disconnect(t,e,n){this._disconnect(t,e,n)}_disconnect(t,e,n){this.context._disconnect(this,t,e,n)}};var f=class extends at{constructor(t,e,n){super(t,e),this._node=n,this.context._init(this._node,this.nodeType)}onDisposing(){this.disconnect(),this.context._dispose(this._node),super.onDisposing()}parent(t){this.context._parent(this,t)}get channelCount(){return this._node.channelCount}set channelCount(t){this._node.channelCount=t}get channelCountMode(){return this._node.channelCountMode}set channelCountMode(t){this._node.channelCountMode=t}get channelInterpretation(){return this._node.channelInterpretation}set channelInterpretation(t){this._node.channelInterpretation=t}get numberOfInputs(){return this._node.numberOfInputs}get numberOfOutputs(){return this._node.numberOfOutputs}_resolveInput(t){return{destination:this._node,input:t}}_resolveOutput(t){return{source:this._node,output:t}}};var Yt=class extends f{constructor(t,e){super("analyser",t,new AnalyserNode(t,e))}get fftSize(){return this._node.fftSize}set fftSize(t){this._node.fftSize=t}get frequencyBinCount(){return this._node.frequencyBinCount}get maxDecibels(){return this._node.maxDecibels}set maxDecibels(t){this._node.maxDecibels=t}get minDecibels(){return this._node.minDecibels}set minDecibels(t){this._node.minDecibels=t}get smoothingTimeConstant(){return this._node.smoothingTimeConstant}set smoothingTimeConstant(t){this._node.smoothingTimeConstant=t}getByteFrequencyData(t){this._node.getByteFrequencyData(t)}getByteTimeDomainData(t){this._node.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._node.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._node.getFloatTimeDomainData(t)}};var v=class{get name(){return this._name}set name(t){this._name=t,this.context._name(this,t)}constructor(t,e,n){this.nodeType=t,this.context=e,this.param=n,this._name=null,this.disposed=!1,this.context._init(this.param,this.nodeType)}dispose(){this.disposed||(this.disposed=!0,this.onDisposing())}onDisposing(){this.context._dispose(this.param)}get automationRate(){return this.param.automationRate}set automationRate(t){this.param.automationRate=t}get defaultValue(){return this.param.defaultValue}get maxValue(){return this.param.maxValue}get minValue(){return this.param.minValue}get value(){return this.param.value}set value(t){this.param.value=t}cancelAndHoldAtTime(t){return this.param.cancelAndHoldAtTime(t),this}cancelScheduledValues(t){return this.param.cancelScheduledValues(t),this}exponentialRampToValueAtTime(t,e){return this.param.exponentialRampToValueAtTime(t,e),this}linearRampToValueAtTime(t,e){return this.param.linearRampToValueAtTime(t,e),this}setTargetAtTime(t,e,n){return this.param.setTargetAtTime(t,e,n),this}setValueAtTime(t,e){return this.param.setValueAtTime(t,e),this}setValueCurveAtTime(t,e,n){return this.param.setValueCurveAtTime(t,e,n),this}_resolveInput(){return{destination:this.param}}resolveInput(){return this._resolveInput()}};var Zt=class extends f{constructor(t,e){super("audio-buffer-source",t,new AudioBufferSourceNode(t,e)),this._node.addEventListener("ended",()=>this.dispatchEvent(new M("ended"))),this.parent(this.playbackRate=new v("playbackRate",t,this._node.playbackRate)),this.parent(this.detune=new v("detune",t,this._node.detune))}get buffer(){return this._node.buffer}set buffer(t){this._node.buffer=t}get loop(){return this._node.loop}set loop(t){this._node.loop=t}get loopEnd(){return this._node.loopEnd}set loopEnd(t){this._node.loopEnd=t}get loopStart(){return this._node.loopStart}set loopStart(t){this._node.loopStart=t}get onended(){return this._node.onended}set onended(t){this._node.onended=t}start(t,e,n){this._node.start(t,e,n)}stop(t){this._node.stop(t)}};var Qt=class extends f{constructor(t,e){super("destination",t,e)}get maxChannelCount(){return this._node.maxChannelCount}};var Z=class extends f{constructor(t,e){super("biquad-filter",t,new BiquadFilterNode(t,e)),this.parent(this.Q=new v("Q",this.context,this._node.Q)),this.parent(this.detune=new v("detune",this.context,this._node.detune)),this.parent(this.frequency=new v("frequency",this.context,this._node.frequency)),this.parent(this.gain=new v("gain",this.context,this._node.gain))}get type(){return this._node.type}set type(t){this._node.type=t}getFrequencyResponse(t,e,n){this._node.getFrequencyResponse(t,e,n)}};var te=class extends f{constructor(t,e){super("channel-merger",t,new ChannelMergerNode(t,e))}};var ee=class extends f{constructor(t,e){super("channel-splitter",t,new ChannelSplitterNode(t,e))}};var oe=class extends f{constructor(t,e){super("constant-source",t,new ConstantSourceNode(t,e)),this._node.addEventListener("ended",()=>this.dispatchEvent(new M("ended"))),this.parent(this.offset=new v("offset",this.context,this._node.offset))}get onended(){return this._node.onended}set onended(t){this._node.onended=t}start(t){this._node.start(t)}stop(t){this._node.stop(t)}};var ne=class extends f{constructor(t,e){super("convolver",t,new ConvolverNode(t,e))}get buffer(){return this._node.buffer}set buffer(t){this._node.buffer=t}get normalize(){return this._node.normalize}set normalize(t){this._node.normalize=t}};var re=class extends f{constructor(t,e){super("delay",t,new DelayNode(t,e)),this.parent(this.delayTime=new v("delay",this.context,this._node.delayTime))}};var ie=class extends f{constructor(t,e){super("dynamics-compressor",t,new DynamicsCompressorNode(t,e)),this.parent(this.attack=new v("attack",this.context,this._node.attack)),this.parent(this.knee=new v("knee",this.context,this._node.knee)),this.parent(this.ratio=new v("ratio",this.context,this._node.ratio)),this.parent(this.release=new v("release",this.context,this._node.release)),this.parent(this.threshold=new v("threshold",this.context,this._node.threshold))}get reduction(){return this._node.reduction}};var $=class extends f{constructor(t,e){super("gain",t,new GainNode(t,e)),this.parent(this.gain=new v("gain",this.context,this._node.gain))}};var se=class extends f{constructor(t,e){super("iir-filter",t,new IIRFilterNode(t,e))}getFrequencyResponse(t,e,n){this._node.getFrequencyResponse(t,e,n)}};var Q=class extends f{constructor(t,e){super("media-element-audio-source",t,new MediaElementAudioSourceNode(t,e))}get mediaElement(){return this._node.mediaElement}};var St=class extends f{constructor(t,e){super("media-stream-audio-destination",t,new MediaStreamAudioDestinationNode(t,e))}get stream(){return this._node.stream}};function ct(o){return o}function Xo(){return!0}function Io(){return!1}var gr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ";function Ge(o,t){if(o<0)throw new Error("Length must be greater than 0");u(t)&&(t=gr);let e="";for(let n=0;n<o;++n){let r=Math.floor(Math.random()*t.length);e+=t[r]}return e}var Do=new Map,pe=class{constructor(t,e,n,...r){this.key=t,this.value=e,this.bySetAttribute=n,this.tags=r.map(i=>i.toLocaleUpperCase()),Object.freeze(this)}applyToElement(t){if(this.tags.length>0&&this.tags.indexOf(t.tagName)===-1){let e=Do.get(t.tagName);e||Do.set(t.tagName,e=new Set),e.has(this.key)||(e.add(this.key),console.warn(`Element ${t.tagName} does not support Attribute ${this.key}`))}this.bySetAttribute?t.setAttribute(this.key,this.value.toString()):this.key in t?t[this.key]=this.value:this.value===!1?t.removeAttribute(this.key):this.value===!0?t.setAttribute(this.key,""):g(this.value)?this.value(t):t.setAttribute(this.key,this.value.toString())}};function N(o,t,e,...n){return new pe(o,t,e,...n)}function Oo(o){return o instanceof pe}function Mt(o){return N("autoplay",o,!1,"audio","video")}function Ro(...o){return o=o.filter(ct),N("CLASS_LIST",t=>t.classList.add(...o),!1)}function nt(o){return N("controls",o,!1,"audio","video")}function jo(o){return N("height",o,!1,"canvas","embed","iframe","img","input","object","video")}function kt(o){return N("loop",o,!1,"audio","bgsound","marquee","video")}function Lo(o){return N("muted",o,!1,"audio","video")}function We(o){return N("rel",o,!1,"a","area","link")}function Ar(o){return o instanceof URL&&(o=o.href),o}function ae(o){return N("src",Ar(o),!1,"audio","embed","iframe","img","input","script","source","track","video")}function qe(o){return N("srcObject",o,!1,"audio","video")}function Tt(o){return x(o)||(o=o.value),N("type",o,!1,"button","input","command","embed","link","object","script","source","style","menu")}function No(o){return N("value",o,!1,"button","data","input","li","meter","option","progress","param")}function Bo(o){return N("width",o,!1,"canvas","embed","iframe","img","input","object","video")}function ce(...o){return`rgb(${o.join(", ")})`}var Je=class{constructor(t){this._value=t}get value(){return this._value}toString(){return this.value}};var Ue=class extends Je{constructor(t,e,n){super(n),this._name=t,this.sep=e}get name(){return this._name}toString(){return this.name+this.sep+this.value+";"}};var He=class extends Ue{constructor(t,e){super(t,": ",e)}},Ct=class extends He{constructor(t,e){super(t.replace(/[A-Z]/g,n=>`-${n.toLocaleLowerCase()}`),e.toString()),this.key=t,this.priority=""}applyToElement(t){t.style[this.key]=this.value+this.priority}important(){return this.priority=" !important",this}get value(){return super.value+this.priority}};function le(o){return new Ct("cursor",o)}function Et(o){return new Ct("display",o)}function de(o){return new Ct("opacity",o)}function Fo(o,t){return"on"+t in o}function k(o,t,e,...n){u(n)&&(n=[]);let r;if(x(e)?n.unshift(e):q(e)&&(r=e),!(o instanceof pt)){if(!Fo(o,t))throw new Error(`Target does not have a ${t} rejection event`);for(let a of n)if(!Fo(o,a))throw new Error(`Target does not have a ${a} rejection event`)}let i=new b;if(q(r)){let a=setTimeout(i.reject,r,`'${t}' has timed out.`);i.finally(clearTimeout.bind(globalThis,a))}let s=(a,l)=>{o.addEventListener(a,l),i.finally(()=>o.removeEventListener(a,l))};s(t,a=>i.resolve(a));let p=a=>i.reject(a);for(let a of n)s(a,p);return i}function z(o){return o.then(Xo).catch(Io)}var zo=/([^\/]+)\/(.+)/,Vr=/(?:([^\.]+)\.)?([^\+;]+)(?:\+([^;]+))?((?:; *([^=]+)=([^;]+))*)/;var Pt=class o{constructor(t,e,n){this._type=t,this._fullSubType=e,this._primaryExtension=null,this.depMessage=null;let r=new Map;this._parameters=r;let i=this._fullSubType.match(Vr);this._tree=i[1],this._subType=i[2],this._suffix=i[3];let s=i[4];if(this._value=this._fullValue=this._type+"/",c(this._tree)&&(this._value=this._fullValue+=this._tree+"."),this._value=this._fullValue+=this._subType,c(this._suffix)&&(this._value=this._fullValue+="+"+this._suffix),c(s)){let p=s.split(";").map(a=>a.trim()).filter(a=>a.length>0).map(a=>a.split("="));for(let[a,...l]of p){let d=l.join("=");r.set(a,d);let _=`; ${a}=${d}`;this._fullValue+=_,a!=="q"&&(this._value+=_)}}this._extensions=n||[],this._primaryExtension=this._extensions[0]||null}static parse(t){if(!t)return null;let e=t.match(zo);if(!e)return null;let n=e[1],r=e[2];return new o(n,r)}deprecate(t){return this.depMessage=t,this}check(){c(this.depMessage)&&console.warn(`${this._value} is deprecated ${this.depMessage}`)}matches(t){if(u(t))return!1;if(this.typeName==="*"&&this.subTypeName==="*")return!0;let e=null,n=null;if(x(t)){let r=t.match(zo);if(!r)return!1;e=r[1],n=r[2]}else e=t.typeName,n=t._fullSubType;return this.typeName===e&&(this._fullSubType==="*"||this._fullSubType===n)}withParameter(t,e){let n=`${this._fullSubType}; ${t}=${e}`;return new o(this.typeName,n,this.extensions)}get typeName(){return this.check(),this._type}get tree(){return this.check(),this._tree}get suffix(){return this._suffix}get subTypeName(){return this.check(),this._subType}get value(){return this.check(),this._value}__getValueUnsafe(){return this._value}get fullValue(){return this.check(),this._fullValue}get parameters(){return this.check(),this._parameters}get extensions(){return this.check(),this._extensions}__getExtensionsUnsafe(){return this._extensions}get primaryExtension(){return this.check(),this._primaryExtension}toString(){return this.parameters.get("q")==="1"?this.value:this.fullValue}toFileSystemAPIAccepts(){return{[this.value]:this.extensions.map(t=>"."+t)}}addExtension(t){if(!t)throw new Error("File name is not defined");return this.primaryExtension&&(t=o.removeExtension(t),t=`${t}.${this.primaryExtension}`),t}static removeExtension(t){let e=t.lastIndexOf(".");return e>-1&&(t=t.substring(0,e)),t}};function wr(o,t,...e){return new Pt(o,t,e)}function P(o){return wr.bind(null,o)}var $e=P("application");var lt=$e("javascript","js");var Ke=$e("json","json");var Ye=$e("wasm","wasm");var Ze=P("text");var Xt=Ze("css","css");var me=Ze("plain","txt","text","conf","def","list","log","in");var Go=Ze("xml");var br=P("video");var Wo=br("vnd.mpeg.dash.mpd","mpd");function qo(o){return ot(o)?o.element instanceof Element:!1}function Jo(o){return qo(o)?o.element:x(o)?Uo(o):o}function yr(o){return ot(o)&&"applyToElement"in o&&g(o.applyToElement)}function Qe(o,t,e=""){o=Jo(o),t?(o.style.removeProperty("display"),getComputedStyle(o).display==="none"&&(o.style.display=e||"block")):o.style.display="none"}function G(o,...t){let e=o instanceof Element||o instanceof ShadowRoot?o:x(o)?document.querySelector(o):o.element,n=e instanceof HTMLTemplateElement?e.content:e;for(let r of t)c(r)&&(r instanceof Node?n.appendChild(r):qo(r)?n.appendChild(Jo(r)):yr(r)?e instanceof ShadowRoot||r.applyToElement(e):n.appendChild(document.createTextNode(r.toLocaleString())));return e}function Uo(o){return document.querySelector(o)}function Ho(o){return Uo(o)}function W(o,...t){let e=null,n=t.filter(Oo).filter(r=>r.key==="id"||r.key==="query");for(let r of n)r.key==="query"?(e=r.value,F(t,r)):r.key==="id"&&(e=document.getElementById(r.value),e&&F(t,r));return e&&e.tagName!==o.toUpperCase()&&console.warn(`Expected a "${o.toUpperCase()}" element but found a "${e.tagName}".`),e||(e=document.createElement(o)),G(e,...t),e}async function Sr(o,t,e){c(e)&&e.start();let n=o==="canplay"?t.HAVE_CURRENT_DATA:t.HAVE_ENOUGH_DATA;if(t.readyState>=n)return!0;try{return await k(t,o,"error"),!0}catch(r){return console.warn(t.error,r),!1}finally{c(e)&&e.end()}}function $o(o,t){return Sr("canplaythrough",o,t)}function dt(...o){return W("audio",...o)}function Ko(){return W("br")}function Mr(...o){return W("button",...o)}function kr(...o){return Mr(...o,Tt("button"))}function Yo(...o){return kr(...o,Ro("btn","btn-primary"))}function Zo(...o){return W("canvas",...o)}function Qo(...o){return W("div",...o)}function It(...o){return W("img",...o)}function tn(...o){return W("link",...o)}function to(...o){return W("option",...o)}function en(...o){return W("script",...o)}function on(...o){return W("select",...o)}function nn(...o){return W("video",...o)}var Tr="AudioContext"in globalThis,rn=Tr&&"AudioListener"in globalThis,Cr=rn&&"setPosition"in AudioListener.prototype,sn=rn&&"positionX"in AudioListener.prototype,eo="createMediaStreamSource"in AudioContext.prototype,Xa=g(HTMLMediaElement.prototype.captureStream)||g(HTMLMediaElement.prototype.mozCaptureStream);var Dt=class extends f{constructor(t,e){let n=dt(nt(!1),Lo(eo),Mt(!0),kt(!1),Et("none"),qe(e.mediaStream)),r;eo?r=new MediaStreamAudioSourceNode(t,e):r=new MediaElementAudioSourceNode(t,{mediaElement:n}),super("media-stream-audio-source",t,r),this._stream=e.mediaStream,this._element=n}onDisposing(){this._element.pause(),super.onDisposing()}get mediaStream(){return this._stream}};var ue=class extends f{constructor(t,e){super("oscillator",t,new OscillatorNode(t,e)),this._node.addEventListener("ended",()=>this.dispatchEvent(new M("ended"))),this.parent(this.detune=new v("detune",this.context,this._node.detune)),this.parent(this.frequency=new v("frequency",this.context,this._node.frequency))}get type(){return this._node.type}set type(t){this._node.type=t}get onended(){return this._node.onended}set onended(t){this._node.onended=t}setPeriodicWave(t){this._node.setPeriodicWave(t)}start(t){this._node.start(t)}stop(t){this._node.stop(t)}};var Ot=class extends f{constructor(t,e){super("panner",t,new PannerNode(t,e)),this.parent(this.positionX=new v("positionX",this.context,this._node.positionX)),this.parent(this.positionY=new v("positionY",this.context,this._node.positionY)),this.parent(this.positionZ=new v("positionZ",this.context,this._node.positionZ)),this.parent(this.orientationX=new v("orientationX",this.context,this._node.orientationX)),this.parent(this.orientationY=new v("orientationY",this.context,this._node.orientationY)),this.parent(this.orientationZ=new v("orientationZ",this.context,this._node.orientationZ))}get coneInnerAngle(){return this._node.coneInnerAngle}set coneInnerAngle(t){this._node.coneInnerAngle=t}get coneOuterAngle(){return this._node.coneOuterAngle}set coneOuterAngle(t){this._node.coneOuterAngle=t}get coneOuterGain(){return this._node.coneOuterGain}set coneOuterGain(t){this._node.coneOuterGain=t}get distanceModel(){return this._node.distanceModel}set distanceModel(t){this._node.distanceModel=t}get maxDistance(){return this._node.maxDistance}set maxDistance(t){this._node.maxDistance=t}get panningModel(){return this._node.panningModel}set panningModel(t){this._node.panningModel=t}get refDistance(){return this._node.refDistance}set refDistance(t){this._node.refDistance=t}get rolloffFactor(){return this._node.rolloffFactor}set rolloffFactor(t){this._node.rolloffFactor=t}setOrientation(t,e,n){this._node.setOrientation(t,e,n)}setPosition(t,e,n){this._node.setPosition(t,e,n)}};var xe=class extends f{constructor(t,e){super("stereo-panner",t,new StereoPannerNode(t,e)),this.parent(this.pan=new v("pan",this.context,this._node.pan))}};var fe=class extends f{constructor(t,e){super("wave-shaper",t,new WaveShaperNode(t,e))}get curve(){return this._node.curve}set curve(t){this._node.curve=t}get oversample(){return this._node.oversample}set oversample(t){this._node.oversample=t}};!("AudioContext"in globalThis)&&"webkitAudioContext"in globalThis&&(globalThis.AudioContext=globalThis.webkitAudioContext);!("OfflineAudioContext"in globalThis)&&"webkitOfflineAudioContext"in globalThis&&(globalThis.OfflineAudioContext=globalThis.webkitOfflineAudioContext);var oo=class{constructor(t,e){this.type=t,this.name=e,this.connections=new Set}};function _e(o,t,e,n,r){return o.type===t&&(u(e)||e===o.destination)&&(u(n)||n===o.output)&&(u(r)||r===o.input)}function mt(o,t){let e=null,n=null;return c(o)&&({destination:e,input:n}=o.resolveInput(t)),{destination:e,input:n}}var Rt=class extends AudioContext{get ready(){return this._ready}get isReady(){return this._ready.finished&&this._ready.resolved}constructor(t){super(t),this.counters=new Map,this.nodes=new Map,this._ready=new b,this._destination=new Qt(this,super.destination),this.state==="running"?this._ready.resolve():this.state==="closed"?this.resume().then(()=>this._ready.resolve()):gt(()=>this.resume().then(()=>this._ready.resolve())),this.ready.then(()=>console.log("Audio is now ready"))}_init(t,e){if(!this.nodes.has(t)){this.counters.has(e)||this.counters.set(e,0);let n=this.counters.get(e),r=`${e}-${n}`;this.nodes.set(t,new oo(e,r)),bt(t)&&(t.name=r),this.counters.set(e,n+1)}}_name(t,e){let{destination:n}=mt(t);if(this.nodes.has(n)){let r=this.nodes.get(n);r.name=`${e}-${r.type}`}}_dispose(t){this.nodes.delete(t)}_isConnected(t,e,n,r){let{source:i,output:s}=t.resolveOutput(n),{destination:p,input:a}=mt(e,r);if(u(i)||!this.nodes.has(i))return null;{let l=this.nodes.get(i);for(let d of l.connections)if(_e(d,"conn",p,s,a))return!0;return!1}}_parent(t,e){let{source:n}=t.resolveOutput(),{destination:r}=mt(e);this.nodes.has(n)&&this.nodes.get(n).connections.add({type:"parent",src:t,dest:e,destination:r,source:n})}_unparent(t,e){let{source:n}=t.resolveOutput(),{destination:r}=mt(e);if(this.nodes.has(n)){let i=this.nodes.get(n).connections,s=new Set;for(let p of i)_e(p,"parent",r)&&s.add(p);for(let p of s)i.delete(p)}}_getConnections(t){return this.nodes.has(t)?this.nodes.get(t).connections:null}_connect(t,e,n,r){let{source:i,output:s}=t.resolveOutput(n),{destination:p,input:a}=mt(e,r);if(this.nodes.has(i)){let l=this.nodes.get(i).connections,d=!1;for(let _ of l)_e(_,"conn",p,s,a)&&(d=!0);d||l.add({type:"conn",src:t,dest:e,outp:n,inp:r,source:i,destination:p,output:s,input:a})}if(p instanceof AudioNode)return e=e,c(a)?(i.connect(p,s,a),e):c(s)?(i.connect(p,s),e):(i.connect(p),e);p instanceof AudioParam?c(s)?i.connect(p,s):c(p)?i.connect(p):S(p):S(p)}_disconnect(t,e,n,r){let i;q(e)?(i=void 0,n=e):i=e;let{source:s,output:p}=t.resolveOutput(n),{destination:a,input:l}=mt(i,r);if(this.nodes.has(s)){let d=this.nodes.get(s).connections,_=new Set;for(let m of d)_e(m,"conn",a,p,l)&&_.add(m);for(let m of _)d.delete(m)}a instanceof AudioNode?c(r)?s.disconnect(a,n,r):c(n)?s.disconnect(a,n):c(a)?s.disconnect(a):s.disconnect():c(n)?s.disconnect(a,n):c(a)?s.disconnect(a):s.disconnect()}getAudioGraph(t){let e=new Map;for(let[n,r]of this.nodes){let i=n instanceof AudioNode?"node":n instanceof AudioParam?"param":"unknown";(t||i!=="param")&&e.set(n,new Kt({name:r.name,type:r.type,nodeClass:i}))}for(let[n,r]of this.nodes){let i=e.get(n);for(let s of r.connections){let p=s.destination;if(e.has(p)){let a=e.get(p);i.connectTo(a),a.connectTo(i)}}}return Array.from(e.values())}get destination(){return this._destination}createAnalyser(){return new Yt(this)}createBiquadFilter(){return new Z(this)}createBufferSource(){return new Zt(this)}createChannelMerger(t){return new te(this,{numberOfInputs:t})}createChannelSplitter(t){return new ee(this,{numberOfOutputs:t})}createConstantSource(){return new oe(this)}createConvolver(){return new ne(this)}createDelay(t){return new re(this,{maxDelayTime:t})}createDynamicsCompressor(){return new ie(this)}createGain(){return new $(this)}createIIRFilter(t,e){return new se(this,{feedforward:t,feedback:e})}createMediaElementSource(t){return new Q(this,{mediaElement:t})}createMediaStreamDestination(){return new St(this)}createMediaStreamSource(t){return new Dt(this,{mediaStream:t})}createOscillator(){return new ue(this)}createPanner(){return new Ot(this)}createStereoPanner(){return new xe(this)}createWaveShaper(){return new fe(this)}createScriptProcessor(){throw new Error("Script processor nodes are deprecated")}};function no(o,...t){if(!ot(o))return!1;o=o;for(let e of t){if(!(e in o))return!1;let n=o[e];if(!g(n))return!1}return!0}function Er(o){return no(o,"dispose")}function Pr(o){return no(o,"destroy")}function Xr(o){return no(o,"close")}function X(o){Er(o)&&o.dispose(),Xr(o)&&o.close(),Pr(o)&&o.destroy()}function pn(o,t){try{return t(o)}finally{X(o)}}var J=class o extends at{get exemplar(){return this.allNodes[0]}constructor(t,e,n,r,i){super(t,e),n=n||[],i=i||[];let s=r||n;this.inputs=n;let p=n.filter(yt).map(a=>a);this.outputs=s.filter(yt).map(a=>a),this.allNodes=Array.from(new Set([...p,...this.outputs,...i]))}add(t){this.allNodes.push(t),this.context._parent(this,t)}remove(t){F(this.allNodes,t),this.context._unparent(this,t)}onDisposing(){this.allNodes.forEach(X),super.onDisposing()}get channelCount(){return this.exemplar.channelCount}set channelCount(t){this.allNodes.forEach(e=>e.channelCount=t)}get channelCountMode(){return this.exemplar.channelCountMode}set channelCountMode(t){this.allNodes.forEach(e=>e.channelCountMode=t)}get channelInterpretation(){return this.exemplar.channelInterpretation}set channelInterpretation(t){this.allNodes.forEach(e=>e.channelInterpretation=t)}get numberOfInputs(){return this.inputs.length}get numberOfOutputs(){return this.outputs.length}static resolve(t,e){return e=e||0,e<0||t.length<=e?null:t[e]}_resolveInput(t){return{destination:o.resolve(this.inputs,t)}}_resolveOutput(t){return{source:o.resolve(this.outputs,t)}}};var jt=class extends J{constructor(t,e,n,r,i,s){super(t,e,r,i,s),this.spatialized=n,this._minDistance=1,this._maxDistance=10,this._algorithm="inverse"}get minDistance(){return this._minDistance}get maxDistance(){return this._maxDistance}get algorithm(){return this._algorithm}setAudioProperties(t,e,n){this._minDistance=t,this._maxDistance=e,this._algorithm=n}};var Lt=class extends jt{constructor(t){super("no-spatializer",t.context,!1,[t],[t])}readPose(t){}getGainAtDistance(t){return 1}};var ut=class extends H{constructor(){super(...arguments),this.attached=new Array,this.soFar=null,this.total=null,this.msg=null,this.est=null}get p(){return this.total>0?this.soFar/this.total:0}report(t,e,n,r){this.soFar=t,this.total=e,this.msg=n,this.est=r;for(let i of this.attached)i.report(t,e,n,r)}attach(t){this.attached.push(t),t.report(this.soFar,this.total,this.msg,this.est)}clear(){this.report(0,0),this._clear()}start(t){this.report(0,1,t||"starting")}end(t){this.report(1,1,t||"done"),this._clear()}_clear(){this.soFar=null,this.total=null,this.msg=null,this.est=null,E(this.attached)}};var ro=class{constructor(t,e,n){if(this.name=t,this.callback=e,!g(e))throw new Error("A function instance is required for this parameter");this.opts=n,Object.freeze(this)}applyToElement(t){this.add(t)}add(t){t.addEventListener(this.name,this.callback,this.opts)}remove(t){t.removeEventListener(this.name,this.callback)}};function Ir(o,t,e){return new ro(o,t,e)}function an(o,t){return Ir("input",o,t)}function he(...o){return Promise.all(o)}var Nt=class extends ut{constructor(t,e){super(),this.i=t,this.prog=e}report(t,e,n,r){super.report(t,e,n,r),this.prog.update(this.i,t,e,n)}};var ve=class{constructor(t){this.prog=t,this.weightTotal=0,this.subProgressCallbacks=new Array,this.subProgressWeights=new Array,this.subProgressValues=new Array,this.start=performance.now();for(let e=0;e<this.subProgressWeights.length;++e)this.subProgressValues[e]=0,this.subProgressCallbacks[e]=new Nt(e,this)}addSubProgress(t){t=t||1,this.weightTotal+=t,this.subProgressWeights.push(t),this.subProgressValues.push(0);let e=new Nt(this.subProgressCallbacks.length,this);return this.subProgressCallbacks.push(e),e}update(t,e,n,r){if(this.prog){this.subProgressValues[t]=e/n;let i=0;for(let l=0;l<this.subProgressWeights.length;++l)i+=this.subProgressValues[l]*this.subProgressWeights[l];let s=performance.now(),p=s-this.start,a=this.start-s+p*this.weightTotal/i;this.prog.report(i,this.weightTotal,r,a)}}};function Bt(o,t){return new io(t,o).subProgressCallbacks}function cn(o,t){let e=new Array(t);for(let n=0;n<t;++n)e[n]=1;return Bt(o,e)}var io=class extends ve{constructor(t,e){super(e);for(let n of t)this.addSubProgress(n)}};function ln(o){if(o.status>=400)throw new Error("Resource could not be retrieved: "+o.requestPath);return o}function Ft(o){let{content:t}=ln(o);return t}var Dr=/OculusBrowser\/(\d+)\.(\d+)\.(\d+)/i,ge=navigator.userAgent.match(Dr),Ae=!!ge,Yc=Ae&&{major:parseFloat(ge[1]),minor:parseFloat(ge[2]),patch:parseFloat(ge[3])},Zc=Ae&&/pacific/i.test(navigator.userAgent),Qc=Ae&&/quest/i.test(navigator.userAgent),tl=Ae&&/quest 2/i.test(navigator.userAgent);var Or="Worker"in globalThis;var jr=st(o=>o.label);var fl=g(HTMLAudioElement.prototype.setSinkId);var R=1e-6,T=typeof Float32Array<"u"?Float32Array:Array,tt=Math.random;var hl=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var o=0,t=arguments.length;t--;)o+=arguments[t]*arguments[t];return Math.sqrt(o)});function dn(){var o=new T(9);return T!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}var xt={};Mo(xt,{add:()=>Ni,calculateW:()=>Ti,clone:()=>Oi,conjugate:()=>Xi,copy:()=>ji,create:()=>ao,dot:()=>Ln,equals:()=>qi,exactEquals:()=>Wi,exp:()=>Dn,fromEuler:()=>Ii,fromMat3:()=>Rn,fromValues:()=>Ri,getAngle:()=>yi,getAxisAngle:()=>bi,identity:()=>wi,invert:()=>Pi,len:()=>zi,length:()=>Nn,lerp:()=>Fi,ln:()=>On,mul:()=>Bi,multiply:()=>In,normalize:()=>co,pow:()=>Ci,random:()=>Ei,rotateX:()=>Si,rotateY:()=>Mi,rotateZ:()=>ki,rotationTo:()=>Ji,scale:()=>jn,set:()=>Li,setAxes:()=>Hi,setAxisAngle:()=>Xn,slerp:()=>Se,sqlerp:()=>Ui,sqrLen:()=>Gi,squaredLength:()=>Bn,str:()=>Di});var B={};Mo(B,{add:()=>zr,angle:()=>ai,bezier:()=>ti,ceil:()=>Gr,clone:()=>Nr,copy:()=>Br,create:()=>we,cross:()=>zt,dist:()=>_i,distance:()=>_n,div:()=>fi,divide:()=>fn,dot:()=>ye,equals:()=>mi,exactEquals:()=>di,floor:()=>Wr,forEach:()=>gi,fromValues:()=>be,hermite:()=>Qr,inverse:()=>Yr,len:()=>po,length:()=>mn,lerp:()=>Zr,max:()=>Jr,min:()=>qr,mul:()=>xi,multiply:()=>xn,negate:()=>Kr,normalize:()=>so,random:()=>ei,rotateX:()=>ii,rotateY:()=>si,rotateZ:()=>pi,round:()=>Ur,scale:()=>Hr,scaleAndAdd:()=>$r,set:()=>Fr,sqrDist:()=>hi,sqrLen:()=>vi,squaredDistance:()=>hn,squaredLength:()=>vn,str:()=>li,sub:()=>ui,subtract:()=>un,transformMat3:()=>ni,transformMat4:()=>oi,transformQuat:()=>ri,zero:()=>ci});function we(){var o=new T(3);return T!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function Nr(o){var t=new T(3);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t}function mn(o){var t=o[0],e=o[1],n=o[2];return Math.hypot(t,e,n)}function be(o,t,e){var n=new T(3);return n[0]=o,n[1]=t,n[2]=e,n}function Br(o,t){return o[0]=t[0],o[1]=t[1],o[2]=t[2],o}function Fr(o,t,e,n){return o[0]=t,o[1]=e,o[2]=n,o}function zr(o,t,e){return o[0]=t[0]+e[0],o[1]=t[1]+e[1],o[2]=t[2]+e[2],o}function un(o,t,e){return o[0]=t[0]-e[0],o[1]=t[1]-e[1],o[2]=t[2]-e[2],o}function xn(o,t,e){return o[0]=t[0]*e[0],o[1]=t[1]*e[1],o[2]=t[2]*e[2],o}function fn(o,t,e){return o[0]=t[0]/e[0],o[1]=t[1]/e[1],o[2]=t[2]/e[2],o}function Gr(o,t){return o[0]=Math.ceil(t[0]),o[1]=Math.ceil(t[1]),o[2]=Math.ceil(t[2]),o}function Wr(o,t){return o[0]=Math.floor(t[0]),o[1]=Math.floor(t[1]),o[2]=Math.floor(t[2]),o}function qr(o,t,e){return o[0]=Math.min(t[0],e[0]),o[1]=Math.min(t[1],e[1]),o[2]=Math.min(t[2],e[2]),o}function Jr(o,t,e){return o[0]=Math.max(t[0],e[0]),o[1]=Math.max(t[1],e[1]),o[2]=Math.max(t[2],e[2]),o}function Ur(o,t){return o[0]=Math.round(t[0]),o[1]=Math.round(t[1]),o[2]=Math.round(t[2]),o}function Hr(o,t,e){return o[0]=t[0]*e,o[1]=t[1]*e,o[2]=t[2]*e,o}function $r(o,t,e,n){return o[0]=t[0]+e[0]*n,o[1]=t[1]+e[1]*n,o[2]=t[2]+e[2]*n,o}function _n(o,t){var e=t[0]-o[0],n=t[1]-o[1],r=t[2]-o[2];return Math.hypot(e,n,r)}function hn(o,t){var e=t[0]-o[0],n=t[1]-o[1],r=t[2]-o[2];return e*e+n*n+r*r}function vn(o){var t=o[0],e=o[1],n=o[2];return t*t+e*e+n*n}function Kr(o,t){return o[0]=-t[0],o[1]=-t[1],o[2]=-t[2],o}function Yr(o,t){return o[0]=1/t[0],o[1]=1/t[1],o[2]=1/t[2],o}function so(o,t){var e=t[0],n=t[1],r=t[2],i=e*e+n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),o[0]=t[0]*i,o[1]=t[1]*i,o[2]=t[2]*i,o}function ye(o,t){return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]}function zt(o,t,e){var n=t[0],r=t[1],i=t[2],s=e[0],p=e[1],a=e[2];return o[0]=r*a-i*p,o[1]=i*s-n*a,o[2]=n*p-r*s,o}function Zr(o,t,e,n){var r=t[0],i=t[1],s=t[2];return o[0]=r+n*(e[0]-r),o[1]=i+n*(e[1]-i),o[2]=s+n*(e[2]-s),o}function Qr(o,t,e,n,r,i){var s=i*i,p=s*(2*i-3)+1,a=s*(i-2)+i,l=s*(i-1),d=s*(3-2*i);return o[0]=t[0]*p+e[0]*a+n[0]*l+r[0]*d,o[1]=t[1]*p+e[1]*a+n[1]*l+r[1]*d,o[2]=t[2]*p+e[2]*a+n[2]*l+r[2]*d,o}function ti(o,t,e,n,r,i){var s=1-i,p=s*s,a=i*i,l=p*s,d=3*i*p,_=3*a*s,m=a*i;return o[0]=t[0]*l+e[0]*d+n[0]*_+r[0]*m,o[1]=t[1]*l+e[1]*d+n[1]*_+r[1]*m,o[2]=t[2]*l+e[2]*d+n[2]*_+r[2]*m,o}function ei(o,t){t=t||1;var e=tt()*2*Math.PI,n=tt()*2-1,r=Math.sqrt(1-n*n)*t;return o[0]=Math.cos(e)*r,o[1]=Math.sin(e)*r,o[2]=n*t,o}function oi(o,t,e){var n=t[0],r=t[1],i=t[2],s=e[3]*n+e[7]*r+e[11]*i+e[15];return s=s||1,o[0]=(e[0]*n+e[4]*r+e[8]*i+e[12])/s,o[1]=(e[1]*n+e[5]*r+e[9]*i+e[13])/s,o[2]=(e[2]*n+e[6]*r+e[10]*i+e[14])/s,o}function ni(o,t,e){var n=t[0],r=t[1],i=t[2];return o[0]=n*e[0]+r*e[3]+i*e[6],o[1]=n*e[1]+r*e[4]+i*e[7],o[2]=n*e[2]+r*e[5]+i*e[8],o}function ri(o,t,e){var n=e[0],r=e[1],i=e[2],s=e[3],p=t[0],a=t[1],l=t[2],d=r*l-i*a,_=i*p-n*l,m=n*a-r*p,h=r*m-i*_,w=i*d-n*m,C=n*_-r*d,I=s*2;return d*=I,_*=I,m*=I,h*=2,w*=2,C*=2,o[0]=p+d+h,o[1]=a+_+w,o[2]=l+m+C,o}function ii(o,t,e,n){var r=[],i=[];return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],i[0]=r[0],i[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),i[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),o[0]=i[0]+e[0],o[1]=i[1]+e[1],o[2]=i[2]+e[2],o}function si(o,t,e,n){var r=[],i=[];return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],i[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),i[1]=r[1],i[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),o[0]=i[0]+e[0],o[1]=i[1]+e[1],o[2]=i[2]+e[2],o}function pi(o,t,e,n){var r=[],i=[];return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],i[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),i[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),i[2]=r[2],o[0]=i[0]+e[0],o[1]=i[1]+e[1],o[2]=i[2]+e[2],o}function ai(o,t){var e=o[0],n=o[1],r=o[2],i=t[0],s=t[1],p=t[2],a=Math.sqrt(e*e+n*n+r*r),l=Math.sqrt(i*i+s*s+p*p),d=a*l,_=d&&ye(o,t)/d;return Math.acos(Math.min(Math.max(_,-1),1))}function ci(o){return o[0]=0,o[1]=0,o[2]=0,o}function li(o){return"vec3("+o[0]+", "+o[1]+", "+o[2]+")"}function di(o,t){return o[0]===t[0]&&o[1]===t[1]&&o[2]===t[2]}function mi(o,t){var e=o[0],n=o[1],r=o[2],i=t[0],s=t[1],p=t[2];return Math.abs(e-i)<=R*Math.max(1,Math.abs(e),Math.abs(i))&&Math.abs(n-s)<=R*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-p)<=R*Math.max(1,Math.abs(r),Math.abs(p))}var ui=un,xi=xn,fi=fn,_i=_n,hi=hn,po=mn,vi=vn,gi=function(){var o=we();return function(t,e,n,r,i,s){var p,a;for(e||(e=3),n||(n=0),r?a=Math.min(r*e+n,t.length):a=t.length,p=n;p<a;p+=e)o[0]=t[p],o[1]=t[p+1],o[2]=t[p+2],i(o,o,s),t[p]=o[0],t[p+1]=o[1],t[p+2]=o[2];return t}}();function Ai(){var o=new T(4);return T!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0,o[3]=0),o}function gn(o){var t=new T(4);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t}function An(o,t,e,n){var r=new T(4);return r[0]=o,r[1]=t,r[2]=e,r[3]=n,r}function Vn(o,t){return o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o}function wn(o,t,e,n,r){return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o}function bn(o,t,e){return o[0]=t[0]+e[0],o[1]=t[1]+e[1],o[2]=t[2]+e[2],o[3]=t[3]+e[3],o}function yn(o,t,e){return o[0]=t[0]*e,o[1]=t[1]*e,o[2]=t[2]*e,o[3]=t[3]*e,o}function Sn(o){var t=o[0],e=o[1],n=o[2],r=o[3];return Math.hypot(t,e,n,r)}function Mn(o){var t=o[0],e=o[1],n=o[2],r=o[3];return t*t+e*e+n*n+r*r}function kn(o,t){var e=t[0],n=t[1],r=t[2],i=t[3],s=e*e+n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),o[0]=e*s,o[1]=n*s,o[2]=r*s,o[3]=i*s,o}function Tn(o,t){return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]+o[3]*t[3]}function Cn(o,t,e,n){var r=t[0],i=t[1],s=t[2],p=t[3];return o[0]=r+n*(e[0]-r),o[1]=i+n*(e[1]-i),o[2]=s+n*(e[2]-s),o[3]=p+n*(e[3]-p),o}function En(o,t){return o[0]===t[0]&&o[1]===t[1]&&o[2]===t[2]&&o[3]===t[3]}function Pn(o,t){var e=o[0],n=o[1],r=o[2],i=o[3],s=t[0],p=t[1],a=t[2],l=t[3];return Math.abs(e-s)<=R*Math.max(1,Math.abs(e),Math.abs(s))&&Math.abs(n-p)<=R*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(r-a)<=R*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-l)<=R*Math.max(1,Math.abs(i),Math.abs(l))}var vl=function(){var o=Ai();return function(t,e,n,r,i,s){var p,a;for(e||(e=4),n||(n=0),r?a=Math.min(r*e+n,t.length):a=t.length,p=n;p<a;p+=e)o[0]=t[p],o[1]=t[p+1],o[2]=t[p+2],o[3]=t[p+3],i(o,o,s),t[p]=o[0],t[p+1]=o[1],t[p+2]=o[2],t[p+3]=o[3];return t}}();function ao(){var o=new T(4);return T!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function wi(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o}function Xn(o,t,e){e=e*.5;var n=Math.sin(e);return o[0]=n*t[0],o[1]=n*t[1],o[2]=n*t[2],o[3]=Math.cos(e),o}function bi(o,t){var e=Math.acos(t[3])*2,n=Math.sin(e/2);return n>R?(o[0]=t[0]/n,o[1]=t[1]/n,o[2]=t[2]/n):(o[0]=1,o[1]=0,o[2]=0),e}function yi(o,t){var e=Ln(o,t);return Math.acos(2*e*e-1)}function In(o,t,e){var n=t[0],r=t[1],i=t[2],s=t[3],p=e[0],a=e[1],l=e[2],d=e[3];return o[0]=n*d+s*p+r*l-i*a,o[1]=r*d+s*a+i*p-n*l,o[2]=i*d+s*l+n*a-r*p,o[3]=s*d-n*p-r*a-i*l,o}function Si(o,t,e){e*=.5;var n=t[0],r=t[1],i=t[2],s=t[3],p=Math.sin(e),a=Math.cos(e);return o[0]=n*a+s*p,o[1]=r*a+i*p,o[2]=i*a-r*p,o[3]=s*a-n*p,o}function Mi(o,t,e){e*=.5;var n=t[0],r=t[1],i=t[2],s=t[3],p=Math.sin(e),a=Math.cos(e);return o[0]=n*a-i*p,o[1]=r*a+s*p,o[2]=i*a+n*p,o[3]=s*a-r*p,o}function ki(o,t,e){e*=.5;var n=t[0],r=t[1],i=t[2],s=t[3],p=Math.sin(e),a=Math.cos(e);return o[0]=n*a+r*p,o[1]=r*a-n*p,o[2]=i*a+s*p,o[3]=s*a-i*p,o}function Ti(o,t){var e=t[0],n=t[1],r=t[2];return o[0]=e,o[1]=n,o[2]=r,o[3]=Math.sqrt(Math.abs(1-e*e-n*n-r*r)),o}function Dn(o,t){var e=t[0],n=t[1],r=t[2],i=t[3],s=Math.sqrt(e*e+n*n+r*r),p=Math.exp(i),a=s>0?p*Math.sin(s)/s:0;return o[0]=e*a,o[1]=n*a,o[2]=r*a,o[3]=p*Math.cos(s),o}function On(o,t){var e=t[0],n=t[1],r=t[2],i=t[3],s=Math.sqrt(e*e+n*n+r*r),p=s>0?Math.atan2(s,i)/s:0;return o[0]=e*p,o[1]=n*p,o[2]=r*p,o[3]=.5*Math.log(e*e+n*n+r*r+i*i),o}function Ci(o,t,e){return On(o,t),jn(o,o,e),Dn(o,o),o}function Se(o,t,e,n){var r=t[0],i=t[1],s=t[2],p=t[3],a=e[0],l=e[1],d=e[2],_=e[3],m,h,w,C,I;return h=r*a+i*l+s*d+p*_,h<0&&(h=-h,a=-a,l=-l,d=-d,_=-_),1-h>R?(m=Math.acos(h),w=Math.sin(m),C=Math.sin((1-n)*m)/w,I=Math.sin(n*m)/w):(C=1-n,I=n),o[0]=C*r+I*a,o[1]=C*i+I*l,o[2]=C*s+I*d,o[3]=C*p+I*_,o}function Ei(o){var t=tt(),e=tt(),n=tt(),r=Math.sqrt(1-t),i=Math.sqrt(t);return o[0]=r*Math.sin(2*Math.PI*e),o[1]=r*Math.cos(2*Math.PI*e),o[2]=i*Math.sin(2*Math.PI*n),o[3]=i*Math.cos(2*Math.PI*n),o}function Pi(o,t){var e=t[0],n=t[1],r=t[2],i=t[3],s=e*e+n*n+r*r+i*i,p=s?1/s:0;return o[0]=-e*p,o[1]=-n*p,o[2]=-r*p,o[3]=i*p,o}function Xi(o,t){return o[0]=-t[0],o[1]=-t[1],o[2]=-t[2],o[3]=t[3],o}function Rn(o,t){var e=t[0]+t[4]+t[8],n;if(e>0)n=Math.sqrt(e+1),o[3]=.5*n,n=.5/n,o[0]=(t[5]-t[7])*n,o[1]=(t[6]-t[2])*n,o[2]=(t[1]-t[3])*n;else{var r=0;t[4]>t[0]&&(r=1),t[8]>t[r*3+r]&&(r=2);var i=(r+1)%3,s=(r+2)%3;n=Math.sqrt(t[r*3+r]-t[i*3+i]-t[s*3+s]+1),o[r]=.5*n,n=.5/n,o[3]=(t[i*3+s]-t[s*3+i])*n,o[i]=(t[i*3+r]+t[r*3+i])*n,o[s]=(t[s*3+r]+t[r*3+s])*n}return o}function Ii(o,t,e,n){var r=.5*Math.PI/180;t*=r,e*=r,n*=r;var i=Math.sin(t),s=Math.cos(t),p=Math.sin(e),a=Math.cos(e),l=Math.sin(n),d=Math.cos(n);return o[0]=i*a*d-s*p*l,o[1]=s*p*d+i*a*l,o[2]=s*a*l-i*p*d,o[3]=s*a*d+i*p*l,o}function Di(o){return"quat("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")"}var Oi=gn,Ri=An,ji=Vn,Li=wn,Ni=bn,Bi=In,jn=yn,Ln=Tn,Fi=Cn,Nn=Sn,zi=Nn,Bn=Mn,Gi=Bn,co=kn,Wi=En,qi=Pn,Ji=function(){var o=we(),t=be(1,0,0),e=be(0,1,0);return function(n,r,i){var s=ye(r,i);return s<-.999999?(zt(o,t,r),po(o)<1e-6&&zt(o,e,r),so(o,o),Xn(n,o,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(zt(o,r,i),n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=1+s,co(n,n))}}(),Ui=function(){var o=ao(),t=ao();return function(e,n,r,i,s,p){return Se(o,n,s,p),Se(t,r,i,p),Se(e,o,t,2*p*(1-p)),e}}(),Hi=function(){var o=dn();return function(t,e,n,r){return o[0]=n[0],o[3]=n[1],o[6]=n[2],o[1]=r[0],o[4]=r[1],o[7]=r[2],o[2]=-e[0],o[5]=-e[1],o[8]=-e[2],co(t,Rn(t,o))}}();var Gt=class{constructor(){this.p=B.create(),this.q=xt.create(),Object.seal(this)}set(t,e,n,r,i,s,p){this.setPosition(t,e,n),this.setOrientation(r,i,s,p)}setPosition(t,e,n){B.set(this.p,t,e,n)}setOrientation(t,e,n,r){xt.set(this.q,t,e,n,r)}copy(t){B.copy(this.p,t.p),xt.copy(this.q,t.q)}};var Ml=B.create(),kl=B.create();var Nl=B.create();var lo=class extends J{constructor(t){let e=new Z(t,{type:"bandpass",frequency:2500,Q:4.5}),n=new $(t,{gain:10});e.connect(n),super("radio-effect",t,[e],[n])}};function Fn(o,t){let e=new lo(t);return e.name=`${o}-radio-effect`,e}function zn(o,t){let e=new Z(t,{type:"bandpass",frequency:400,Q:4.5});return e.name=`${o}-wall-effect`,e}var Gn=new Map([["Radio",Fn],["Wall",zn]]);var ft=class extends J{constructor(t,e,n,r,i){let s=new $(e);s.name="volume-control",i=i||[],super(t,e,[],[n],i),this.spatializer=n,this.effects=new Array,this.pose=new Gt,this.volumeControl=s,this.setEffects(...r)}onDisposing(){E(this.effects),super.onDisposing()}setEffects(...t){this.disable();for(let n of this.effects)this.remove(n),X(n);E(this.effects);let e=this.volumeControl;for(let n of t)if(c(n)){let r=Gn.get(n);if(c(r)){let i=r(n,this.context);this.add(i),this.effects.push(i),e=e.connect(i)}}this.enable()}get spatialized(){return this.spatializer.spatialized}get lastInternal(){return this.effects[this.effects.length-1]||this.volumeControl}enable(){this.lastInternal.isConnected()||this.lastInternal.connect(this.spatializer)}disable(){this.lastInternal.isConnected()&&this.lastInternal.disconnect()}tog(){this.lastInternal.isConnected()?this.disable():this.enable()}get volume(){return this.volumeControl.gain.value}set volume(t){this.volumeControl.gain.value=t}get minDistance(){return c(this.spatializer)?this.spatializer.minDistance:null}get maxDistance(){return c(this.spatializer)?this.spatializer.maxDistance:null}get algorithm(){return c(this.spatializer)?this.spatializer.algorithm:null}setPosition(t,e,n){c(this.spatializer)&&(this.pose.setPosition(t,e,n),this.spatializer.readPose(this.pose))}setOrientation(t,e,n,r){c(this.spatializer)&&(this.pose.setOrientation(t,e,n,r),this.spatializer.readPose(this.pose))}set(t,e,n,r,i,s,p){c(this.spatializer)&&(this.pose.set(t,e,n,r,i,s,p),this.spatializer.readPose(this.pose))}setAudioProperties(t,e,n){c(this.spatializer)&&this.spatializer.setAudioProperties(t,e,n)}};var K=class extends M{constructor(t,e){super(t),this.source=e}},Wt=class extends K{constructor(t){super("loaded",t)}};var qt=class extends K{constructor(t){super("played",t)}},Jt=class extends K{constructor(t){super("paused",t)}},Ut=class extends K{constructor(t){super("stopped",t)}},Ht=class extends K{constructor(t){super("progress",t),this.value=0,this.total=0}};var Gd=new M("disposing");var Mm=new M("useheadphonestoggled");var mo=new M("released");var Wn=st("descending",o=>o.resolution);var uo=class extends K{constructor(t,e){super(t,e)}},Me=class extends uo{constructor(t){super("loading",t)}};var j=class{constructor(t){if(this.items=new Map,this.defaultItems=new Array,c(t))for(let[e,n]of t)this.add(e,n)}add(t,...e){for(let n of e)if(u(t))this.defaultItems.push(n);else{let r=this.items.get(t);u(r)&&this.items.set(t,r=[]),r.push(n)}return this}entries(){return this.items.entries()}[Symbol.iterator](){return this.entries()}keys(){return this.items.keys()}*values(){for(let t of this.defaultItems)yield t;for(let t of this.items.values())for(let e of t)yield e}has(t){return c(t)?this.items.has(t):this.defaultItems.length>0}get(t){return u(t)?this.defaultItems:this.items.get(t)||[]}count(t){if(u(t))return this.defaultItems.length;let e=this.get(t);return c(e)?e.length:0}get size(){let t=this.defaultItems.length;for(let e of this.items.values())t+=e.length;return t}delete(t){return u(t)?E(this.defaultItems).length>0:this.items.delete(t)}remove(t,e){if(u(t))F(this.defaultItems,e);else{let n=this.items.get(t);c(n)&&(F(n,e),n.length===0&&this.items.delete(t))}}clear(){this.items.clear(),E(this.defaultItems)}};async function xo(o,t){let e=new Array(t.length),n=new Array(t.length);for(let s=0;s<t.length;++s){let p=t[s];e[s]=p[0],n[s]=p[1]}let r=Bt(o,e),i=new Array(t.length);for(let s=0;s<t.length;++s)i[s]=n[s](r[s]);return await Promise.all(i)}function qn(o,...t){let e=t.map(n=>[1,n]);return xo(o,e)}function Jn(o){return x(o.vcodec)}var ke=class o extends ft{get data(){return this._data}get loaded(){return this._loaded}get title(){return this.video.title}setTitle(t){this.video.title=t,this.audio.title=t}constructor(t,e,n){let r=o.createMediaElement(nn,nt(!0)),i=o.createMediaElement(dt,nt(!1)),s=new Q(e,{mediaElement:r});s.name=`${t}-video`;let p=new Q(e,{mediaElement:i});p.name=`${t}-audio`,super(t,e,n,[],[s,p]),this.onTimeUpdate=null,this.wasUsingAudioElement=!1,this.nextStartTime=null,this._data=null,this._loaded=!1,this.onError=new Map,this.sourcesByURL=new Map,this.sources=new j,this.potatoes=new j,s.connect(this.volumeControl),p.connect(this.volumeControl),this.video=r,this.audio=i,this.loadingEvt=new Me(this),this.loadEvt=new Wt(this),this.playEvt=new qt(this),this.pauseEvt=new Jt(this),this.stopEvt=new Ut(this),this.progEvt=new Ht(this),this.onSeeked=()=>{this.useAudioElement&&(this.audio.currentTime=this.video.currentTime)},this.onPlay=async()=>{this.onSeeked(),this.useAudioElement&&(await this.context.ready,await this.audio.play()),this.dispatchEvent(this.playEvt)},this.onPause=l=>{this.useAudioElement&&(this.onSeeked(),this.audio.pause()),this.video.currentTime===0||l.type==="ended"?this.dispatchEvent(this.stopEvt):this.dispatchEvent(this.pauseEvt)};let a=!1;this.onWaiting=()=>{this.useAudioElement&&(a=!0,this.audio.pause())},this.onCanPlay=async()=>{this.useAudioElement&&a&&(await this.context.ready,await this.audio.play(),a=!1)},this.wasUsingAudioElement=!1,this.onTimeUpdate=async()=>{if(this.video.getVideoPlaybackQuality().totalVideoFrames===0){let d=this.onError.get(this.video);c(d)&&await d()}else if(this.useAudioElement){this.wasUsingAudioElement=!1;let d=this.video.currentTime-this.audio.currentTime;Math.abs(d)>.25&&(this.audio.currentTime=this.video.currentTime)}else this.wasUsingAudioElement||(this.wasUsingAudioElement=!0,this.audio.pause());this.progEvt.value=this.video.currentTime,this.progEvt.total=this.video.duration,this.dispatchEvent(this.progEvt)},this.video.addEventListener("seeked",this.onSeeked),this.video.addEventListener("play",this.onPlay),this.video.addEventListener("pause",this.onPause),this.video.addEventListener("ended",this.onPause),this.video.addEventListener("waiting",this.onWaiting),this.video.addEventListener("canplay",this.onCanPlay),this.video.addEventListener("timeupdate",this.onTimeUpdate),Object.assign(window,{videoPlayer:this})}elementHasAudio(t){let e=this.sourcesByURL.get(t.src);return c(e)&&e.acodec!=="none"||c(t.audioTracks)&&t.audioTracks.length>0||c(t.webkitAudioDecodedByteCount)&&t.webkitAudioDecodedByteCount>0||c(t.mozHasAudio)&&t.mozHasAudio}get useAudioElement(){return!this.elementHasAudio(this.video)&&this.elementHasAudio(this.audio)}onDisposing(){this.clear(),this.video.removeEventListener("seeked",this.onSeeked),this.video.removeEventListener("play",this.onPlay),this.video.removeEventListener("pause",this.onPause),this.video.removeEventListener("ended",this.onPause),this.video.removeEventListener("waiting",this.onWaiting),this.video.removeEventListener("canplay",this.onCanPlay),this.video.removeEventListener("timeupdate",this.onTimeUpdate),super.onDisposing(),this.audio.dispatchEvent(mo),this.video.dispatchEvent(mo)}clear(){this.stop();for(let[t,e]of this.onError)t.removeEventListener("error",e);this.onError.clear(),this.sourcesByURL.clear(),this.sources.clear(),this.potatoes.clear(),this.video.src="",this.audio.src="",this.wasUsingAudioElement=!1,this._data=null,this._loaded=!1}async load(t,e){if(this.clear(),this._data=t,x(t)?(this.setTitle(t),this.potatoes.add(this.video,t)):(this.setTitle(t.title),this.fillSources(this.video,t.videos),this.fillSources(this.audio,t.audios)),!this.hasSources(this.video))throw new Error("No video sources found");if(this.dispatchEvent(this.loadingEvt),await qn(e,n=>this.loadMediaElement(this.audio,n),n=>this.loadMediaElement(this.video,n)),x(t)?this.nextStartTime=null:this.nextStartTime=t.startTime,!this.hasSources(this.video))throw new Error("No video playable sources");return this._loaded=!0,this.dispatchEvent(this.loadEvt),this}fillSources(t,e){e.sort(Wn);for(let n of e)Wo.matches(n.contentType)||(this.sources.add(t,n),this.sourcesByURL.set(n.url,n))}static createMediaElement(t,...e){return t(Mt(!1),kt(!1),...e)}async getMediaCapabilities(t){let e={type:"file"};Jn(t)?e.video={contentType:t.contentType,bitrate:t.vbr*1024,framerate:t.fps,width:t.width,height:t.height}:t.acodec!=="none"&&(e.audio={contentType:t.contentType,bitrate:t.abr*1024,samplerate:t.asr});try{return await navigator.mediaCapabilities.decodingInfo(e)}catch{return{supported:!0,powerEfficient:!1,smooth:!1,configuration:e}}}hasSources(t){return this.sources.get(t).length>0||this.potatoes.count(t)>0}async loadMediaElement(t,e){for(c(e)&&e.start(),this.onError.has(t)&&(t.removeEventListener("error",this.onError.get(t)),this.onError.delete(t));this.hasSources(t);){let n=null,r=this.sources.get(t).shift();if(c(r)){let i=await this.getMediaCapabilities(r);if(!i.smooth||!i.powerEfficient){this.potatoes.add(t,r.url);continue}else n=r.url}else n=this.potatoes.get(t).shift();if(t.src=n,t.load(),await $o(t)){c(r)?this.sources.get(t).unshift(r):this.potatoes.get(t).unshift(n);let i=()=>this.loadMediaElement(t,e);t.addEventListener("error",i),this.onError.set(t,i),this.wasUsingAudioElement=this.wasUsingAudioElement,c(e)&&e.end();return}}}get width(){return this.video.videoWidth}get height(){return this.video.videoHeight}get playbackState(){return u(this.data)?"empty":this.loaded?this.video.error?"errored":this.video.ended||this.video.paused&&this.video.currentTime===0?"stopped":this.video.paused?"paused":"playing":"loading"}async play(){await this.context.ready,c(this.nextStartTime)&&this.nextStartTime>0&&(this.video.pause(),this.video.currentTime=this.nextStartTime,this.nextStartTime=null),await this.video.play()}async playThrough(){let t=k(this,"stopped");await this.play(),await t}pause(){this.video.pause()}stop(){this.pause(),this.video.currentTime=0}restart(){return this.stop(),this.play()}};var Un="wait",Zi="pointer",Qi="not-allowed",Te=class extends ke{constructor(t,e){super("video-player",t,e),this.element=Qo(Et("inline-block"),this.thumbnail=It(le(Un)),this.video,this.audio),this.thumbnail.addEventListener("click",()=>{this.loaded&&this.play()}),this.addEventListener("played",()=>this.showVideo(!0)),this.addEventListener("stopped",()=>this.showVideo(!1)),this.showVideo(!1)}onDisposing(){super.onDisposing(),c(this.element.parentElement)&&this.element.remove()}showVideo(t){Qe(this.video,t,"inline-block"),Qe(this.thumbnail,!t,"inline-block")}async load(t,e){try{G(this.thumbnail,de(.5),le(Un));let n=Bt(e,[1,10]);return await he(super.load(t,n.shift()),this.loadThumbnail(t,n.shift())),this}finally{G(this.thumbnail,de(1),le(this.loaded?Zi:Qi))}}clear(){super.clear(),this.thumbnail.src=""}setTitle(t){super.setTitle(t),this.thumbnail.title=t}async loadThumbnail(t,e){if(e.start(),c(t)){G(this.thumbnail,ae(t.thumbnail.url),de(.5));let n=k(this.thumbnail,"load","error");await z(n)}e.end()}};function fo(o){return o.hostname==="www.youtube.com"||o.hostname==="youtube.com"||o.hostname==="youtu.be"}var ts=new Map([["vp9","vp09.00.10.08"]]);function es(o){return u(o.vcodec)||o.vcodec==="none"?"audio":"video"}function Hn(o,t){let e=[o];if(c(t)&&t.length>0&&t!=="none"&&(t=ts.get(t)||t),c(t)&&t.length>0&&t!=="none"){let n=encodeURI(t)!==t?"*":"";e.push(`codecs${n}="${t}"`)}return e.join(";")}var Ce=class{constructor(t,e){this.fetcher=t,this.makeProxyURL=e}makeVideoRecord(t){let{content_type:e,acodec:n,vcodec:r}=t;return{contentType:Hn(e,r),url:this.makeProxyURL(t.url).href,acodec:n,abr:t.abr*1024,asr:t.asr,vcodec:r,vbr:t.vbr*1024,fps:t.fps,width:t.width,height:t.height,resolution:t.width*t.height}}makeAudioRecord(t){let{content_type:e,acodec:n}=t;return{contentType:Hn(e,n),url:this.makeProxyURL(t.url).href,acodec:n,abr:t.abr*1024,asr:t.asr,resolution:t.abr}}makeImageRecord(t){let{content_type:e,url:n,width:r,height:i}=t;return{contentType:e,url:this.makeProxyURL(n).href,width:r,height:i,resolution:r*i}}async loadData(t,e){if(u(t))throw new Error("must provide a YouTube URL or a YTMetadata object");c(e)&&e.start();let n=null;x(t)?n=await this.fetcher.get(t).progress(e).object().then(Ft):(c(e)&&e.end(t.title),n=t);let r=0;if(c(n.original_url)){let m=new URL(n.original_url);fo(m)&&m.searchParams.has("t")&&(r=parseFloat(m.searchParams.get("t")))}let i=new j((await Promise.all(n.formats)).map(m=>[es(m),m])),s=n.title,p=n.thumbnails||[],a=n.thumbnail&&this.makeImageRecord(wt(p,m=>m.url===n.thumbnail)),l=i.get("video").map(m=>this.makeVideoRecord(m)),d=i.get("audio").map(m=>this.makeAudioRecord(m));return{title:s,thumbnail:a,videos:l,audios:d,startTime:r}}};function Kn(o){return c(o)&&g(o.then)&&g(o.catch)&&g(o.finally)&&g(o.fetch)&&g(o.getSize)}var $n=class{get result(){if(c(this.error))throw this.error;return this._result}get error(){return this._error}get started(){return this._started}get finished(){return this._finished}constructor(t,e){this.path=t,this.type=e,this._result=null,this._error=null,this._started=!1,this._finished=!1,this.resolve=null,this.reject=null,this.promise=new Promise((n,r)=>{this.resolve=i=>{this._result=i,this._finished=!0,n(i)},this.reject=i=>{this._error=i,this._finished=!0,r(i)}})}async getSize(t){try{let{contentLength:e}=await t.head(this.path).accept(this.type).exec();return[this,e||1]}catch(e){return console.warn(e),[this,1]}}async fetch(t,e){try{let n=await this.getResult(t,e);this.resolve(n)}catch(n){this.reject(n)}}get[Symbol.toStringTag](){return this.promise.toString()}then(t,e){return this.promise.then(t,e)}catch(t){return this.promise.catch(t)}finally(t){return this.promise.finally(t)}};var Su="HTMLCanvasElement"in globalThis,Mu="HTMLImageElement"in globalThis,_o=!1,_t=!_o&&"OffscreenCanvas"in globalThis,ku=!_o&&"createImageBitmap"in globalThis;function os(){try{return new OffscreenCanvas(1,1).getContext("2d")!=null}catch{return!1}}var Tu=_t&&os();function ns(){try{return new OffscreenCanvas(1,1).getContext("webgl2")!=null}catch{return!1}}var Cu=_t&&ns();function Yn(o,t){return new OffscreenCanvas(o,t)}function Zn(o,t){return Zo(Bo(o),jo(t))}function ho(o,t){let e=o.getContext("2d");if(u(e))throw new Error("Could not create 2d context for canvas");e.drawImage(t,0,0)}function Qn(o){let t=new b,e=setInterval(()=>{o()&&(clearInterval(e),t.resolve())},100);return t}async function V(o,t){let{status:e,requestPath:n,responsePath:r,content:i,contentType:s,contentLength:p,fileName:a,headers:l,date:d}=o;return{status:e,requestPath:n,responsePath:r,content:c(t)?await t(i):void 0,contentType:s,contentLength:p,fileName:a,headers:l,date:d}}var vo=null;function tr(o){return vo===null&&(vo=new Audio),vo.canPlayType(o)!==""}var Ee=class{constructor(t,e,n,r=!1){this.fetcher=t,this.method=e,this.path=n,this.useBLOBs=r,this.prog=null,this.request={method:e,path:this.path.href,body:null,headers:null,timeout:null,withCredentials:!1,useCache:!1,retryCount:3}}retries(t){return this.request.retryCount=t,this}query(t,e){return this.path.searchParams.set(t,e),this.request.path=this.path.href,this}header(t,e){return this.request.headers===null&&(this.request.headers=new Map),this.request.headers.set(t.toLowerCase(),e),this}headers(t){for(let[e,n]of t.entries())this.header(e,n);return this}timeout(t){return this.request.timeout=t,this}progress(t){return this.prog=t,this}body(t,e){if(c(t)){let n=new Set,r=new Array;r.push(t);let i=!1;for(;!i&&r.length>0;){let s=r.shift();if(s&&!n.has(s))if(n.add(s),s instanceof Blob){i=!0;break}else x(s)||r.push(...Object.values(s))}if(i){let s=new FormData,p=new Map,a=new Set;for(let[l,d]of Object.entries(t))if(d instanceof Blob){let _=l+".name",m=t[_];x(m)&&(p.set(d,m),a.add(_))}for(let[l,d]of Object.entries(t))a.has(l)||(d instanceof Blob?s.append(l,d,p.get(d)):x(d)?s.append(l,d):c(d)&&g(d.toString)?s.append(l,d.toString()):console.warn("Can't serialize value to formdata",l,d));t=s,e=void 0}this.request.body=t,this.content(e)}return this}withCredentials(){return this.request.withCredentials=!0,this}useCache(t=!0){return this.request.useCache=t,this}media(t,e){c(e)&&(x(e)||(e=e.value),this.header(t,e))}content(t){this.media("content-type",t)}accept(t){return this.media("accept",t),this}blob(t){if(this.accept(t),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetBlob(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetBlob(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}buffer(t){if(this.accept(t),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetBuffer(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetBuffer(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}async file(t){if(this.accept(t),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return await this.fetcher.sendObjectGetFile(this.request,this.prog);if(this.method==="GET"){if(this.useBLOBs)return await this.fetcher.sendNothingGetFile(this.request,this.prog);{let e=await this.fetcher.sendNothingGetNothing(this.request);return V(e,()=>this.request.path)}}else{if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}}text(t){if(this.accept(t||me),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetText(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetText(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}object(t){if(this.accept(t||Ke),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetObject(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetObject(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}xml(t){if(this.accept(t||Go),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetXml(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetXml(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}imageBitmap(t){if(this.accept(t),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetImageBitmap(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetImageBitmap(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}exec(){if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetNothing(this.request,this.prog);if(this.method==="GET")throw new Error("GET requests should expect a response type");if(this.method==="HEAD"||this.method==="OPTIONS")return this.fetcher.sendNothingGetNothing(this.request);S(this.method)}async audioBlob(t){if(c(t)&&(x(t)||(t=t.value),!tr(t)))throw new Error(`Probably can't play file of type "${t}" at path: ${this.request.path}`);let e=await this.blob(t);if(tr(e.contentType))return e;throw new Error(`Cannot play file of type "${e.contentType}" at path: ${this.request.path}`)}async audioBuffer(t,e){return V(await this.audioBlob(e),async n=>await t.decodeAudioData(await n.arrayBuffer()))}async htmlElement(t,e,n){let r=await this.file(n),i=k(t,e,"error");return t instanceof HTMLLinkElement?t.href=r.content:t.src=r.content,await i,await V(r,()=>t)}image(t){return this.htmlElement(It(),"load",t)}async htmlCanvas(t){let e=Zn(1,1);if(this.method==="GET")if(_t){this.accept(t);let n=await this.fetcher.drawImageToCanvas(this.request,e.transferControlToOffscreen(),this.prog);return await V(n,()=>e)}else{let n=await this.image(t);return await V(n,r=>(e.width=r.width,e.height=r.height,ho(e,r),X(r),e))}else{if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE"||this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}}canvas(t){return _t?this.offscreenCanvas(t):this.htmlCanvas(t)}async offscreenCanvas(t){if(!_t)throw new Error("This system does not support OffscreenCanvas");if(this.method==="GET"){let e=await this.image(t);return await V(e,n=>{let r=Yn(n.width,n.height);return ho(r,n),X(n),r})}else{if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE"||this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}}async style(){let t=tn(Tt(Xt),We("stylesheet"));document.head.append(t);let e=await this.htmlElement(t,"load",Xt);return V(e)}async getScript(){let t=en(Tt(lt));document.head.append(t);let e=await this.htmlElement(t,"load",lt);return V(e)}async script(t){let e=null,n=this.request.path;if(!t)e=await this.getScript();else if(!t()){let r=Qn(t);e=await this.getScript(),await r}return this.prog&&this.prog.end(n),e}async module(){let t=this.request.path,e=await this.file(lt),n=await import(e.content);return this.prog&&this.prog.end(t),V(e,()=>n)}async wasm(t){let e=await this.buffer(Ye);if(!Ye.matches(e.contentType))throw new Error(`Server did not respond with WASM file. Was: ${e.contentType}`);let n=await WebAssembly.compile(e.content),r=await WebAssembly.instantiate(n,t);return V(e,()=>r.exports)}async worker(t="module"){let e=this.request.path,n=await this.file(lt);this.prog=null,this.request.timeout=null;let r=new Worker(n.content,{type:t});return this.prog&&this.prog.end(e),V(n,()=>r)}};var Pe=class{constructor(t,e=!1){this.service=t,this.useBLOBs=e;{let n=Ho("input[name=__RequestVerificationToken]");n&&this.service.setRequestVerificationToken(n.value)}}clearCache(){return this.service.clearCache()}evict(t,e){return this.service.evict(new URL(t,e||location.href).href)}request(t,e,n){return new Ee(this.service,t,new URL(e,n||location.href),this.useBLOBs)}head(t,e){return this.request("HEAD",t,e)}options(t,e){return this.request("OPTIONS",t,e)}get(t,e){return this.request("GET",t,e)}post(t,e){return this.request("POST",t,e)}put(t,e){return this.request("PUT",t,e)}patch(t,e){return this.request("PATCH",t,e)}delete(t,e){return this.request("DELETE",t,e)}async assets(t,e,...n){u(n)&&(n=[]),n.unshift(e);let r;Kn(t)?n.unshift(t):c(t)&&(r=t),n=n.filter(c);let i=await Promise.all(n.map(p=>p.getSize(this))),s=new Map(i);await xo(r,n.map(p=>[s.get(p),a=>p.fetch(this,a)]))}};var Xe=class{constructor(t){this.impl=t,this.defaultPostHeaders=new Map}setRequestVerificationToken(t){this.defaultPostHeaders.set("RequestVerificationToken",t)}clearCache(){return this.impl.clearCache()}evict(t){return this.impl.evict(t)}sendNothingGetNothing(t){return this.impl.sendNothingGetNothing(t)}sendNothingGetBlob(t,e){return this.impl.sendNothingGetSomething("blob",t,e)}sendObjectGetBlob(t,e){return this.impl.sendSomethingGetSomething("blob",t,this.defaultPostHeaders,e)}sendNothingGetBuffer(t,e){return this.impl.sendNothingGetSomething("arraybuffer",t,e)}sendObjectGetBuffer(t,e){return this.impl.sendSomethingGetSomething("arraybuffer",t,this.defaultPostHeaders,e)}sendNothingGetText(t,e){return this.impl.sendNothingGetSomething("text",t,e)}sendObjectGetText(t,e){return this.impl.sendSomethingGetSomething("text",t,this.defaultPostHeaders,e)}sendNothingGetObject(t,e){return this.impl.sendNothingGetSomething("json",t,e)}sendObjectGetObject(t,e){return this.impl.sendSomethingGetSomething("json",t,this.defaultPostHeaders,e)}sendObjectGetNothing(t,e){return this.impl.sendSomethingGetSomething("",t,this.defaultPostHeaders,e)}drawImageToCanvas(t,e,n){return this.impl.drawImageToCanvas(t,e,n)}async sendNothingGetFile(t,e){return V(await this.sendNothingGetBlob(t,e),URL.createObjectURL)}async sendObjectGetFile(t,e){return V(await this.sendObjectGetBlob(t,e),URL.createObjectURL)}async sendNothingGetXml(t,e){return V(await this.impl.sendNothingGetSomething("document",t,e),n=>n.documentElement)}async sendObjectGetXml(t,e){return V(await this.impl.sendSomethingGetSomething("document",t,this.defaultPostHeaders,e),n=>n.documentElement)}async sendNothingGetImageBitmap(t,e){return V(await this.sendNothingGetBlob(t,e),createImageBitmap)}async sendObjectGetImageBitmap(t,e){return V(await this.sendObjectGetBlob(t,e),createImageBitmap)}};function er(o,t,e){return new Map(o.map(n=>[t(n),e(n)]))}function or(o,t){return er(o,t,ct)}var rt=class{constructor(t){if(this.items=new Map,c(t))for(let[e,n,r]of t)this.add(e,n,r)}add(t,e,n){let r=this.items.get(t);return u(r)&&this.items.set(t,r=new Map),r.set(e,n),this}*entries(){for(let[t,e]of this.items)for(let[n,r]of e)yield[t,n,r]}keys(t){return u(t)?this.items.keys():this.items.get(t).keys()}*values(){for(let t of this.items.values())for(let e of t.values())yield e}has(t,e){return this.items.has(t)&&(u(e)||this.items.get(t).has(e))}get(t,e){return u(e)?this.items.get(t):this.items.has(t)?this.items.get(t).get(e):null}count(t){return this.items.has(t)?this.items.get(t).size:null}get size(){let t=0;for(let e of this.items.values())t+=e.size;return t}delete(t,e){if(u(e))return this.items.delete(t);if(this.items.has(t)){let n=this.items.get(t),r=n.delete(e);return n.size===0&&this.items.delete(t),r}else return!1}clear(){this.items.clear()}};var Ie=class o{static delete(t){let e=indexedDB.deleteDatabase(t),n=k(e,"success","error","blocked");return z(n)}static async open(t,...e){let n=or(e,y=>y.name),r=new rt(e.filter(y=>c(y.indexes)).flatMap(y=>y.indexes.map(L=>[y.name,L.name,L]))),i=new Array,s=new Array,p=new Array,a=new j,l=new j,d=null,_=indexedDB.open(t);if(await z(k(_,"success","error","blocked"))){let y=_.result;d=y.version;let L=new Array;for(let D of y.objectStoreNames)n.has(D)||s.push(D);for(let D of n.keys())y.objectStoreNames.contains(D)?L.push(D):i.push(D);if(L.length>0){let D=y.transaction(L),O=k(D,"complete","error","abort"),Y=z(O);for(let A of L){let et=D.objectStore(A),So=n.get(A);c(So.options)&&et.keyPath!==So.options.keyPath&&(s.push(A),i.push(A));for(let U of et.indexNames)r.has(A,U)||(p.indexOf(A)===-1&&p.push(A),l.add(A,U));if(r.has(A))for(let U of r.get(A).keys())if(!et.indexNames.contains(U))p.indexOf(A)===-1&&p.push(A),a.add(A,U);else{let ht=r.get(A,U),vt=et.index(U);(x(ht.keyPath)!==x(vt.keyPath)||x(ht.keyPath)&&x(vt.keyPath)&&ht.keyPath!==vt.keyPath||it(ht.keyPath)&&it(vt.keyPath)&&Po(ht.keyPath,vt.keyPath))&&(p.indexOf(A)===-1&&p.push(A),l.add(A,U),a.add(A,U))}}D.commit(),await Y}X(y)}else{d=0,i.push(...n.keys());for(let y of e)if(c(y.indexes))for(let L of y.indexes)a.add(y.name,L.name)}(i.length>0||s.length>0||a.size>0||l.size>0)&&++d;let m=new b,h=c(d)?indexedDB.open(t,d):indexedDB.open(t),w=k(h,"success","error","blocked"),C=z(m),I=z(w),yo=m.resolver(!1);if(h.addEventListener("success",yo),h.addEventListener("upgradeneeded",()=>{let y=k(h.transaction,"complete","error","abort"),L=h.result;for(let O of s)L.deleteObjectStore(O);let D=new Map;for(let O of i){let Y=n.get(O),A=L.createObjectStore(O,Y.options);D.set(O,A)}for(let O of p){let Y=h.transaction.objectStore(O);D.set(O,Y)}for(let[O,Y]of D){for(let A of l.get(O))Y.deleteIndex(A);for(let A of a.get(O)){let et=r.get(O,A);Y.createIndex(A,et.keyPath,et.options)}}z(y).then(m.resolve).catch(m.reject).finally(()=>h.removeEventListener("success",yo))}),!await C)throw m.error;if(!await I)throw w.error;return new o(h.result)}constructor(t){this.db=t}dispose(){X(this.db)}get name(){return this.db.name}get version(){return this.db.version}get storeNames(){return Array.from(this.db.objectStoreNames)}getStore(t){return new go(this.db,t)}},go=class{constructor(t,e){this.db=t,this.storeName=e}async request(t,e){let n=this.db.transaction(this.storeName,e),r=k(n,"complete","error"),i=n.objectStore(this.storeName),s=t(i),p=k(s,"success","error");if(!await z(p))throw n.abort(),p.error;if(n.commit(),!await z(r))throw r.error;return s.result}add(t,e){return this.request(n=>n.add(t,e),"readwrite")}clear(){return this.request(t=>t.clear(),"readwrite")}getCount(t){return this.request(e=>e.count(t),"readonly")}async has(t){return await this.getCount(t)>0}delete(t){return this.request(e=>e.delete(t),"readwrite")}get(t){return this.request(e=>e.get(t),"readonly")}getAll(){return this.request(t=>t.getAll(),"readonly")}getAllKeys(){return this.request(t=>t.getAllKeys(),"readonly")}getKey(t){return this.request(e=>e.getKey(t),"readonly")}openCursor(t,e){return this.request(n=>n.openCursor(t,e),"readonly")}openKeyCursor(t,e){return this.request(n=>n.openKeyCursor(t,e),"readonly")}put(t,e){return this.request(n=>n.put(t,e),"readwrite")}};function nr(o,...t){for(let e of t)if(c(e))for(let[n,r]of e)o.set(n,r);return o}var Ao=class extends b{constructor(t){super(!1),this.milliseconds=t,this._timer=null}start(){super.start(),this._timer=setTimeout(()=>{this._timer=null,this.resolve()},this.milliseconds)}reset(){super.reset(),c(this._timer)&&(clearTimeout(this._timer),this._timer=null)}};function rr(o){let t=new Ao(o);return t.start(),t}function De(o,t){return async()=>{let e=null,n=500;for(let r=0;r<=o;++r)try{return r>0&&(await rr(n),n*=2),await t()}catch(i){e=i}throw e}}function rs(o){return x(o)||To(o)||o instanceof Blob||o instanceof FormData||Co(o)||"Document"in globalThis&&o instanceof Document}function Oe(o,t,e,n,r,i){let s=!i;i&&i.then(()=>s=!0);let p=!1,a=r,l=new b;e.addEventListener("loadstart",()=>{s&&!p&&n&&n.start(o)}),e.addEventListener("progress",_=>{if(s&&!p){let m=_;n&&n.report(m.loaded,Math.max(m.loaded,m.total),o),m.loaded===m.total&&(a=!0,p&&l.resolve())}}),e.addEventListener("load",()=>{s&&!p&&(n&&n.end(o),p=!0,a&&l.resolve())});let d=_=>()=>{s&&l.reject(`${_} (${t.status})`)};return e.addEventListener("error",d("error")),e.addEventListener("abort",d("abort")),e.addEventListener("timeout",d("timeout")),l}function Vo(o,t,e,n,r,i){if(o.open(t,e),o.responseType="blob",o.timeout=n,r)for(let[s,p]of r)o.setRequestHeader(s,p);c(i)?o.send(i):o.send()}function Re(o,t,e){if(!o.has(t))return null;let n=o.get(t);try{let r=e(n);return o.delete(t),r}catch(r){console.warn(t,r)}return null}var is=/filename=\"(.+)\"(;|$)/,ss="Juniper:Fetcher:Cache",je=class{constructor(){this.cache=null,this.store=null,this.tasks=new rt,this.cacheReady=this.openCache()}async drawImageToCanvas(t,e,n){let r=await this.sendNothingGetSomething("blob",t,n),i=r.content;return pn(await createImageBitmap(i,{imageOrientation:"from-image"}),s=>(e.width=s.width,e.height=s.height,e.getContext("2d").drawImage(s,0,0),V(r)))}async openCache(){let t={keyPath:"requestPath"};this.cache=await Ie.open(ss,{name:"files",options:t}),this.store=await this.cache.getStore("files")}async clearCache(){await this.cacheReady,await this.store.clear()}async evict(t){await this.cacheReady,this.store.has(t)&&await this.store.delete(t)}async readResponseHeaders(t,e){let n=e.getAllResponseHeaders().split(/[\r\n]+/).map(m=>m.trim()).filter(m=>m.length>0).map(m=>{let h=m.split(": "),w=h.shift().toLowerCase(),C=h.join(": ");return[w,C]}),r=new j(n),i=Array.from(r.keys()).map(m=>[m,r.get(m).join(", ")]),s=new Map(i),p=Re(s,"content-type",ct),a=Re(s,"content-length",parseFloat),l=Re(s,"date",m=>new Date(m)),d=Re(s,"content-disposition",m=>{if(c(m)){let h=m.match(is);if(c(h))return h[1]}return null});return{status:e.status,requestPath:t,responsePath:e.responseURL,content:void 0,contentType:p,contentLength:a,fileName:d,date:l,headers:s}}async readResponse(t,e){let{responsePath:n,status:r,contentType:i,contentLength:s,fileName:p,date:a,headers:l}=await this.readResponseHeaders(t,e),d={requestPath:t,responsePath:n,status:r,contentType:i,contentLength:s,fileName:p,date:a,headers:l,content:e.response};return c(d.content)&&(d.contentType=d.contentType||d.content.type,d.contentLength=d.contentLength||d.content.size),d}async decodeContent(t,e){return V(e,async n=>{if(t==="")return null;if(u(e.contentType)){let r=Array.from(e.headers.entries()).map(i=>i.join(": ")).join(`
  `);throw new Error(`No content type found in headers: 
  `+r)}else{if(t==="blob")return n;if(t==="arraybuffer")return await n.arrayBuffer();if(t==="json"){let r=await n.text();return r.length>0?JSON.parse(r):null}else if(t==="document"){let r=new DOMParser;if(e.contentType==="application/xhtml+xml"||e.contentType==="text/html"||e.contentType==="application/xml"||e.contentType==="image/svg+xml"||e.contentType==="text/xml")return r.parseFromString(await n.text(),e.contentType);throw new Error("Couldn't parse document")}else{if(t==="text")return await n.text();S(t)}}})}async withCachedTask(t,e){return t.method!=="GET"&&t.method!=="HEAD"&&t.method!=="OPTIONS"?await e():(this.tasks.has(t.method,t.path)||this.tasks.add(t.method,t.path,e().finally(()=>this.tasks.delete(t.method,t.path))),this.tasks.get(t.method,t.path))}sendNothingGetNothing(t){return this.withCachedTask(t,De(t.retryCount,async()=>{let e=new XMLHttpRequest,n=Oe(`requesting: ${t.path}`,e,e,null,!0);return Vo(e,t.method,t.path,t.timeout,t.headers),await n,await this.readResponseHeaders(t.path,e)}))}sendNothingGetSomething(t,e,n){return this.withCachedTask(e,De(e.retryCount,async()=>{let r=null,i=e.useCache&&e.method==="GET";i&&(c(n)&&n.start(),await this.cacheReady,r=await this.store.get(e.path));let s=u(r);if(s){let a=new XMLHttpRequest,l=Oe(`requesting: ${e.path}`,a,a,n,!0);Vo(a,e.method,e.path,e.timeout,e.headers),await l,r=await this.readResponse(e.path,a),i&&await this.store.add(r)}let p=await this.decodeContent(t,r);return s&&c(n)&&n.end(),p}))}sendSomethingGetSomething(t,e,n,r){let i=null,s=nr(new Map,n,e.headers),p=null;if(c(s)){let h=new Array;for(let w of s.keys())w.toLowerCase()==="content-type"&&h.push(w);if(h.length>0){e.body instanceof FormData||(p=s.get(h[0]),h.shift());for(let w of h)s.delete(w)}}rs(e.body)&&!x(e.body)||x(e.body)&&me.matches(p)?i=e.body:c(e.body)&&(i=JSON.stringify(e.body));let a=c(i),l=cn(r,a?2:1),[d,_]=l,m=async()=>{let h=new XMLHttpRequest,w=a?Oe("uploading",h,h.upload,d,!1):Promise.resolve(),C=Oe("saving",h,h,_,!0,w);Vo(h,e.method,e.path,e.timeout,s,i),await w,await C;let I=await this.readResponse(e.path,h);return await this.decodeContent(t,I)};return De(e.retryCount,m)()}};var ir=new URL(globalThis.location.href),Le=ir.searchParams.has("DEBUG")&&!ir.searchParams.has("RELEASE");function sr(o,t){let e=globalThis,n=e[o];if(u(n)){if(u(t))throw new Error(`No value ${o} found`);n=t(),e[o]=n}return n}var Af=sr("juniper::loadedFonts",()=>[]);var pr="3.7.24";var Bf=Le?Ge(10):pr;var as=50,cs=12,Ff=as*cs;var ar={fontFamily:"Lato",fontSize:20};var zf=ce(30,67,136),Gf=ce(78,77,77),cr={fontFamily:ar.fontFamily,fontSize:ar.fontSize,textFillColor:"white"},Wf=Object.assign({},cr,{bgFillColor:ce(0,120,215),bgStrokeColor:"black",bgStrokeSize:.02,padding:{top:.025,left:.05,bottom:.025,right:.05},minHeight:.2,maxHeight:.2,scale:300}),qf=Object.assign({},cr,{textStrokeColor:"black",textStrokeSize:.01,minHeight:.25,maxHeight:.25});function lr(o=!0){let t=new Xe(new je);return new Pe(t,!Le)}function wo(o){return c(o)&&o.length>0?parseFloat(o):null}var Ne=class{constructor(t,e){this._url=null,this._base=void 0,this._protocol=null,this._host=null,this._hostName=null,this._userName=null,this._password=null,this._port=null,this._pathName=null,this._hash=null,this._query=new Map,t!==void 0&&(this._url=new URL(t,e),this.rehydrate())}rehydrate(){c(this._protocol)&&this._protocol!==this._url.protocol&&(this._url.protocol=this._protocol),c(this._host)&&this._host!==this._url.host&&(this._url.host=this._host),c(this._hostName)&&this._hostName!==this._url.hostname&&(this._url.hostname=this._hostName),c(this._userName)&&this._userName!==this._url.username&&(this._url.username=this._userName),c(this._password)&&this._password!==this._url.password&&(this._url.password=this._password),c(this._port)&&this._port.toFixed(0)!==this._url.port&&(this._url.port=this._port.toFixed(0)),c(this._pathName)&&this._pathName!==this._url.pathname&&(this._url.pathname=this._pathName),c(this._hash)&&this._hash!==this._url.hash&&(this._url.hash=this._hash);for(let[t,e]of this._query)this._url.searchParams.set(t,e);this._protocol=this._url.protocol,this._host=this._url.host,this._hostName=this._url.hostname,this._userName=this._url.username,this._password=this._url.password,this._port=wo(this._url.port),this._pathName=this._url.pathname,this._hash=this._url.hash,this._url.searchParams.forEach((t,e)=>this._query.set(e,t))}refresh(){if(this._url===null){if(c(this._protocol)&&(c(this._host)||c(this._hostName))){if(c(this._host))return this._url=new URL(`${this._protocol}//${this._host}`,this._base),this._port=wo(this._url.port),this.rehydrate(),!1;if(c(this._hostName))return this._url=new URL(`${this._protocol}//${this._hostName}`,this._base),this.rehydrate(),!1}else if(c(this._pathName)&&c(this._base))return this._url=new URL(this._pathName,this._base),this.rehydrate(),!1}return c(this._url)}base(t){if(this._url!==null)throw new Error("Cannot redefine base after defining the protocol and domain");return this._base=t,this.refresh(),this}protocol(t){return this._protocol=t,this.refresh()&&(this._url.protocol=t),this}host(t){return this._host=t,this.refresh()&&(this._url.host=t,this._hostName=this._url.hostname,this._port=wo(this._url.port)),this}hostName(t){return this._hostName=t,this.refresh()&&(this._url.hostname=t,this._host=`${this._url.hostname}:${this._url.port}`),this}port(t){return this._port=t,this.refresh()&&(this._url.port=t.toFixed(0),this._host=`${this._url.hostname}:${this._url.port}`),this}userName(t){return this._userName=t,this.refresh()&&(this._url.username=t),this}password(t){return this._password=t,this.refresh()&&(this._url.password=t),this}path(t){return this._pathName=t,this.refresh()&&(this._url.pathname=t),this}pathPop(t){return t=t||/\/[^/]+\/?$/,this.path(this._pathName.replace(t,""))}pathPush(t){let e=this._pathName;return e.endsWith("/")||(e+="/"),e+=t,this.path(e)}query(t,e){return this._query.set(t,e),this.refresh()&&this._url.searchParams.set(t,e),this}hash(t){return this._hash=t,this.refresh()&&(this._url.hash=t),this}toURL(){return this._url}toString(){return this._url.href}[Symbol.toStringTag](){return this.toString()}};function dr(o){return u(o)?null:(x(o)&&(o=new URL(o,location.href)),o)}function ls(o){if(u(o))throw new Error("URL is undefined");if(o=dr(o),fo(o)){let t=Array.from(o.searchParams.keys()).filter(e=>e!=="v"&&e!=="t");for(let e of t)o.searchParams.delete(e)}return o}function bo(o){if(o=dr(o),u(o))throw new Error("URL is undefined");return o=ls(o),new Ne("/vr/link",location.href).query("q",o.href).toURL()}(async function(){let o=["https://www.youtube.com/watch?v=sPyAQQklc1s","https://www.youtube.com/watch?v=MgJITGvVfR0","https://www.youtube.com/watch?v=UUzQcPuK8uk","https://www.youtube.com/watch?v=K6uGXtPCjEw","https://www.youtube.com/watch?v=7NGExT9cPKA","https://www.youtube.com/watch?v=mlbWpufL_5s","https://www.youtube.com/watch?v=PqpVB72lZa8","https://www.youtube.com/watch?v=uC7ELzPyrcE"],t=new Rt,e=new Te(t,new Lt(t.destination)),n=lr(),r=new Ce(n,bo),i=on(an(async()=>{try{i.disabled=!0;let p=s.get(i.value);c(p)?await e.load(p):e.clear()}finally{i.disabled=!1}}),to("NONE"));if(t.state!=="running"){let p=Yo("Load");G("main",p),await t.ready,p.remove()}G("main",i,Ko(),e),i.disabled=!0;let s=new Map(await Promise.all(o.map(async p=>{let a=await r.loadData(bo(p).href);return[a.title,a]})));G(i,...Array.from(s.keys()).map(p=>to(p,No(p)))),i.disabled=!1})();
