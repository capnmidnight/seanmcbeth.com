function C(e,n,t){return typeof e===n||e instanceof t}function s(e){return C(e,"function",Function)}function c(e){return C(e,"string",String)}function m(e){return C(e,"boolean",Boolean)}function L(e){return l(e)&&C(e,"object",Object)}function p(e){return e==null}function l(e){return!p(e)}function g(e){return e.splice(0)}function A(e,n){return e.splice(n,1)[0]}function H(e,...n){e.splice(0,e.length,...n)}var b=class{constructor(){this.listeners=new Map;this.listenerOptions=new Map}addEventListener(n,t,r){if(s(t)){let o=this.listeners.get(n);o||(o=new Array,this.listeners.set(n,o)),o.find(a=>a===t)||(o.push(t),r&&this.listenerOptions.set(t,r))}}removeEventListener(n,t){if(s(t)){let r=this.listeners.get(n);r&&this.removeListener(r,t)}}clearEventListeners(n){for(let[t,r]of this.listeners)if(p(n)||n===t){for(let o of r)this.removeEventListener(n,o);g(r),this.listeners.delete(t)}}removeListener(n,t){let r=n.findIndex(o=>o===t);r>=0&&(A(n,r),this.listenerOptions.has(t)&&this.listenerOptions.delete(t))}dispatchEvent(n){let t=this.listeners.get(n.type);if(t)for(let r of t){let o=this.listenerOptions.get(r);l(o)&&!m(o)&&o.once&&this.removeListener(t,r),r.call(this,n)}return!n.defaultPrevented}},E=class extends Event{get type(){return super.type}constructor(n,t){super(n,t)}},x=class extends b{constructor(){super(...arguments);this.bubblers=new Set;this.scopes=new WeakMap}addBubbler(t){this.bubblers.add(t)}removeBubbler(t){this.bubblers.delete(t)}addEventListener(t,r,o){super.addEventListener(t,r,o)}removeEventListener(t,r){super.removeEventListener(t,r)}clearEventListeners(t){return super.clearEventListeners(t)}addScopedEventListener(t,r,o,a){this.scopes.has(t)||this.scopes.set(t,[]),this.scopes.get(t).push([r,o]),this.addEventListener(r,o,a)}removeScope(t){let r=this.scopes.get(t);if(r){this.scopes.delete(t);for(let[o,a]of r)this.removeEventListener(o,a)}}dispatchEvent(t){if(!super.dispatchEvent(t))return!1;if(!t.cancelBubble){for(let r of this.bubblers)if(!r.dispatchEvent(t))return!1}return!0}};function G(e){return e}var V=class{constructor(n=!0){this.autoStart=n;this.onThens=new Array;this.onCatches=new Array;this._result=void 0;this._error=void 0;this._executionState="waiting";this._resultState="none";this.resolve=t=>{if(this.running){this._result=t,this._resultState="resolved";for(let r of this.onThens)r(t);this.clear(),this._executionState="finished"}},this.reject=t=>{if(this.running){this._error=t,this._resultState="errored";for(let r of this.onCatches)r(t);this.clear(),this._executionState="finished"}},this.autoStart&&this.start()}clear(){g(this.onThens),g(this.onCatches)}start(){this._executionState="running"}resolver(n){return()=>this.resolve(n)}resolveOn(n,t,r){let o=this.resolver(r);n.addEventListener(t,o),this.finally(()=>n.removeEventListener(t,o))}get result(){if(l(this.error))throw this.error;return this._result}get error(){return this._error}get executionState(){return this._executionState}get waiting(){return this.executionState==="waiting"}get started(){return this.executionState!=="waiting"}get running(){return this.executionState==="running"}get finished(){return this.executionState==="finished"}get resultState(){return this._resultState}get resolved(){return this.resultState==="resolved"}get errored(){return this.resultState==="errored"}get[Symbol.toStringTag](){return this.toString()}project(){return new Promise((n,t)=>{this.finished?this.errored?t(this.error):n(this.result):(this.onThens.push(n),this.onCatches.push(t))})}then(n,t){return this.project().then(n,t)}catch(n){return this.project().catch(n)}finally(n){return this.project().finally(n)}reset(){this._reset(this.autoStart)}restart(){this._reset(!0)}_reset(n){this.running&&this.reject("Resetting previous invocation"),this.clear(),this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",n&&this.start()}};var f=class{constructor(n,t,r,...o){this.key=n;this.value=t;this.bySetAttribute=r;this.tags=o.map(a=>a.toLocaleUpperCase()),Object.freeze(this)}applyToElement(n){let t=this.key.startsWith("data-");if(!(this.tags.length===0||this.tags.indexOf(n.tagName)>-1||t))console.warn(`Element ${n.tagName} does not support Attribute ${this.key}`);else if(t){let o=this.key.substring(5);n.dataset[o]=this.value}else if(this.key==="style")Object.assign(n.style,this.value);else if(this.key==="classList"){let o=this.value.filter(G);o.length>0&&o.forEach(a=>n.classList.add(a))}else this.bySetAttribute?n.setAttribute(this.key,this.value):this.key in n?n[this.key]=this.value:this.value===!1?n.removeAttribute(this.key):this.value===!0?n.setAttribute(this.key,""):n.setAttribute(this.key,this.value)}};function k(...e){return new f("classList",e,!1)}function F(e){return new f("htmlFor",e,!1,"label","output")}function v(e){return c(e)||(e=e.value),new f("type",e,!1,"button","input","command","embed","link","object","script","source","style","menu")}function j(e){return L(e)?e.element instanceof Element:!1}function h(e){return j(e)?e.element:c(e)?oe(e):e}function re(e){return L(e)&&"applyToElement"in e&&s(e.applyToElement)}function d(e,...n){e=h(e);for(let t of n)l(t)&&(t instanceof Node?e.append(t):j(t)?e.append(h(t)):re(t)?t.applyToElement(e):e.append(document.createTextNode(t.toLocaleString())));return e}function oe(e){return document.querySelector(e)}function y(e,...n){let t=null;for(let r of n)if(r instanceof f&&r.key==="id"){t=document.getElementById(r.value);break}return t==null&&(t=document.createElement(e)),d(t,...n),t}function ie(e){for(e=h(e);e.lastChild;)e.lastChild.remove()}function w(e,n){e=h(e),ie(e),e.append(le(n))}function ae(...e){return y("button",...e)}function K(...e){return ae(...e,v("button"))}function _(...e){return y("input",...e)}function B(...e){return y("label",...e)}function z(e,n,t){return h(t).id=e,[B(F(e),n),t]}function W(...e){return y("pre",...e)}function $(...e){return _(v("checkbox"),...e)}function N(...e){return _(v("file"),...e)}function le(e){return document.createTextNode(e)}var M=class{constructor(n,t,r){this.name=n;this.callback=t;if(!s(t))throw new Error("A function instance is required for this parameter");this.opts=r,Object.freeze(this)}applyToElement(n){this.add(n)}add(n){n.addEventListener(this.name,this.callback,this.opts)}remove(n){n.removeEventListener(this.name,this.callback)}};function S(e,n,t){return new M(e,n,t)}function U(e,n){return S("click",e,n)}function q(e,n){return S("dragend",e,n)}function X(e,n){return S("dragleave",e,n)}function Y(e,n){return S("dragover",e,n)}function J(e,n){return S("drop",e,n)}function Q(e,n){return S("input",e,n)}function Z(e){return e.flatMap(n=>n.extensions.map(t=>"."+t)).sort().join(", ")}var O=class extends E{constructor(t){super("input");this.files=t}},T=class extends x{constructor(t,r,o,a=null){super();this.file=o;this.typeFilters=new Array;this.element=null;this._dragTarget=null;let te=i=>Array.from(i).filter(u=>this.typeFilters.length===0||this.typeFilters.filter(P=>P.matches(u.type)).length>0),ne=i=>Array.from(i).filter(u=>u.kind=="file"&&(this.typeFilters.length===0||this.typeFilters.filter(P=>P.matches(u.type)).length>0));this.onDragOver=i=>{this.enabled&&(ne(i.dataTransfer.items).length>0?w(this.element,"Drop file..."):w(this.element,"No files matching expected type(s)")),i.preventDefault()},this.onDragEnd=i=>{this.enabled&&w(this.element,t),i.preventDefault()},this.onDrop=i=>{this.enabled&&R(i.dataTransfer.files),this.onDragEnd(i)};let R=i=>{let u=te(i);u.length>0&&this.dispatchEvent(new O(u))};this.file.style.display="none",this.file.insertAdjacentElement("afterend",this.element=K(k("btn",`btn-${r}`),U(()=>this.show()),t)),this.dragTarget=a||this.element,this.file.addEventListener("input",()=>R(this.file.files)),this.setTypeFilters(),this.enabled=!0}get dragTarget(){return this._dragTarget}set dragTarget(t){t!==this.dragTarget&&(this.dragTarget&&(this.dragTarget.removeEventListener("dragover",this.onDragOver),this.dragTarget.removeEventListener("dragend",this.onDragEnd),this.dragTarget.removeEventListener("dragleave",this.onDragEnd),this.dragTarget.removeEventListener("drop",this.onDrop)),this._dragTarget=t,this.dragTarget&&d(this.dragTarget,Y(this.onDragOver),X(this.onDragEnd),q(this.onDragEnd),J(this.onDrop)))}show(){this.file.showPicker?this.file.showPicker():this.file.click()}setTypeFilters(...t){H(this.typeFilters,...t),this.file.accept=Z(t)}isExpectedType(t){return p(t)?!1:this.typeFilters.length===0?!0:this.typeFilters.map(r=>r.matches(t)).reduce((r,o)=>r||o,!1)}get accept(){return this.file.accept}get enabled(){return!this.file.disabled}set enabled(t){this.file.disabled=!t,this.element.disabled=!t}get disabled(){return!this.enabled}set disabled(t){this.enabled=!t}get files(){return this.file.files}clear(){this.file.value=null}};var I=new T("Pick a file, any file","primary",N(),document.documentElement),ee=$(Q(()=>I.disabled=ee.checked));I.addEventListener("input",e=>{for(let n of e.files)d("main",W(n.name))});d("main",I,...z("file-disabler",B("Disable picker"),ee));
