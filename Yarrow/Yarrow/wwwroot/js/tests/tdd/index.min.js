var Fo=Object.defineProperty;var Qt=(n,e)=>{for(var t in e)Fo(n,t,{get:e[t],enumerable:!0})};var xe=class extends Error{constructor(t,o=null){super(t);this.innerError=o}};function be(n){return n}function en(){}function tn(){return!0}function nn(){return!1}function Me(n,e,t){return typeof n===e||n instanceof t}function C(n){return Me(n,"function",Function)}function y(n){return Me(n,"string",String)}function fe(n){return Me(n,"boolean",Boolean)}function te(n){return Me(n,"number",Number)}function q(n){return d(n)&&Me(n,"object",Object)}function He(n){return n instanceof Array}function O(n,e){throw new Error((e||"Unexpected object: ")+n)}function _(n){return n==null}function d(n){return!_(n)}function on(n){return n instanceof Uint8Array||n instanceof Uint8ClampedArray||n instanceof Int8Array||n instanceof Uint16Array||n instanceof Int16Array||n instanceof Uint32Array||n instanceof Int32Array||n instanceof Float32Array||n instanceof Float64Array||"BigUint64Array"in globalThis&&n instanceof globalThis.BigUint64Array||"BigInt64Array"in globalThis&&n instanceof globalThis.BigInt64Array}function rn(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function No(n){return n}function Ho(n,e,t){let o=0,r=n.length,i=Math.floor((o+r)/2),s=!1;for(;o<r&&i<n.length;){let a=n[i],p=_(a)?null:t(a);d(p)&&e<p?r=i:(e===p&&(s=!0),o=i+1),i=Math.floor((o+r)/2)}return s||(i+=.5),i}function zo(n,e,t){t=t||No;let o=t(e);return Ho(n,o,t)}function K(n){return n.splice(0)}function sn(n,e){for(let t=0;t<n.length;++t)if(n[t]!==e[t])return t;return-1}function wt(n,e,t){n.splice(t,0,e)}function _e(n,e){let t=n.indexOf(e);return t>-1?(Vt(n,t),!0):!1}function Vt(n,e){return n.splice(e,1)[0]}function Ct(n,e,t,o){let r;return C(t)?r=t:fe(t)&&(o=t),_(o)&&(o=!0),Go(n,e,r,o)}function Go(n,e,t,o){let r=zo(n,e,t),i=r%1===0;return r=r|0,(!i||o)&&wt(n,e,r),r}var Ie=class{constructor(){this.listeners=new Map;this.listenerOptions=new Map}addEventListener(e,t,o){if(C(t)){let r=this.listeners.get(e);r||(r=new Array,this.listeners.set(e,r)),r.find(i=>i===t)||(r.push(t),o&&this.listenerOptions.set(t,o))}}removeEventListener(e,t){if(C(t)){let o=this.listeners.get(e);o&&this.removeListener(o,t)}}clearEventListeners(e){for(let[t,o]of this.listeners)if(_(e)||e===t){for(let r of o)this.removeEventListener(e,r);K(o),this.listeners.delete(t)}}removeListener(e,t){let o=e.findIndex(r=>r===t);o>=0&&(Vt(e,o),this.listenerOptions.has(t)&&this.listenerOptions.delete(t))}dispatchEvent(e){let t=this.listeners.get(e.type);if(t)for(let o of t){let r=this.listenerOptions.get(o);d(r)&&!fe(r)&&r.once&&this.removeListener(t,o),o.call(this,e)}return!e.defaultPrevented}},I=class extends Event{get type(){return super.type}constructor(e,t){super(e,t)}},D=class extends Ie{constructor(){super(...arguments);this.bubblers=new Set;this.scopes=new WeakMap}addBubbler(t){this.bubblers.add(t)}removeBubbler(t){this.bubblers.delete(t)}addEventListener(t,o,r){super.addEventListener(t,o,r)}removeEventListener(t,o){super.removeEventListener(t,o)}clearEventListeners(t){return super.clearEventListeners(t)}addScopedEventListener(t,o,r,i){this.scopes.has(t)||this.scopes.set(t,[]),this.scopes.get(t).push([o,r]),this.addEventListener(o,r,i)}removeScope(t){let o=this.scopes.get(t);if(o){this.scopes.delete(t);for(let[r,i]of o)this.removeEventListener(r,i)}}dispatchEvent(t){if(!super.dispatchEvent(t))return!1;if(!t.cancelBubble){for(let o of this.bubblers)if(!o.dispatchEvent(t))return!1}return!0}};var L=class{constructor(e=!0){this.autoStart=e;this.onThens=new Array;this.onCatches=new Array;this._result=void 0;this._error=void 0;this._executionState="waiting";this._resultState="none";this.resolve=t=>{if(this.running){this._result=t,this._resultState="resolved";for(let o of this.onThens)o(t);this.clear(),this._executionState="finished"}},this.reject=t=>{if(this.running){this._error=t,this._resultState="errored";for(let o of this.onCatches)o(t);this.clear(),this._executionState="finished"}},this.autoStart&&this.start()}clear(){K(this.onThens),K(this.onCatches)}start(){this._executionState="running"}resolver(e){return()=>this.resolve(e)}resolveOn(e,t,o){let r=this.resolver(o);e.addEventListener(t,r),this.finally(()=>e.removeEventListener(t,r))}get result(){if(d(this.error))throw this.error;return this._result}get error(){return this._error}get executionState(){return this._executionState}get waiting(){return this.executionState==="waiting"}get started(){return this.executionState!=="waiting"}get running(){return this.executionState==="running"}get finished(){return this.executionState==="finished"}get resultState(){return this._resultState}get resolved(){return this.resultState==="resolved"}get errored(){return this.resultState==="errored"}get[Symbol.toStringTag](){return this.toString()}project(){return new Promise((e,t)=>{this.finished?this.errored?t(this.error):e(this.result):(this.onThens.push(e),this.onCatches.push(t))})}then(e,t){return this.project().then(e,t)}catch(e){return this.project().catch(e)}finally(e){return this.project().finally(e)}reset(){this._reset(this.autoStart)}restart(){this._reset(!0)}_reset(e){this.running&&this.reject("Resetting previous invocation"),this.clear(),this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",e&&this.start()}};function an(n,e){return"on"+e in n}function w(n,e,t,...o){_(o)&&(o=[]);let r;if(y(t)?o.unshift(t):te(t)&&(r=t),!(n instanceof Ie)){if(!an(n,e))throw new xe(`Target does not have a ${e} rejection event`);for(let p of o)if(!an(n,p))throw new xe(`Target does not have a ${p} rejection event`)}let i=new L;if(te(r)){let p=setTimeout(i.reject,r,`'${e}' has timed out.`);i.finally(clearTimeout.bind(globalThis,p))}let s=(p,c)=>{n.addEventListener(p,c),i.finally(()=>n.removeEventListener(p,c))};s(e,p=>i.resolve(p));let a=p=>i.reject(p);for(let p of o)s(p,a);return i}function B(n){return n.then(tn).catch(nn)}var ne=class{constructor(e,t,o,...r){this.key=e;this.value=t;this.bySetAttribute=o;this.tags=r.map(i=>i.toLocaleUpperCase()),Object.freeze(this)}applyToElement(e){let t=this.key.startsWith("data-");if(!(this.tags.length===0||this.tags.indexOf(e.tagName)>-1||t))console.warn(`Element ${e.tagName} does not support Attribute ${this.key}`);else if(t){let r=this.key.substring(5);e.dataset[r]=this.value}else if(this.key==="style")Object.assign(e.style,this.value);else if(this.key==="classList"){let r=this.value.filter(be);r.length>0&&r.forEach(i=>e.classList.add(i))}else this.bySetAttribute?e.setAttribute(this.key,this.value):this.key in e?e[this.key]=this.value:this.value===!1?e.removeAttribute(this.key):this.value===!0?e.setAttribute(this.key,""):e.setAttribute(this.key,this.value)}};function pn(n){return new ne("height",n,!1,"canvas","embed","iframe","img","input","object","video")}function cn(n){return new ne("id",n,!1)}function ln(n){return new ne("rel",n,!1,"a","area","link")}function ke(n){return y(n)||(n=n.value),new ne("type",n,!1,"button","input","command","embed","link","object","script","source","style","menu")}function dn(n){return new ne("width",n,!1,"canvas","embed","iframe","img","input","object","video")}function mn(n){return`${n}%`}function ze(n){return`${n}em`}function un(n){return`${n}px`}function xn(n){return`${n}fr`}function Wo(){return"ui-monospace, 'Droid Sans Mono', 'Cascadia Mono', 'Segoe UI Mono', 'Ubuntu Mono', 'Roboto Mono', Menlo, Monaco, Consolas, monospace"}function fn(){return Uo(Wo())}var Tt=class{constructor(e){this._value=e}get value(){return this._value}toString(){return this.value}};var Et=class extends Tt{constructor(t,o,r){super(r);this._name=t;this.sep=o}get name(){return this._name}toString(){return this.name+this.sep+this.value+";"}};var Pt=class extends Et{constructor(e,t){super(e,": ",t)}},j=class extends Pt{constructor(t,o){super(t.replace(/[A-Z]/g,r=>`-${r.toLocaleLowerCase()}`),o.toString());this.key=t;this.priority=""}applyToElement(t){t.style[this.key]=this.value+this.priority}important(){return this.priority=" !important",this}get value(){return super.value+this.priority}};function _n(n){return new j("backgroundColor",n)}function hn(n){return new j("color",n)}function gn(n){return new j("columnGap",n)}function Mt(n){return new j("display",n)}function Uo(n){return new j("fontFamily",n)}function J(n,e){return y(n)||(n=[n,e].filter(d).join("/")),new j("gridColumn",n)}function vn(...n){return new j("gridTemplateColumns",n.join(" "))}function It(n){return new j("height",n)}function kt(...n){return new j("overflow",n.join(" "))}function bn(n){return new j("paddingTop",n)}function An(n){return new j("whiteSpace",n)}function Lt(n){return new j("width",n)}function Sn(n){return q(n)?n.element instanceof Element:!1}function Ge(n){return Sn(n)?n.element:y(n)?wn(n):n}function qo(n){return q(n)&&"applyToElement"in n&&C(n.applyToElement)}function We(n,...e){n=Ge(n);for(let t of e)d(t)&&(t instanceof Node?n.append(t):Sn(t)?n.append(Ge(t)):qo(t)?t.applyToElement(n):n.append(document.createTextNode(t.toLocaleString())));return n}function yn(n,...e){return n=Ge(n),n.replaceWith(...e.map(Ge)),n}function wn(n){return document.querySelector(n)}function Vn(n){return wn(n)}function he(n,...e){let t=null;for(let o of e)if(o instanceof ne&&o.key==="id"){t=document.getElementById(o.value);break}return t==null&&(t=document.createElement(n)),We(t,...e),t}function Ko(...n){return he("button",...n)}function Cn(...n){return Ko(...n,ke("button"))}function Tn(...n){return he("canvas",...n)}function W(...n){return he("div",...n)}function Rt(...n){return he("img",...n)}function En(...n){return he("link",...n)}function Pn(...n){return he("script",...n)}function Ue(...n){return he("span",...n)}var Le=class extends D{constructor(){super(...arguments);this.attached=new Array;this.soFar=null;this.total=null;this.msg=null;this.est=null}get p(){return this.total>0?this.soFar/this.total:0}report(t,o,r,i){this.soFar=t,this.total=o,this.msg=r,this.est=i;for(let s of this.attached)s.report(t,o,r,i)}attach(t){this.attached.push(t),t.report(this.soFar,this.total,this.msg,this.est)}clear(){this.report(0,0),this._clear()}start(t){this.report(0,1,t||"starting")}end(t){this.report(1,1,t||"done"),this._clear()}_clear(){this.soFar=null,this.total=null,this.msg=null,this.est=null,K(this.attached)}};var Xt=class{constructor(e,t,o){this.name=e;this.callback=t;if(!C(t))throw new Error("A function instance is required for this parameter");this.opts=o,Object.freeze(this)}applyToElement(e){this.add(e)}add(e){e.addEventListener(this.name,this.callback,this.opts)}remove(e){e.removeEventListener(this.name,this.callback)}};function Jo(n,e,t){return new Xt(n,e,t)}function Mn(n,e){return Jo("click",n,e)}var qe=class extends I{constructor(t,o){super("testoutputresults");this.results=t;this.stats=o}};var oe=class{constructor(e){this.items=new Map;if(d(e))for(let[t,o,r]of e)this.add(t,o,r)}add(e,t,o){let r=this.items.get(e);return _(r)&&this.items.set(e,r=new Map),r.set(t,o),this}*entries(){for(let[e,t]of this.items)for(let[o,r]of t)yield[e,o,r]}keys(e){return _(e)?this.items.keys():this.items.get(e).keys()}*values(){for(let e of this.items.values())for(let t of e.values())yield t}has(e,t){return this.items.has(e)&&(_(t)||this.items.get(e).has(t))}get(e,t){return _(t)?this.items.get(e):this.items.has(e)?this.items.get(e).get(t):null}count(e){return this.items.has(e)?this.items.get(e).size:null}get size(){let e=0;for(let t of this.items.values())e+=t.size;return e}delete(e,t){if(_(t))return this.items.delete(e);if(this.items.has(e)){let o=this.items.get(e),r=o.delete(t);return o.size===0&&this.items.delete(e),r}else return!1}clear(){this.items.clear()}};var Ae=class extends I{constructor(t){super("testcasefail");this.message=t}};var Re=class extends I{constructor(t){super("testrunnerresults");this.results=t}};var Xe=class{constructor(e){this.name=e;this.state=0,this.messages=[]}start(){this.state|=1}success(){this.state|=2}fail(e){this.state|=4,this.messages.push(e)}finish(e){this.state|=8,e&&this.messages.push(e)}};function kn(n){let e=Object.getOwnPropertyNames(n);return e.sort(),e}function Ln(n,e,t){return(e===t||_(t)&&e.startsWith("test_"))&&C(n[e])}var Ke=class extends D{constructor(...t){super();this.props=t.filter(o=>!C(o)),this.CaseClasses=t.filter(o=>C(o))}scaffold(){let t=new oe;for(let o of this.CaseClasses)for(let r of kn(o.prototype))Ln(o.prototype,r)&&t.add(o.name,r,new Xe(r));this.dispatchEvent(new Re(t))}async run(t,o){let r=()=>this.dispatchEvent(new Re(i)),i=new oe,s=new Array;for(let p of this.CaseClasses)for(let c of kn(p.prototype))Ln(p.prototype,c,o)&&(i.add(p.name,c,new Xe(c)),(p.name===t||_(t))&&s.push(()=>this.runTest(p,c,i,p.name,r)));let a=async()=>{r();let p=10;for(let c=0;c<p&&s.length>0;++c)await s.shift()().finally(en),c===p-1&&setTimeout(a)};a()}async runTest(t,o,r,i,s){let a=new t,p=a[o],c=r.get(i),l=c.get(o),u=v=>{l.messages.push(v.message),s()},m=()=>{l.success(),s()},x=v=>{l.fail(v.message),s()};for(let v of this.props)Object.assign(a,v);a.addEventListener("testcasemessage",u),a.addEventListener("testcasesuccess",m),a.addEventListener("testcasefail",x);let V=null;try{l.start(),s(),a.setup(),V=await p.call(a)}catch(v){console.error(`Test case failed [${i}::${o}]`,v),V=v,x(new Ae(v))}l.finish(V),s(),a.teardown(),a.clearEventListeners(),s()}};var Je=class extends D{constructor(...t){super();this.CaseClasses=t}async run(t,o){this.createTestRunner().run(t,o)}scaffold(){this.createTestRunner().scaffold()}createTestRunner(){let t=new Ke(...this.CaseClasses);return t.addEventListener("testrunnerresults",o=>{let r=o.results,i=0,s=0,a=0,p=0,c=0,l=0;for(let m of r.values())++i,m.state&1&&++s,m.state&8?++a:++p,m.state&2&&++c,m.state&4&&++l;let u={totalFound:i,totalRan:s,totalCompleted:a,totalIncomplete:p,totalSucceeded:c,totalFailed:l};this.dispatchEvent(new qe(r,u))}),t}};function Ot(n,e){return[_n(n),hn(n),Lt(`${e}%`)]}function Bt(n,...e){return Cn(Mn(n),J(1),"\u{1F504}\uFE0F",...e)}function $o(n){let e=n&8;return n&4?e?"Failure":"Failing":n&2?e?"Success":"Succeeding":n&1?e?"No test ran":"Running":"Found"}var $e=class extends Je{constructor(...t){super(...t);this.element=W(cn("testOutput"));let o=null;this.addEventListener("testoutputresults",r=>{let i=Math.round(100*r.stats.totalSucceeded/r.stats.totalFound),s=Math.round(100*r.stats.totalFailed/r.stats.totalFound),a=Math.round(100*(r.stats.totalFound-r.stats.totalSucceeded-r.stats.totalFailed)/r.stats.totalFound),p=[Mt("inline-block"),kt("hidden"),It(ze(1))],c=W(Mt("grid"),vn("auto","auto","auto",xn(1)),fn(),Lt(mn(100)),gn(ze(1)),Bt(()=>this.run()),W(J(2,5),It(ze(2)),An("nowrap"),kt("hidden"),Ue(...p,...Ot("green",i)),Ue(...p,...Ot("red",s)),Ue(...p,...Ot("grey",a))),W(J(1),"Rerun"),W(J(2),"Name"),W(J(3),"Status")),l=null;for(let[u,m,x]of r.results.entries())u!==l&&(l=u,c.append(Bt(()=>this.run(u)),W(J(2,5),bn(un(20)),u))),c.append(Bt(()=>this.run(u,m)),W(J(2),m),W(J(3),$o(x.state)),W(J(4),x.messages.join(", ")));d(o)?yn(o,c):this.element.append(c),o=c}),this.scaffold()}};var Oe=class extends Le{constructor(t,o){super();this.i=t;this.prog=o}report(t,o,r,i){super.report(t,o,r,i),this.prog.update(this.i,t,o,r)}};var Ye=class{constructor(e){this.prog=e;this.weightTotal=0;this.subProgressCallbacks=new Array;this.subProgressWeights=new Array;this.subProgressValues=new Array;this.start=performance.now();for(let t=0;t<this.subProgressWeights.length;++t)this.subProgressValues[t]=0,this.subProgressCallbacks[t]=new Oe(t,this)}addSubProgress(e){e=e||1,this.weightTotal+=e,this.subProgressWeights.push(e),this.subProgressValues.push(0);let t=new Oe(this.subProgressCallbacks.length,this);return this.subProgressCallbacks.push(t),t}update(e,t,o,r){if(this.prog){this.subProgressValues[e]=t/o;let i=0;for(let c=0;c<this.subProgressWeights.length;++c)i+=this.subProgressValues[c]*this.subProgressWeights[c];let s=performance.now(),a=s-this.start,p=this.start-s+a*this.weightTotal/i;this.prog.report(i,this.weightTotal,r,p)}}};function jt(n,e){return new Dt(e,n).subProgressCallbacks}function Rn(n,e){let t=new Array(e);for(let o=0;o<e;++o)t[o]=1;return jt(n,t)}var Dt=class extends Ye{constructor(e,t){super(t);for(let o of e)this.addSubProgress(o)}};async function Xn(n,e){let t=new Array(e.length),o=new Array(e.length);for(let s=0;s<e.length;++s){let a=e[s];t[s]=a[0],o[s]=a[1]}let r=jt(n,t),i=new Array(e.length);for(let s=0;s<e.length;++s)i[s]=o[s](r[s]);return await Promise.all(i)}var On=/([^\/]+)\/(.+)/,Yo=/(?:([^\.]+)\.)?([^\+;]+)(?:\+([^;]+))?((?:; *([^=]+)=([^;]+))*)/;var ae=class{constructor(e,t,o){this._type=e;this._fullSubType=t;this._primaryExtension=null;this.depMessage=null;let r=new Map;this._parameters=r;let i=this._fullSubType.match(Yo);this._tree=i[1],this._subType=i[2],this._suffix=i[3];let s=i[4];if(this._value=this._fullValue=this._type+"/",d(this._tree)&&(this._value=this._fullValue+=this._tree+"."),this._value=this._fullValue+=this._subType,d(this._suffix)&&(this._value=this._fullValue+="+"+this._suffix),d(s)){let a=s.split(";").map(p=>p.trim()).filter(p=>p.length>0).map(p=>p.split("="));for(let[p,...c]of a){let l=c.join("=");r.set(p,l);let u=`; ${p}=${l}`;this._fullValue+=u,p!=="q"&&(this._value+=u)}}this._extensions=o||[],this._primaryExtension=this._extensions[0]||null}static parse(e){if(!e)return null;let t=e.match(On);if(!t)return null;let o=t[1],r=t[2];return new ae(o,r)}deprecate(e){return this.depMessage=e,this}check(){d(this.depMessage)&&console.warn(`${this._value} is deprecated ${this.depMessage}`)}matches(e){if(_(e))return!1;if(this.typeName==="*"&&this.subTypeName==="*")return!0;let t=null,o=null;if(y(e)){let r=e.match(On);if(!r)return!1;t=r[1],o=r[2]}else t=e.typeName,o=e._fullSubType;return this.typeName===t&&(this._fullSubType==="*"||this._fullSubType===o)}withParameter(e,t){let o=`${this._fullSubType}; ${e}=${t}`;return new ae(this.typeName,o,this.extensions)}get typeName(){return this.check(),this._type}get tree(){return this.check(),this._tree}get suffix(){return this._suffix}get subTypeName(){return this.check(),this._subType}get value(){return this.check(),this._value}__getValueUnsafe(){return this._value}get fullValue(){return this.check(),this._fullValue}get parameters(){return this.check(),this._parameters}get extensions(){return this.check(),this._extensions}__getExtensionsUnsafe(){return this._extensions}get primaryExtension(){return this.check(),this._primaryExtension}toString(){return this.parameters.get("q")==="1"?this.value:this.fullValue}addExtension(e){if(!e)throw new Error("File name is not defined");if(this.primaryExtension){let t=e.lastIndexOf(".");if(t>-1){let o=e.substring(t+1);this.extensions.indexOf(o)>-1&&(e=e.substring(0,t))}e=`${e}.${this.primaryExtension}`}return e}};function Zo(n,e,...t){return new ae(n,e,t)}function F(n){return Zo.bind(null,n)}var Ft=F("application");var Se=Ft("javascript","js");var Nt=Ft("json","json");var Ht=Ft("wasm","wasm");var zt=F("text");var Ze=zt("css","css");var Qe=zt("plain","txt","text","conf","def","list","log","in");var Bn=zt("xml");function Dn(n){if(n.status>=400)throw new Error("Resource could not be retrieved: "+n.requestPath);return n}function et(n){let{content:e}=Dn(n);return e}function Fn(n){return d(n)&&C(n.then)&&C(n.catch)&&C(n.finally)&&C(n.fetch)&&C(n.getSize)}var jn=class{constructor(e,t){this.path=e;this.type=t;this._result=null;this._error=null;this._started=!1;this._finished=!1;this.resolve=null;this.reject=null;this.promise=new Promise((o,r)=>{this.resolve=i=>{this._result=i,this._finished=!0,o(i)},this.reject=i=>{this._error=i,this._finished=!0,r(i)}})}get result(){if(d(this.error))throw this.error;return this._result}get error(){return this._error}get started(){return this._started}get finished(){return this._finished}async getSize(e){try{let{contentLength:t}=await e.head(this.path).accept(this.type).exec();return[this,t||1]}catch(t){return console.warn(t),[this,1]}}async fetch(e,t){try{let o=await this.getResult(e,t);this.resolve(o)}catch(o){this.reject(o)}}get[Symbol.toStringTag](){return this.promise.toString()}then(e,t){return this.promise.then(e,t)}catch(e){return this.promise.catch(e)}finally(e){return this.promise.finally(e)}};function Gt(n,...e){if(!q(n))return!1;n=n;for(let t of e){if(!(t in n))return!1;let o=n[t];if(!C(o))return!1}return!0}function Qo(n){return Gt(n,"dispose")}function er(n){return Gt(n,"destroy")}function tr(n){return Gt(n,"close")}function M(n){Qo(n)&&n.dispose(),tr(n)&&n.close(),er(n)&&n.destroy()}function $(n,e){try{return e(n)}finally{M(n)}}function pe(n,e){try{return e(n)}finally{if(d(n))for(let t of n)M(t)}}async function ce(n,e){try{return await e(n)}finally{M(n)}}async function le(n,e){try{return await e(n)}finally{if(d(n))for(let t of n)M(t)}}var Rp="HTMLCanvasElement"in globalThis,Xp="HTMLImageElement"in globalThis,Nn=!1,ye=!Nn&&"OffscreenCanvas"in globalThis,Op=!Nn&&"createImageBitmap"in globalThis;function nr(){try{return new OffscreenCanvas(1,1).getContext("2d")!=null}catch{return!1}}var Bp=ye&&nr();function or(){try{return new OffscreenCanvas(1,1).getContext("webgl2")!=null}catch{return!1}}var Dp=ye&&or();function Hn(n,e){return new OffscreenCanvas(n,e)}function zn(n,e){return Tn(dn(n),pn(e))}function Wt(n,e){let t=n.getContext("2d");if(_(t))throw new Error("Could not create 2d context for canvas");t.drawImage(e,0,0)}function Gn(n){let e=new L,t=setInterval(()=>{n()&&(clearInterval(t),e.resolve())},100);return e}async function E(n,e){let{status:t,requestPath:o,responsePath:r,content:i,contentType:s,contentLength:a,fileName:p,headers:c,date:l}=n;return{status:t,requestPath:o,responsePath:r,content:d(e)?await e(i):void 0,contentType:s,contentLength:a,fileName:p,headers:c,date:l}}var Ut=null;function Wn(n){return Ut===null&&(Ut=new Audio),Ut.canPlayType(n)!==""}var tt=class{constructor(e,t,o,r=!1){this.fetcher=e;this.method=t;this.path=o;this.useBLOBs=r;this.prog=null;this.request={method:t,path:this.path.href,body:null,headers:null,timeout:null,withCredentials:!1,useCache:!1,retryCount:3}}retries(e){return this.request.retryCount=e,this}query(e,t){return this.path.searchParams.set(e,t),this.request.path=this.path.href,this}header(e,t){return this.request.headers===null&&(this.request.headers=new Map),this.request.headers.set(e.toLowerCase(),t),this}headers(e){for(let[t,o]of e.entries())this.header(t,o);return this}timeout(e){return this.request.timeout=e,this}progress(e){return this.prog=e,this}body(e,t){if(d(e)){let o=new Set,r=new Array;r.push(e);let i=!1;for(;!i&&r.length>0;){let s=r.shift();if(s&&!o.has(s))if(o.add(s),s instanceof Blob){i=!0;break}else y(s)||r.push(...Object.values(s))}if(i){let s=new FormData,a=new Map,p=new Set;for(let[c,l]of Object.entries(e))if(l instanceof Blob){let u=c+".name",m=e[u];y(m)&&(a.set(l,m),p.add(u))}for(let[c,l]of Object.entries(e))p.has(c)||(l instanceof Blob?s.append(c,l,a.get(l)):y(l)?s.append(c,l):d(l)&&C(l.toString)?s.append(c,l.toString()):console.warn("Can't serialize value to formdata",c,l));e=s,t=void 0}this.request.body=e,this.content(t)}return this}withCredentials(){return this.request.withCredentials=!0,this}useCache(e=!0){return this.request.useCache=e,this}media(e,t){d(t)&&(y(t)||(t=t.value),this.header(e,t))}content(e){this.media("content-type",e)}accept(e){return this.media("accept",e),this}blob(e){if(this.accept(e),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetBlob(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetBlob(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);O(this.method)}buffer(e){if(this.accept(e),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetBuffer(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetBuffer(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);O(this.method)}async file(e){if(this.accept(e),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return await this.fetcher.sendObjectGetFile(this.request,this.prog);if(this.method==="GET"){if(this.useBLOBs)return await this.fetcher.sendNothingGetFile(this.request,this.prog);{let t=await this.fetcher.sendNothingGetNothing(this.request);return E(t,()=>this.request.path)}}else{if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);O(this.method)}}text(e){if(this.accept(e||Qe),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetText(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetText(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);O(this.method)}object(e){if(this.accept(e||Nt),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetObject(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetObject(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);O(this.method)}xml(e){if(this.accept(e||Bn),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetXml(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetXml(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);O(this.method)}imageBitmap(e){if(this.accept(e),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetImageBitmap(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetImageBitmap(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);O(this.method)}exec(){if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetNothing(this.request,this.prog);if(this.method==="GET")throw new xe("GET requests should expect a response type");if(this.method==="HEAD"||this.method==="OPTIONS")return this.fetcher.sendNothingGetNothing(this.request);O(this.method)}async audioBlob(e){if(d(e)&&(y(e)||(e=e.value),!Wn(e)))throw new Error(`Probably can't play file of type "${e}" at path: ${this.request.path}`);let t=await this.blob(e);if(Wn(t.contentType))return t;throw new Error(`Cannot play file of type "${t.contentType}" at path: ${this.request.path}`)}async audioBuffer(e,t){return E(await this.audioBlob(t),async o=>await e.decodeAudioData(await o.arrayBuffer()))}async htmlElement(e,t,o){let r=await this.file(o),i=w(e,t,"error");return e instanceof HTMLLinkElement?e.href=r.content:e.src=r.content,await i,await E(r,()=>e)}image(e){return this.htmlElement(Rt(),"load",e)}async htmlCanvas(e){let t=zn(1,1);if(this.method==="GET")if(ye){this.accept(e);let o=await this.fetcher.drawImageToCanvas(this.request,t.transferControlToOffscreen(),this.prog);return await E(o,()=>t)}else{let o=await this.image(e);return await E(o,r=>(t.width=r.width,t.height=r.height,Wt(t,r),M(r),t))}else{if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE"||this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);O(this.method)}}canvas(e){return ye?this.offscreenCanvas(e):this.htmlCanvas(e)}async offscreenCanvas(e){if(!ye)throw new Error("This system does not support OffscreenCanvas");if(this.method==="GET"){let t=await this.image(e);return await E(t,o=>{let r=Hn(o.width,o.height);return Wt(r,o),M(o),r})}else{if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE"||this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);O(this.method)}}async style(){let e=En(ke(Ze),ln("stylesheet"));document.head.append(e);let t=await this.htmlElement(e,"load",Ze);return E(t)}async getScript(){let e=Pn(ke(Se));document.head.append(e);let t=await this.htmlElement(e,"load",Se);return E(t)}async script(e){let t=null,o=this.request.path;if(!e)t=await this.getScript();else if(!e()){let r=Gn(e);t=await this.getScript(),await r}return this.prog&&this.prog.end(o),t}async module(){let e=this.request.path,t=await this.file(Se),o=await import(t.content);return this.prog&&this.prog.end(e),E(t,()=>o)}async wasm(e){let t=await this.buffer(Ht);if(!Ht.matches(t.contentType))throw new Error(`Server did not respond with WASM file. Was: ${t.contentType}`);let o=await WebAssembly.compile(t.content),r=await WebAssembly.instantiate(o,e);return E(t,()=>r.exports)}async worker(e="module"){let t=this.request.path,o=await this.file(Se);this.prog=null,this.request.timeout=null;let r=new Worker(o.content,{type:e});return this.prog&&this.prog.end(t),E(o,()=>r)}};var we=class{constructor(e,t=!1){this.service=e;this.useBLOBs=t;{let o=Vn("input[name=__RequestVerificationToken]");o&&this.service.setRequestVerificationToken(o.value)}}clearCache(){return this.service.clearCache()}evict(e,t){return this.service.evict(new URL(e,t||location.href).href)}request(e,t,o){return new tt(this.service,e,new URL(t,o||location.href),this.useBLOBs)}head(e,t){return this.request("HEAD",e,t)}options(e,t){return this.request("OPTIONS",e,t)}get(e,t){return this.request("GET",e,t)}post(e,t){return this.request("POST",e,t)}put(e,t){return this.request("PUT",e,t)}patch(e,t){return this.request("PATCH",e,t)}delete(e,t){return this.request("DELETE",e,t)}async assets(e,t,...o){_(o)&&(o=[]),o.unshift(t);let r;Fn(e)?o.unshift(e):d(e)&&(r=e),o=o.filter(d);let i=await Promise.all(o.map(a=>a.getSize(this))),s=new Map(i);await Xn(r,o.map(a=>[s.get(a),p=>a.fetch(this,p)]))}};var Ve=class{constructor(e){this.impl=e;this.defaultPostHeaders=new Map}setRequestVerificationToken(e){this.defaultPostHeaders.set("RequestVerificationToken",e)}clearCache(){return this.impl.clearCache()}evict(e){return this.impl.evict(e)}sendNothingGetNothing(e){return this.impl.sendNothingGetNothing(e)}sendNothingGetBlob(e,t){return this.impl.sendNothingGetSomething("blob",e,t)}sendObjectGetBlob(e,t){return this.impl.sendSomethingGetSomething("blob",e,this.defaultPostHeaders,t)}sendNothingGetBuffer(e,t){return this.impl.sendNothingGetSomething("arraybuffer",e,t)}sendObjectGetBuffer(e,t){return this.impl.sendSomethingGetSomething("arraybuffer",e,this.defaultPostHeaders,t)}sendNothingGetText(e,t){return this.impl.sendNothingGetSomething("text",e,t)}sendObjectGetText(e,t){return this.impl.sendSomethingGetSomething("text",e,this.defaultPostHeaders,t)}sendNothingGetObject(e,t){return this.impl.sendNothingGetSomething("json",e,t)}sendObjectGetObject(e,t){return this.impl.sendSomethingGetSomething("json",e,this.defaultPostHeaders,t)}sendObjectGetNothing(e,t){return this.impl.sendSomethingGetSomething("",e,this.defaultPostHeaders,t)}drawImageToCanvas(e,t,o){return this.impl.drawImageToCanvas(e,t,o)}async sendNothingGetFile(e,t){return E(await this.sendNothingGetBlob(e,t),URL.createObjectURL)}async sendObjectGetFile(e,t){return E(await this.sendObjectGetBlob(e,t),URL.createObjectURL)}async sendNothingGetXml(e,t){return E(await this.impl.sendNothingGetSomething("document",e,t),o=>o.documentElement)}async sendObjectGetXml(e,t){return E(await this.impl.sendSomethingGetSomething("document",e,this.defaultPostHeaders,t),o=>o.documentElement)}async sendNothingGetImageBitmap(e,t){return E(await this.sendNothingGetBlob(e,t),createImageBitmap)}async sendObjectGetImageBitmap(e,t){return E(await this.sendObjectGetBlob(e,t),createImageBitmap)}};function Un(n,e,t){return new Map(n.map(o=>[e(o),t(o)]))}function qn(n,e){return Un(n,e,be)}var ge=class{constructor(e){this.items=new Map;this.defaultItems=new Array;if(d(e))for(let[t,o]of e)this.add(t,o)}add(e,...t){for(let o of t)if(_(e))this.defaultItems.push(o);else{let r=this.items.get(e);_(r)&&this.items.set(e,r=[]),r.push(o)}return this}entries(){return this.items.entries()}[Symbol.iterator](){return this.entries()}keys(){return this.items.keys()}*values(){for(let e of this.defaultItems)yield e;for(let e of this.items.values())for(let t of e)yield t}has(e){return d(e)?this.items.has(e):this.defaultItems.length>0}get(e){return _(e)?this.defaultItems:this.items.get(e)||[]}count(e){if(_(e))return this.defaultItems.length;let t=this.get(e);return d(t)?t.length:0}get size(){let e=this.defaultItems.length;for(let t of this.items.values())e+=t.length;return e}delete(e){return _(e)?K(this.defaultItems).length>0:this.items.delete(e)}remove(e,t){if(_(e))_e(this.defaultItems,t);else{let o=this.items.get(e);d(o)&&(_e(o,t),o.length===0&&this.items.delete(e))}}clear(){this.items.clear(),K(this.defaultItems)}};var Ce=class{constructor(e){this.db=e}static delete(e){let t=indexedDB.deleteDatabase(e),o=w(t,"success","error","blocked");return B(o)}static async open(e,...t){let o=qn(t,S=>S.name),r=new oe(t.filter(S=>d(S.indexes)).flatMap(S=>S.indexes.map(k=>[S.name,k.name,k]))),i=new Array,s=new Array,a=new Array,p=new ge,c=new ge,l=null,u=indexedDB.open(e);if(await B(w(u,"success","error","blocked"))){let S=u.result;l=S.version;let k=new Array;for(let P of S.objectStoreNames)o.has(P)||s.push(P);for(let P of o.keys())S.objectStoreNames.contains(P)?k.push(P):i.push(P);if(k.length>0){let P=S.transaction(k),R=w(P,"complete","error","abort"),U=B(R);for(let A of k){let ee=P.objectStore(A),Ne=o.get(A);d(Ne.options)&&ee.keyPath!==Ne.options.keyPath&&(s.push(A),i.push(A));for(let G of ee.indexNames)r.has(A,G)||(a.indexOf(A)===-1&&a.push(A),c.add(A,G));if(r.has(A))for(let G of r.get(A).keys())if(!ee.indexNames.contains(G))a.indexOf(A)===-1&&a.push(A),p.add(A,G);else{let me=r.get(A,G),ue=ee.index(G);(y(me.keyPath)!==y(ue.keyPath)||y(me.keyPath)&&y(ue.keyPath)&&me.keyPath!==ue.keyPath||He(me.keyPath)&&He(ue.keyPath)&&sn(me.keyPath,ue.keyPath))&&(a.indexOf(A)===-1&&a.push(A),c.add(A,G),p.add(A,G))}}P.commit(),await U}M(S)}else{l=0,i.push(...o.keys());for(let S of t)if(d(S.indexes))for(let k of S.indexes)p.add(S.name,k.name)}(i.length>0||s.length>0||p.size>0||c.size>0)&&++l;let m=new L,x=d(l)?indexedDB.open(e,l):indexedDB.open(e),V=w(x,"success","error","blocked"),v=B(m),X=B(V),Q=m.resolver(!1);if(x.addEventListener("success",Q),x.addEventListener("upgradeneeded",()=>{let S=w(x.transaction,"complete","error","abort"),k=x.result;for(let R of s)k.deleteObjectStore(R);let P=new Map;for(let R of i){let U=o.get(R),A=k.createObjectStore(R,U.options);P.set(R,A)}for(let R of a){let U=x.transaction.objectStore(R);P.set(R,U)}for(let[R,U]of P){for(let A of c.get(R))U.deleteIndex(A);for(let A of p.get(R)){let ee=r.get(R,A);U.createIndex(A,ee.keyPath,ee.options)}}B(S).then(m.resolve).catch(m.reject).finally(()=>x.removeEventListener("success",Q))}),!await v)throw m.error;if(!await X)throw V.error;return new Ce(x.result)}dispose(){M(this.db)}get name(){return this.db.name}get version(){return this.db.version}get storeNames(){return Array.from(this.db.objectStoreNames)}getStore(e){return new qt(this.db,e)}},qt=class{constructor(e,t){this.db=e;this.storeName=t}async request(e,t){let o=this.db.transaction(this.storeName,t),r=w(o,"complete","error"),i=o.objectStore(this.storeName),s=e(i),a=w(s,"success","error");if(!await B(a))throw o.abort(),a.error;if(o.commit(),!await B(r))throw r.error;return s.result}add(e,t){return this.request(o=>o.add(e,t),"readwrite")}clear(){return this.request(e=>e.clear(),"readwrite")}getCount(e){return this.request(t=>t.count(e),"readonly")}async has(e){return await this.getCount(e)>0}delete(e){return this.request(t=>t.delete(e),"readwrite")}get(e){return this.request(t=>t.get(e),"readonly")}getAll(){return this.request(e=>e.getAll(),"readonly")}getAllKeys(){return this.request(e=>e.getAllKeys(),"readonly")}getKey(e){return this.request(t=>t.getKey(e),"readonly")}openCursor(e,t){return this.request(o=>o.openCursor(e,t),"readonly")}openKeyCursor(e,t){return this.request(o=>o.openKeyCursor(e,t),"readonly")}put(e,t){return this.request(o=>o.put(e,t),"readwrite")}};function Kn(n,...e){for(let t of e)if(d(t))for(let[o,r]of t)n.set(o,r);return n}var Kt=class extends L{constructor(t){super(!1);this.milliseconds=t;this._timer=null}start(){super.start(),this._timer=setTimeout(()=>{this._timer=null,this.resolve()},this.milliseconds)}reset(){super.reset(),d(this._timer)&&(clearTimeout(this._timer),this._timer=null)}};function Jn(n){let e=new Kt(n);return e.start(),e}function nt(n,e){return async()=>{let t=null,o=500;for(let r=0;r<=n;++r)try{return r>0&&(await Jn(o),o*=2),await e()}catch(i){t=i}throw t}}function rr(n){return y(n)||on(n)||n instanceof Blob||n instanceof FormData||rn(n)||"Document"in globalThis&&n instanceof Document}function ot(n,e,t,o,r,i){let s=!i;i&&i.then(()=>s=!0);let a=!1,p=r,c=new L;t.addEventListener("loadstart",()=>{s&&!a&&o&&o.start(n)}),t.addEventListener("progress",u=>{if(s&&!a){let m=u;o&&o.report(m.loaded,Math.max(m.loaded,m.total),n),m.loaded===m.total&&(p=!0,a&&c.resolve())}}),t.addEventListener("load",()=>{s&&!a&&(o&&o.end(n),a=!0,p&&c.resolve())});let l=u=>()=>{s&&c.reject(`${u} (${e.status})`)};return t.addEventListener("error",l("error")),t.addEventListener("abort",l("abort")),t.addEventListener("timeout",l("timeout")),c}function Jt(n,e,t,o,r,i){if(n.open(e,t),n.responseType="blob",n.timeout=o,r)for(let[s,a]of r)n.setRequestHeader(s,a);d(i)?n.send(i):n.send()}function rt(n,e,t){if(!n.has(e))return null;let o=n.get(e);try{let r=t(o);return n.delete(e),r}catch(r){console.warn(e,r)}return null}var ir=/filename=\"(.+)\"(;|$)/,sr="Juniper:Fetcher:Cache",Te=class{constructor(){this.cache=null;this.store=null;this.tasks=new oe;this.cacheReady=this.openCache()}async drawImageToCanvas(e,t,o){let r=await this.sendNothingGetSomething("blob",e,o),i=r.content;return $(await createImageBitmap(i,{imageOrientation:"from-image"}),s=>(t.width=s.width,t.height=s.height,t.getContext("2d").drawImage(s,0,0),E(r)))}async openCache(){let e={keyPath:"requestPath"};this.cache=await Ce.open(sr,{name:"files",options:e}),this.store=await this.cache.getStore("files")}async clearCache(){await this.cacheReady,await this.store.clear()}async evict(e){await this.cacheReady,this.store.has(e)&&await this.store.delete(e)}async readResponseHeaders(e,t){let o=t.getAllResponseHeaders().split(/[\r\n]+/).map(m=>m.trim()).filter(m=>m.length>0).map(m=>{let x=m.split(": "),V=x.shift().toLowerCase(),v=x.join(": ");return[V,v]}),r=new ge(o),i=Array.from(r.keys()).map(m=>[m,r.get(m).join(", ")]),s=new Map(i),a=rt(s,"content-type",be),p=rt(s,"content-length",parseFloat),c=rt(s,"date",m=>new Date(m)),l=rt(s,"content-disposition",m=>{if(d(m)){let x=m.match(ir);if(d(x))return x[1]}return null});return{status:t.status,requestPath:e,responsePath:t.responseURL,content:void 0,contentType:a,contentLength:p,fileName:l,date:c,headers:s}}async readResponse(e,t){let{responsePath:o,status:r,contentType:i,contentLength:s,fileName:a,date:p,headers:c}=await this.readResponseHeaders(e,t),l={requestPath:e,responsePath:o,status:r,contentType:i,contentLength:s,fileName:a,date:p,headers:c,content:t.response};return d(l.content)&&(l.contentType=l.contentType||l.content.type,l.contentLength=l.contentLength||l.content.size),l}async decodeContent(e,t){return E(t,async o=>{if(e==="")return null;if(_(t.contentType)){let r=Array.from(t.headers.entries()).map(i=>i.join(": ")).join(`
  `);throw new Error(`No content type found in headers: 
  `+r)}else{if(e==="blob")return o;if(e==="arraybuffer")return await o.arrayBuffer();if(e==="json"){let r=await o.text();return r.length>0?JSON.parse(r):null}else if(e==="document"){let r=new DOMParser;if(t.contentType==="application/xhtml+xml"||t.contentType==="text/html"||t.contentType==="application/xml"||t.contentType==="image/svg+xml"||t.contentType==="text/xml")return r.parseFromString(await o.text(),t.contentType);throw new Error("Couldn't parse document")}else{if(e==="text")return await o.text();O(e)}}})}async withCachedTask(e,t){return e.method!=="GET"&&e.method!=="HEAD"&&e.method!=="OPTIONS"?await t():(this.tasks.has(e.method,e.path)||this.tasks.add(e.method,e.path,t().finally(()=>this.tasks.delete(e.method,e.path))),this.tasks.get(e.method,e.path))}sendNothingGetNothing(e){return this.withCachedTask(e,nt(e.retryCount,async()=>{let t=new XMLHttpRequest,o=ot(`requesting: ${e.path}`,t,t,null,!0);return Jt(t,e.method,e.path,e.timeout,e.headers),await o,await this.readResponseHeaders(e.path,t)}))}sendNothingGetSomething(e,t,o){return this.withCachedTask(t,nt(t.retryCount,async()=>{let r=null,i=t.useCache&&t.method==="GET";i&&(d(o)&&o.start(),await this.cacheReady,r=await this.store.get(t.path));let s=_(r);if(s){let p=new XMLHttpRequest,c=ot(`requesting: ${t.path}`,p,p,o,!0);Jt(p,t.method,t.path,t.timeout,t.headers),await c,r=await this.readResponse(t.path,p),i&&await this.store.add(r)}let a=await this.decodeContent(e,r);return s&&d(o)&&o.end(),a}))}sendSomethingGetSomething(e,t,o,r){let i=null,s=Kn(new Map,o,t.headers);if(t.body instanceof FormData&&d(s)){let m=new Array;for(let x of s.keys())x.toLowerCase()==="content-type"&&m.push(x);for(let x of m)s.delete(x)}rr(t.body)&&!y(t.body)?i=t.body:d(t.body)&&(i=JSON.stringify(t.body));let a=d(i),p=Rn(r,a?2:1),[c,l]=p,u=async()=>{let m=new XMLHttpRequest,x=a?ot("uploading",m,m.upload,c,!1):Promise.resolve(),V=ot("saving",m,m,l,!0,x);Jt(m,t.method,t.path,t.timeout,s,i),await x,await V;let v=await this.readResponse(t.path,m);return await this.decodeContent(e,v)};return nt(t.retryCount,u)()}};var it=class extends I{constructor(t){super("testcasemessage");this.message=t}};var st=class extends I{constructor(){super("testcasesuccess")}};var T=class extends D{constructor(){super(...arguments);this.defaultError=.001}setup(){}teardown(){}message(t){t=t||"N/A",this.dispatchEvent(new it(t))}success(){return this.dispatchEvent(new st),!0}fail(t){return t=t||"Fail",this.dispatchEvent(new Ae(t)),!1}areSame(t,o,r){return this.twoValueTest(t,"==",o,(i,s)=>i==s,r)}areExact(t,o,r){return this.twoValueTest(t,"===",o,(i,s)=>i===s,r)}areApprox(t,o,r,i){i=te(i)&&i||te(r)&&r||this.defaultError;let s=Math.abs(t-o),a=y(r)&&r||"",p=`(${s}) ${a}`;return this.twoValueTest(t,"~==",o,(c,l)=>Math.abs(c-l)<=i,p)}isNull(t,o){return this.areExact(t,null,o)}isNotNull(t,o){return this.isNotEqualTo(t,null,o)}isUndefined(t,o){return this.areExact(t,void 0,o)}isNotUndefined(t,o){return this.isNotEqualTo(t,void 0,o)}isTrue(t,o){return this.areExact(t,!0,o)}isTruthy(t,o){return this.isTrue(!!t,o)}isFalse(t,o){return this.areExact(t,!1,o)}isFalsey(t,o){return this.isFalse(!!t,o)}isBoolean(t,o){return this.areExact(t===!0||t===!1,!0,o)}hasValue(t,o){o=o||t;let r=`${o} is a value`,i=`${o} is not a value`,s=t!=null;return this.isTrue(s,s?r:i)}isEmpty(t,o){return o=o||`${t} is empty`,this.areExact(t.length,0,o)}isNotEqualTo(t,o,r){return this.twoValueTest(t,"!==",o,(i,s)=>i!==s,r)}areDifferent(t,o,r){return this.twoValueTest(t,"!=",o,(i,s)=>i!=s,r)}isLessThan(t,o,r){return this.twoValueTest(t,"<",o,(i,s)=>i<s,r)}isLessThanEqual(t,o,r){return this.twoValueTest(t,"<=",o,(i,s)=>i<=s,r)}isGreaterThan(t,o,r){return this.twoValueTest(t,">",o,(i,s)=>i>s,r)}isGreaterThanEqual(t,o,r){return this.twoValueTest(t,">=",o,(i,s)=>i>=s,r)}throws(t,o){return this.throwTest(t,!0,o)}doesNotThrow(t,o){return this.throwTest(t,!1,o)}async resolves(t){await this.doesNotThrow(()=>t)}async rejects(t){await this.throws(()=>t)}twoValueTest(t,o,r,i,s){return i(t,r)?this.success():this.fail(`${s||""} [Actual: ${t}] ${o} [Expected: ${r}]`)}async throwTest(t,o,r){let i=!1;try{await t()}catch(l){o||console.error(l),i=!0}let s=i===o,a=s?"Success!":"Fail!",p=o?"throw":"not throw",c=`Expected function to ${p} -> ${a}`;return r=(r&&r+". "||"")+c,s?this.success():this.fail(r)}};function $n(n){return new URL(URL.createObjectURL(n))}var at=class extends T{async test_Blob(){let e=new we(new Ve(new Te)),t="Hello, world",o=new Blob([t],{type:"text/plain"}),r=$n(o),i=await e.get(r).text();this.areExact(i.contentType,Qe.value),this.areExact(i.content,t)}};var Yn=[at];function pt(n,e){for(let t in n){let o=n[t];o instanceof Function&&(o=o.bind(n)),e[t]=o}}var Ee=class{constructor(e,t,o){this.source=e;this.key=t;this.value=o;this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.source[this.key]=this.value)}};function Zn(n,e,t,o,r=null){if(e!==n[t])throw new Error(`The provided class constructor is not the same object as the field "${t}" in the provided object.`);return n[t]=function(...i){return o.apply(r,i),new e(...i)},pt(e,n[t]),new Ee(n,t,e)}function Qn(n,e,t,o,r=null){if(e!=n[t])throw new Error(`The provided method is not the same object as the field "${t}" in the provided object.`);return n[t]=function(...i){return o.apply(r,i),e.apply(n,i)},pt(e,n[t]),new Ee(n,t,e)}var ct=class extends T{test_Method(){let e=console.log,t=[];$(Qn(console,console.log,"log",t.push.bind(t)),()=>{this.areDifferent(console.log,e),console.log("Hello","world"),this.areExact("Hello",t[0]),this.areExact("world",t[1])}),this.areExact(console.log,e)}async test_Class(){let e=new we(new Ve(new Te)),t=window.URL,o=new Array,r=new Blob(["asdf"],{type:"text/plain"}),i=URL.createObjectURL(r);await ce(Zn(window,URL,"URL",o.push.bind(o)),async()=>{this.areDifferent(window.URL,t);let s=URL.createObjectURL(r),a=new URL("images","https://www.seanmcbeth.com/");this.areExact(a.href,"https://www.seanmcbeth.com/images"),this.areExact("images",o[0]),this.areExact("https://www.seanmcbeth.com/",o[1]);let p=await e.get(i).text().then(et),c=await e.get(s).text().then(et);this.areExact(c,p)}),this.areSame(window.URL,t)}};function ar(n){return n[0]}function pr(n){return n.shift()}function cr(n){return n[n.length-1]}function lr(n){return n.pop()}var lt=class{constructor(e){this.value=e;this._forward=new Array;this._reverse=new Array}connectSorted(e,t){d(t)?(Ct(this._forward,e,o=>t(o.value)),Ct(e._reverse,this,o=>t(o.value))):this.connectTo(e)}connectTo(e){this.connectAt(e,this._forward.length)}connectAt(e,t){wt(this._forward,e,t),e._reverse.push(this)}disconnectFrom(e){_e(this._forward,e),_e(e._reverse,this)}isConnectedTo(e){return this._forward.indexOf(e)>=0||this._reverse.indexOf(e)>=0}flatten(){let e=new Set,t=[this];for(;t.length>0;){let o=t.shift();d(o)&&!e.has(o)&&(e.add(o),t.push(...o._forward))}return Array.from(e)}*traverse(e){let t=new Set,o=[this],r=e?ar:cr,i=e?pr:lr;for(;o.length>0;){let s=r(o);t.has(s)?e||(i(o),yield s):(t.add(s),e&&(i(o),yield s),s._forward.length>0&&o.push(...s._forward))}}breadthFirst(){return this.traverse(!0)}depthFirst(){return this.traverse(!1)}search(e,t=!0){for(let o of this.traverse(t))if(e(o))return o;return null}*searchAll(e,t=!0){for(let o of this.traverse(t))e(o)&&(yield o)}find(e,t=!0){return this.search(o=>o.value===e,t)}findAll(e,t=!0){return this.searchAll(o=>o.value===e,t)}contains(e,t=!0){for(let o of this.traverse(t))if(o===e)return!0;return!1}containsValue(e,t=!0){for(let o of this.traverse(t))if(o.value===e)return!0;return!1}get _isEntryPoint(){return this._reverse.length===0}get _isExitPoint(){return this._forward.length===0}get isDisconnected(){return this._isEntryPoint&&this._isExitPoint}get isConnected(){return!this._isExitPoint||!this._isEntryPoint}get isTerminus(){return this._isEntryPoint||this._isExitPoint}get isInternal(){return!this._isEntryPoint&&!this._isExitPoint}};var Y=class extends lt{get depth(){let e=0,t=this.parent;for(;d(t);)++e,t=t.parent;return e}removeFromParent(){for(;this.parent;)this.parent.disconnectFrom(this)}connectTo(e){e.removeFromParent(),super.connectTo(e)}connectAt(e,t){e.removeFromParent(),super.connectAt(e,t)}connectSorted(e,t){e.removeFromParent(),super.connectSorted(e,t)}get parent(){return this._reverse.length===0?null:this._reverse[0]}get children(){return this._forward}get isRoot(){return this._isEntryPoint}get isChild(){return!this._isEntryPoint}get isLeaf(){return this._isExitPoint}get hasChildren(){return!this._isExitPoint}};var dt=class extends T{setup(){this.tree=new Y(0);let t=new Y(1),o=new Y(2);this.tree.connectTo(t),this.tree.connectTo(o),t.connectTo(new Y(3)),t.connectTo(new Y(4)),o.connectTo(new Y(5)),o.connectTo(new Y(6))}test_BreadthFirst(){let t=Array.from(this.tree.breadthFirst()).map(o=>o.value);this.areExact(t[0],0),this.areExact(t[1],1),this.areExact(t[2],2),this.areExact(t[3],3),this.areExact(t[4],4),this.areExact(t[5],5),this.areExact(t[6],6)}test_DepthFirst(){let t=Array.from(this.tree.depthFirst()).map(o=>o.value);this.areExact(t[0],6),this.areExact(t[1],5),this.areExact(t[2],2),this.areExact(t[3],4),this.areExact(t[4],3),this.areExact(t[5],1),this.areExact(t[6],0)}};var eo=[dt];var Be=class extends I{constructor(t,o){super(t);this.value=o}},mt=class extends D{triggerGood(){this.dispatchEvent(new I("good"))}triggerWithValue(e){this.dispatchEvent(new Be("withValue",e))}triggerBad(){this.dispatchEvent(new I("bad"))}},ut=class extends T{setup(){this.rig=new mt}async test_Good(){let t=w(this.rig,"good");await this.doesNotThrow(async()=>{this.rig.triggerGood();let o=await t;this.areExact(o.type,"good")})}async test_WithValue(){let t=w(this.rig,"withValue"),o=13;await this.doesNotThrow(async()=>{this.rig.triggerWithValue(o);let r=await t;this.areExact(r.type,"withValue"),this.areExact(r instanceof Be&&r.value,o)})}async test_Timeout(){await this.rejects(w(this.rig,"good",250))}async test_NoTimeout(){let o=w(this.rig,"good",250);await this.doesNotThrow(async()=>{this.rig.triggerGood();let r=await o;this.areExact(r.type,"good")})}async test_Bad(){let t=w(this.rig,"good","bad");this.rig.triggerBad(),await this.rejects(t)}},xt=class extends T{setup(){this.rig=new mt}async test_Good(){let t=w(this.rig,"good");await this.doesNotThrow(async()=>{this.rig.triggerGood(),this.isTrue(await B(t))})}async test_WithValue(){let t=w(this.rig,"withValue"),o=13;await this.doesNotThrow(async()=>{this.rig.triggerWithValue(o),this.isTrue(await B(t)),this.areExact(t.result.type,"withValue"),this.areExact(t.result instanceof Be&&t.result.value,o)})}async test_Timeout(){let o=w(this.rig,"good",250);await this.doesNotThrow(async()=>{this.isFalse(await B(o))})}async test_NoTimeout(){let o=w(this.rig,"good",250);await this.doesNotThrow(async()=>{this.rig.triggerGood(),this.isTrue(await B(o)),this.areExact(o.result.type,"good")})}async test_Bad(){let t=w(this.rig,"good","bad");await this.doesNotThrow(async()=>{this.rig.triggerBad(),this.isFalse(await B(t))})}};var ft=class extends T{async test_Basic(){let e=new L;e.resolve(!0);let t=await e;this.isTrue(t)}async test_NoDoubleResolve(){let e=new L,t=0;e.then(()=>++t),e.resolve(),await e,e.resolve(),await e,this.areExact(t,1)}async test_NoDoubleResolveAfterReset(){let e=new L,t=0;e.then(()=>++t),e.resolve(),await e,e.reset(),e.resolve(),await e,this.areExact(t,1)}async test_ThenableAfterAfterReset(){let e=new L,t=0;e.then(()=>++t),e.resolve(),await e,e.reset(),e.then(()=>++t),e.resolve(),await e,this.areExact(t,2)}};var Pe=class extends D{triggerBubbles(){let e=new I("test",{bubbles:!0});this.dispatchEvent(e)}triggerNoBubbles(){let e=new I("test",{bubbles:!0});e.cancelBubble=!0,this.dispatchEvent(e)}},_t=class extends T{setup(){}async test_Bubbles(){let e=new Pe,t=new Pe;t.addBubbler(e);let o=w(e,"test",10);t.triggerBubbles(),await this.resolves(o)}async test_CancelBubble(){let e=new Pe,t=new Pe;t.addBubbler(e);let o=w(e,"test",10),r=new I("test");r.cancelBubble=!0,t.triggerNoBubbles(),await this.rejects(o)}};var to=[ut,xt,ft,_t];var ve=1e-6,Z=typeof Float32Array<"u"?Float32Array:Array,De=Math.random;var id=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var z={};Qt(z,{add:()=>fr,angle:()=>Br,bezier:()=>Pr,ceil:()=>_r,clone:()=>dr,copy:()=>ur,create:()=>oo,cross:()=>Cr,dist:()=>Wr,distance:()=>po,div:()=>Gr,divide:()=>ao,dot:()=>mo,equals:()=>Nr,exactEquals:()=>Fr,floor:()=>hr,forEach:()=>Jr,fromValues:()=>mr,hermite:()=>Er,inverse:()=>wr,len:()=>qr,length:()=>ro,lerp:()=>Tr,max:()=>vr,min:()=>gr,mul:()=>zr,multiply:()=>so,negate:()=>yr,normalize:()=>Vr,random:()=>Mr,rotateX:()=>Rr,rotateY:()=>Xr,rotateZ:()=>Or,round:()=>br,scale:()=>Ar,scaleAndAdd:()=>Sr,set:()=>xr,sqrDist:()=>Ur,sqrLen:()=>Kr,squaredDistance:()=>co,squaredLength:()=>lo,str:()=>jr,sub:()=>Hr,subtract:()=>io,transformMat3:()=>kr,transformMat4:()=>Ir,transformQuat:()=>Lr,zero:()=>Dr});function oo(){var n=new Z(3);return Z!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function dr(n){var e=new Z(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function ro(n){var e=n[0],t=n[1],o=n[2];return Math.hypot(e,t,o)}function mr(n,e,t){var o=new Z(3);return o[0]=n,o[1]=e,o[2]=t,o}function ur(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function xr(n,e,t,o){return n[0]=e,n[1]=t,n[2]=o,n}function fr(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function io(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function so(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n}function ao(n,e,t){return n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n}function _r(n,e){return n[0]=Math.ceil(e[0]),n[1]=Math.ceil(e[1]),n[2]=Math.ceil(e[2]),n}function hr(n,e){return n[0]=Math.floor(e[0]),n[1]=Math.floor(e[1]),n[2]=Math.floor(e[2]),n}function gr(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n}function vr(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n}function br(n,e){return n[0]=Math.round(e[0]),n[1]=Math.round(e[1]),n[2]=Math.round(e[2]),n}function Ar(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function Sr(n,e,t,o){return n[0]=e[0]+t[0]*o,n[1]=e[1]+t[1]*o,n[2]=e[2]+t[2]*o,n}function po(n,e){var t=e[0]-n[0],o=e[1]-n[1],r=e[2]-n[2];return Math.hypot(t,o,r)}function co(n,e){var t=e[0]-n[0],o=e[1]-n[1],r=e[2]-n[2];return t*t+o*o+r*r}function lo(n){var e=n[0],t=n[1],o=n[2];return e*e+t*t+o*o}function yr(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}function wr(n,e){return n[0]=1/e[0],n[1]=1/e[1],n[2]=1/e[2],n}function Vr(n,e){var t=e[0],o=e[1],r=e[2],i=t*t+o*o+r*r;return i>0&&(i=1/Math.sqrt(i)),n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n}function mo(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function Cr(n,e,t){var o=e[0],r=e[1],i=e[2],s=t[0],a=t[1],p=t[2];return n[0]=r*p-i*a,n[1]=i*s-o*p,n[2]=o*a-r*s,n}function Tr(n,e,t,o){var r=e[0],i=e[1],s=e[2];return n[0]=r+o*(t[0]-r),n[1]=i+o*(t[1]-i),n[2]=s+o*(t[2]-s),n}function Er(n,e,t,o,r,i){var s=i*i,a=s*(2*i-3)+1,p=s*(i-2)+i,c=s*(i-1),l=s*(3-2*i);return n[0]=e[0]*a+t[0]*p+o[0]*c+r[0]*l,n[1]=e[1]*a+t[1]*p+o[1]*c+r[1]*l,n[2]=e[2]*a+t[2]*p+o[2]*c+r[2]*l,n}function Pr(n,e,t,o,r,i){var s=1-i,a=s*s,p=i*i,c=a*s,l=3*i*a,u=3*p*s,m=p*i;return n[0]=e[0]*c+t[0]*l+o[0]*u+r[0]*m,n[1]=e[1]*c+t[1]*l+o[1]*u+r[1]*m,n[2]=e[2]*c+t[2]*l+o[2]*u+r[2]*m,n}function Mr(n,e){e=e||1;var t=De()*2*Math.PI,o=De()*2-1,r=Math.sqrt(1-o*o)*e;return n[0]=Math.cos(t)*r,n[1]=Math.sin(t)*r,n[2]=o*e,n}function Ir(n,e,t){var o=e[0],r=e[1],i=e[2],s=t[3]*o+t[7]*r+t[11]*i+t[15];return s=s||1,n[0]=(t[0]*o+t[4]*r+t[8]*i+t[12])/s,n[1]=(t[1]*o+t[5]*r+t[9]*i+t[13])/s,n[2]=(t[2]*o+t[6]*r+t[10]*i+t[14])/s,n}function kr(n,e,t){var o=e[0],r=e[1],i=e[2];return n[0]=o*t[0]+r*t[3]+i*t[6],n[1]=o*t[1]+r*t[4]+i*t[7],n[2]=o*t[2]+r*t[5]+i*t[8],n}function Lr(n,e,t){var o=t[0],r=t[1],i=t[2],s=t[3],a=e[0],p=e[1],c=e[2],l=r*c-i*p,u=i*a-o*c,m=o*p-r*a,x=r*m-i*u,V=i*l-o*m,v=o*u-r*l,X=s*2;return l*=X,u*=X,m*=X,x*=2,V*=2,v*=2,n[0]=a+l+x,n[1]=p+u+V,n[2]=c+m+v,n}function Rr(n,e,t,o){var r=[],i=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],i[0]=r[0],i[1]=r[1]*Math.cos(o)-r[2]*Math.sin(o),i[2]=r[1]*Math.sin(o)+r[2]*Math.cos(o),n[0]=i[0]+t[0],n[1]=i[1]+t[1],n[2]=i[2]+t[2],n}function Xr(n,e,t,o){var r=[],i=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],i[0]=r[2]*Math.sin(o)+r[0]*Math.cos(o),i[1]=r[1],i[2]=r[2]*Math.cos(o)-r[0]*Math.sin(o),n[0]=i[0]+t[0],n[1]=i[1]+t[1],n[2]=i[2]+t[2],n}function Or(n,e,t,o){var r=[],i=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],i[0]=r[0]*Math.cos(o)-r[1]*Math.sin(o),i[1]=r[0]*Math.sin(o)+r[1]*Math.cos(o),i[2]=r[2],n[0]=i[0]+t[0],n[1]=i[1]+t[1],n[2]=i[2]+t[2],n}function Br(n,e){var t=n[0],o=n[1],r=n[2],i=e[0],s=e[1],a=e[2],p=Math.sqrt(t*t+o*o+r*r),c=Math.sqrt(i*i+s*s+a*a),l=p*c,u=l&&mo(n,e)/l;return Math.acos(Math.min(Math.max(u,-1),1))}function Dr(n){return n[0]=0,n[1]=0,n[2]=0,n}function jr(n){return"vec3("+n[0]+", "+n[1]+", "+n[2]+")"}function Fr(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]}function Nr(n,e){var t=n[0],o=n[1],r=n[2],i=e[0],s=e[1],a=e[2];return Math.abs(t-i)<=ve*Math.max(1,Math.abs(t),Math.abs(i))&&Math.abs(o-s)<=ve*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(r-a)<=ve*Math.max(1,Math.abs(r),Math.abs(a))}var Hr=io,zr=so,Gr=ao,Wr=po,Ur=co,qr=ro,Kr=lo,Jr=function(){var n=oo();return function(e,t,o,r,i,s){var a,p;for(t||(t=3),o||(o=0),r?p=Math.min(r*t+o,e.length):p=e.length,a=o;a<p;a+=t)n[0]=e[a],n[1]=e[a+1],n[2]=e[a+2],i(n,n,s),e[a]=n[0],e[a+1]=n[1],e[a+2]=n[2];return e}}();var de={};Qt(de,{add:()=>ei,angle:()=>bi,ceil:()=>ti,clone:()=>$r,copy:()=>Zr,create:()=>uo,cross:()=>mi,dist:()=>Pi,distance:()=>ho,div:()=>Ei,divide:()=>_o,dot:()=>di,equals:()=>wi,exactEquals:()=>yi,floor:()=>ni,forEach:()=>ki,fromValues:()=>Yr,inverse:()=>ci,len:()=>Vi,length:()=>vo,lerp:()=>ui,max:()=>ri,min:()=>oi,mul:()=>Ti,multiply:()=>fo,negate:()=>pi,normalize:()=>li,random:()=>xi,rotate:()=>vi,round:()=>ii,scale:()=>si,scaleAndAdd:()=>ai,set:()=>Qr,sqrDist:()=>Mi,sqrLen:()=>Ii,squaredDistance:()=>go,squaredLength:()=>bo,str:()=>Si,sub:()=>Ci,subtract:()=>xo,transformMat2:()=>fi,transformMat2d:()=>_i,transformMat3:()=>hi,transformMat4:()=>gi,zero:()=>Ai});function uo(){var n=new Z(2);return Z!=Float32Array&&(n[0]=0,n[1]=0),n}function $r(n){var e=new Z(2);return e[0]=n[0],e[1]=n[1],e}function Yr(n,e){var t=new Z(2);return t[0]=n,t[1]=e,t}function Zr(n,e){return n[0]=e[0],n[1]=e[1],n}function Qr(n,e,t){return n[0]=e,n[1]=t,n}function ei(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function xo(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n}function fo(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n}function _o(n,e,t){return n[0]=e[0]/t[0],n[1]=e[1]/t[1],n}function ti(n,e){return n[0]=Math.ceil(e[0]),n[1]=Math.ceil(e[1]),n}function ni(n,e){return n[0]=Math.floor(e[0]),n[1]=Math.floor(e[1]),n}function oi(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n}function ri(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n}function ii(n,e){return n[0]=Math.round(e[0]),n[1]=Math.round(e[1]),n}function si(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n}function ai(n,e,t,o){return n[0]=e[0]+t[0]*o,n[1]=e[1]+t[1]*o,n}function ho(n,e){var t=e[0]-n[0],o=e[1]-n[1];return Math.hypot(t,o)}function go(n,e){var t=e[0]-n[0],o=e[1]-n[1];return t*t+o*o}function vo(n){var e=n[0],t=n[1];return Math.hypot(e,t)}function bo(n){var e=n[0],t=n[1];return e*e+t*t}function pi(n,e){return n[0]=-e[0],n[1]=-e[1],n}function ci(n,e){return n[0]=1/e[0],n[1]=1/e[1],n}function li(n,e){var t=e[0],o=e[1],r=t*t+o*o;return r>0&&(r=1/Math.sqrt(r)),n[0]=e[0]*r,n[1]=e[1]*r,n}function di(n,e){return n[0]*e[0]+n[1]*e[1]}function mi(n,e,t){var o=e[0]*t[1]-e[1]*t[0];return n[0]=n[1]=0,n[2]=o,n}function ui(n,e,t,o){var r=e[0],i=e[1];return n[0]=r+o*(t[0]-r),n[1]=i+o*(t[1]-i),n}function xi(n,e){e=e||1;var t=De()*2*Math.PI;return n[0]=Math.cos(t)*e,n[1]=Math.sin(t)*e,n}function fi(n,e,t){var o=e[0],r=e[1];return n[0]=t[0]*o+t[2]*r,n[1]=t[1]*o+t[3]*r,n}function _i(n,e,t){var o=e[0],r=e[1];return n[0]=t[0]*o+t[2]*r+t[4],n[1]=t[1]*o+t[3]*r+t[5],n}function hi(n,e,t){var o=e[0],r=e[1];return n[0]=t[0]*o+t[3]*r+t[6],n[1]=t[1]*o+t[4]*r+t[7],n}function gi(n,e,t){var o=e[0],r=e[1];return n[0]=t[0]*o+t[4]*r+t[12],n[1]=t[1]*o+t[5]*r+t[13],n}function vi(n,e,t,o){var r=e[0]-t[0],i=e[1]-t[1],s=Math.sin(o),a=Math.cos(o);return n[0]=r*a-i*s+t[0],n[1]=r*s+i*a+t[1],n}function bi(n,e){var t=n[0],o=n[1],r=e[0],i=e[1],s=Math.sqrt(t*t+o*o)*Math.sqrt(r*r+i*i),a=s&&(t*r+o*i)/s;return Math.acos(Math.min(Math.max(a,-1),1))}function Ai(n){return n[0]=0,n[1]=0,n}function Si(n){return"vec2("+n[0]+", "+n[1]+")"}function yi(n,e){return n[0]===e[0]&&n[1]===e[1]}function wi(n,e){var t=n[0],o=n[1],r=e[0],i=e[1];return Math.abs(t-r)<=ve*Math.max(1,Math.abs(t),Math.abs(r))&&Math.abs(o-i)<=ve*Math.max(1,Math.abs(o),Math.abs(i))}var Vi=vo,Ci=xo,Ti=fo,Ei=_o,Pi=ho,Mi=go,Ii=bo,ki=function(){var n=uo();return function(e,t,o,r,i,s){var a,p;for(t||(t=2),o||(o=0),r?p=Math.min(r*t+o,e.length):p=e.length,a=o;a<p;a+=t)n[0]=e[a],n[1]=e[a+1],i(n,n,s),e[a]=n[0],e[a+1]=n[1];return e}}();var Ao=Math.PI,So=.5*Ao,yo=2*Ao;var Li=864e13,cd=-Li;function je(n){return n*yo/360}function $t(n){return n*360/yo}var Ri=298.257223563,wo=6378137,Xi=.9996,Oi=5e5,ht=1/Ri,gt=1-ht,h=ht/(2-ht),Bi=wo/(1+h)*(1+h*h/4+h*h*h*h/64),Fe=Math.sqrt(1-gt*gt),N=1-gt*gt,Di=Fe*Fe/(1-Fe*Fe),ji=1-N*(.25+N*(3/64+5*N/256)),Fi=N*(3/8+N*(3/32+45*N/1024)),Ni=N*N*(15/256+N*45/1024),Hi=N*N*N*(35/3072),zi=[h/2-2*h*h/3+37*h*h*h/96,h*h/48+h*h*h/15,17*h*h*h/480],Gi=[2*h-2*h*h/3,7*h*h/3-8*h*h*h/5,56*h*h*h/15],b={FalseNorthing:1e7,equatorialRadius:wo,pointScaleFactor:Xi,E0:Oi,A:Bi,flattening:ht,e:Fe,esq:N,e0sq:Di,alpha1:ji,alpha2:Fi,alpha3:Ni,alpha4:Hi,beta:zi,delta:Gi};var H=class{static centroid(e){let t=new Map;e.forEach(a=>t.set(a.zone,(t.get(a.zone)||0)+1));let o=0,r=0;for(let[a,p]of t)p>r&&(o=a,r=p);let i=1/e.length,s=e.map(a=>a.rezone(o).toVec3()).reduce((a,p)=>z.scaleAndAdd(a,a,p,i),z.create());return new H().fromVec3(s,o).toLatLng().toUTM()}get easting(){return this._easting}get northing(){return this._northing}get altitude(){return this._altitude}get zone(){return this._zone}get hemisphere(){return this.northing>=0?"northern":"southern"}constructor(e,t,o,r){q(e)?(this._easting=e.easting,this._northing=e.northing,this._altitude=e.altitude,this._zone=e.zone):(this._easting=e||0,this._northing=t||0,this._altitude=o||0,this._zone=r||0)}toJSON(){return JSON.stringify({easting:this.easting,northing:this.northing,altitude:this.altitude,zone:this.zone,hemisphere:this.hemisphere})}toString(){return`(${this.easting}, ${this.northing}, ${this.altitude}) zone ${this.zone}`}equals(e){return d(e)&&this.hemisphere==e.hemisphere&&this.easting==e.easting&&this.northing==e.northing&&this.altitude==e.altitude&&this.zone==e.zone}static A(e,t,o){let r=3+6*(o-1)-180;return je(t-r)*e}static getZoneWidthAtLatitude(e){let t=je(e),o=Math.sin(t),r=Math.cos(t),i=o/r,s=b.e*o,a=b.equatorialRadius/Math.sqrt(1-s*s),p=i*i,c=b.e0sq*r*r,l=p*p,u=je(3)*r,m=u*u,x=1-p+c,V=5-18*p+l+72*c-58*b.e0sq,v=x/6+m*V/120,X=1+m*v;return 2*b.pointScaleFactor*a*u*X}fromLatLng(e){let t=je(e.lat),o=Math.sin(t),r=Math.cos(t),i=2*r,s=i*o,a=i*r-1,p=2*a,c=p*s,l=p*a-1,u=c*a+l*s,m=o/r,x=b.e*o,V=b.equatorialRadius/Math.sqrt(1-x*x),v=b.equatorialRadius*(t*b.alpha1-s*b.alpha2+c*b.alpha3-u*b.alpha4),X=1+(e.lng+180)/6|0,Q=H.A(r,e.lng,X),S=Q*Q,k=m*m,P=b.e0sq*r*r,R=k*k,U=1-k+P,A=5-18*k+R+72*P-58*b.e0sq,ee=S*A/120,Ne=U/6+ee,G=1+S*Ne,me=b.pointScaleFactor*V*Q*G+b.E0,ue=5-k+9*P+4*P*P,Xo=61-58*k+R+600*P-330*b.e0sq,Oo=ue/24+S*Xo/720,Bo=.5+S*Oo,Do=v+V*m*S*Bo,jo=b.pointScaleFactor*Do;return this._easting=me,this._northing=jo,this._altitude=e.alt,this._zone=X,this}rezone(e){if(!(1<=e&&e<=60))throw new Error(`Zones must be on the range [1, 60]. Given: ${e}`);if(e!==this.zone){let t=e-this.zone,o=this.toLatLng(),r=H.getZoneWidthAtLatitude(o.lat);return new H(this.easting-r*t,this.northing,this.altitude,e)}else return this}toLatLng(){return new g().fromUTM(this)}toVec2(){let e=de.create();return de.set(e,this.easting,-this.northing),e}fromVec2(e,t){return this._easting=e[0],this._northing=-e[1],this._altitude=0,this._zone=t,this}toVec3(){let e=z.create();return z.set(e,this.easting,this.altitude,-this.northing),e}fromVec3(e,t){return this._easting=e[0],this._altitude=e[1],this._northing=-e[2],this._zone=t,this}copy(e){return this._easting=e.easting,this._northing=e.northing,this._altitude=e.altitude,this._zone=e.zone,this}clone(){return new H(this)}};var g=class{static centroid(e){let t=1/e.length,o=e.map(r=>r.toVec3()).reduce((r,i)=>z.scaleAndAdd(r,r,i,t),z.create());return new g().fromVec3(o)}get alt(){return this._alt}get lat(){return this._lat}get lng(){return this._lng}constructor(e,t,o){q(e)?(this._lat=e.lat,this._lng=e.lng,this._alt=e.alt):(this._lat=e||0,this._lng=t||0,this._alt=o)}toJSON(){return JSON.stringify({lat:this.lat,lng:this.lng,alt:this.alt})}static parseDMS(e){let t=e.split(" ");if(t.length==3){let o=t[0],r=parseInt(t[1],10),i=parseFloat(t[2]);if((o=="N"||o=="S"||o=="E"||o=="W")&&Number.isInteger(r)&&Number.isFinite(i)){let s=r+i/60;return(o=="S"||o=="W")&&(s*=-1),s}}return Number.NaN}static parseDMSPair(e){let t=e.split(",");if(t.length==2){let o=g.parseDMS(t[0]),r=g.parseDMS(t[1]);if(!Number.isNaN(o)&&!Number.isNaN(r))return new g(o,r)}return null}static parseDecimal(e){let t=e.split(",");if(t.length==2){let o=parseFloat(t[0].trim()),r=parseFloat(t[1].trim());if(Number.isFinite(o)&&Number.isFinite(r))return new g(o,r)}return null}static parse(e){let t=g.parseDecimal(e),o=g.parseDMSPair(e);return t||o}toDMS(e,t=!0){let o=g.toDMS(this.lat,"S","N",e),r=g.toDMS(this.lng,"W","E",e);if(this.alt&&t){let i=`${this.alt.toFixed(e)}m`;return`<${o}, ${r}> alt ${i}`}else return`<${o}, ${r}>`}toDMSArray(e,t=!1){let o=[g.toDMS(this.lat,"S","N",e),g.toDMS(this.lng,"W","E",e)];return this.alt&&t&&o.push(`${this.alt.toFixed(e)}m`),o}static toDMS(e,t,o,r){let i=e<0?t:o;e=Math.abs(e);let s=Math.floor(e),a=(e-s)*60,p=Math.floor(a),l=((a-p)*60).toFixed(r);for(;l.indexOf(".")<=1;)l=`0${l}`;return`${i} ${s.toFixed(0)}\xB0 ${p.toFixed(0)}' ${l}"`}toString(e){return e=e||6,`(${this.lat.toFixed(e)}\xB0, ${this.lng.toFixed(e)}\xB0)`}equals(e){return q(e)&&this.lat==e.lat&&this.lng==e.lng&&this.alt==e.alt}compareTo(e){if(_(e))return-1;{let t=this.lat-e.lat,o=this.lng-e.lng,r=(this.alt||0)-(e.alt||0);return t==0&&o==0?r:t==0?o:t}}distance(e){let t=this.toUTM(),o=e.toUTM().rezone(t.zone),r=o.easting-t.easting,i=o.northing-t.northing;return Math.sqrt(r*r+i*i)}fromUTM(e){let t=e.hemisphere==="southern"&&e.northing>=0?b.FalseNorthing:0,o=(e.northing-t)/(b.pointScaleFactor*b.A),r=(e.easting-b.E0)/(b.pointScaleFactor*b.A),i=o,s=r;for(let u=1;u<=3;++u){let m=b.beta[u-1],x=2*u*o,V=2*u*r,v=Math.sin(x),X=Math.cosh(V),Q=Math.cos(x),S=Math.sinh(V);i-=m*v*X,s-=m*Q*S}let a=Math.asin(Math.sin(i)/Math.cosh(s)),p=a;for(let u=1;u<=3;++u)p+=b.delta[u-1]*Math.sin(2*u*a);let c=e.zone*6-183,l=Math.atan(Math.sinh(s)/Math.cos(i));for(this._lat=$t(p),this._lng=c+$t(l);this._lng<-180;)this._lng+=360;for(;this._lng>180;)this._lng-=360;return this._alt=e.altitude,this}toUTM(){return new H().fromLatLng(this)}toVec2(){let e=de.create();return de.set(e,this.lng,this.lat),e}fromVec2(e){return this._lng=e[0],this._lat=e[1],this._alt=void 0,this}toVec3(){let e=z.create();return z.set(e,this.lng,this.alt,this.lat),e}fromVec3(e){return this._lng=e[0],this._alt=e[1],this._lat=e[2],this}toArray(){return[this._lng,this._alt,this._lat]}fromArray(e){return this.fromVec3(e)}copy(e){return this._lat=e.lat,this._lng=e.lng,this._alt=e.alt,this}clone(){return new g(this)}};var vt=1e-8,bt=class extends T{setup(){}conversionTest(e,t,o,r,i,s,a){let p=new g(e,t,o),c=p.toUTM(),l=new H(r,i,o,s),u=l.toLatLng();this.areApprox(c.easting,l.easting,"Easting"),this.areApprox(c.northing,l.northing,"Northing"),this.areApprox(c.altitude,l.altitude,"Altitude"),this.areApprox(c.zone,l.zone,"Zone"),this.areExact(c.hemisphere,l.hemisphere,"Hemisphere 1"),this.areExact(c.hemisphere,a,"Hemisphere 2"),this.areApprox(u.lat,p.lat,"Latitude"),this.areApprox(u.lng,p.lng,"Longitude"),this.areApprox(u.alt,p.alt,"Altitude")}test_JonesPoint(){this.conversionTest(38.790342,-77.040682,0,322765.32,42954888e-1,18,"northern")}test_ZeroLatLng(){this.conversionTest(0,0,0,166021.443,0,31,"northern")}test_NorthernHemisphereIsAllPositiveNorthings(){for(let e=0;e<=90;++e){let o=new g(e,0).toUTM();this.isGreaterThanEqual(o.northing,0,`Latitude ${e}`)}}test_SouthernHemisphereIsAllNegativeNorthings(){for(let e=0;e>=-90;--e){let o=new g(e,0).toUTM();this.isLessThanEqual(o.northing,0,`Latitude ${e}`)}}test_ZoneBoundaries(){let e=new g(0,0-vt,0),t=new g(0,0,0),o=new g(0,vt,0),r=new g(0,6-2*vt,0),i=new g(0,6-vt,0),s=new g(0,6,0),a=t.toUTM(),p=e.toUTM().rezone(a.zone),c=o.toUTM(),l=r.toUTM(),u=i.toUTM(),m=s.toUTM().rezone(u.zone),x=a.easting-p.easting,V=c.easting-a.easting,v=u.easting-l.easting,X=m.easting-u.easting;this.areApprox(x,V,"A",.01),this.areApprox(x,v,"B",.01),this.areApprox(x,X,"C",.01),this.areApprox(V,v,"D",.01),this.areApprox(V,X,"E",.01),this.areApprox(v,X,"F",.01)}centroidTest(e,t){let r=new Array;for(let c=0;c<4;++c){let l=c*So,u=e*Math.cos(l),m=e*Math.sin(l);r.push(new g(m+t,u+3))}let i=g.centroid(r),s=r.map(c=>c.toUTM()),a=H.centroid(s),p=a.toLatLng();(!this.areApprox(p.lat,i.lat,"Latitude",.01)||!this.areApprox(p.lng,i.lng,"Longitude",.01))&&console.log({centUTMll:p,centUTM:a,centLL:i})}test_Centroid_InOneZone_InOneHemisphere(){this.centroidTest(2.5,3)}test_Centroid_InOneZone_SpanningHemispheres(){this.centroidTest(2.5,0)}test_Centroid_SpanningZones_InOneHemisphere(){this.centroidTest(3.5,4)}test_Centroid_SpanningZones_SpanningHemispheres(){this.centroidTest(3.5,0)}};var Vo=[bt];function Yt(n){return d(n)&&n.length>0?parseFloat(n):null}var f=class{constructor(e,t){this._url=null;this._base=void 0;this._protocol=null;this._host=null;this._hostName=null;this._userName=null;this._password=null;this._port=null;this._pathName=null;this._hash=null;this._query=new Map;e!==void 0&&(this._url=new URL(e,t),this.rehydrate())}rehydrate(){d(this._protocol)&&this._protocol!==this._url.protocol&&(this._url.protocol=this._protocol),d(this._host)&&this._host!==this._url.host&&(this._url.host=this._host),d(this._hostName)&&this._hostName!==this._url.hostname&&(this._url.hostname=this._hostName),d(this._userName)&&this._userName!==this._url.username&&(this._url.username=this._userName),d(this._password)&&this._password!==this._url.password&&(this._url.password=this._password),d(this._port)&&this._port.toFixed(0)!==this._url.port&&(this._url.port=this._port.toFixed(0)),d(this._pathName)&&this._pathName!==this._url.pathname&&(this._url.pathname=this._pathName),d(this._hash)&&this._hash!==this._url.hash&&(this._url.hash=this._hash);for(let[e,t]of this._query)this._url.searchParams.set(e,t);this._protocol=this._url.protocol,this._host=this._url.host,this._hostName=this._url.hostname,this._userName=this._url.username,this._password=this._url.password,this._port=Yt(this._url.port),this._pathName=this._url.pathname,this._hash=this._url.hash,this._url.searchParams.forEach((e,t)=>this._query.set(t,e))}refresh(){if(this._url===null){if(d(this._protocol)&&(d(this._host)||d(this._hostName))){if(d(this._host))return this._url=new URL(`${this._protocol}//${this._host}`,this._base),this._port=Yt(this._url.port),this.rehydrate(),!1;if(d(this._hostName))return this._url=new URL(`${this._protocol}//${this._hostName}`,this._base),this.rehydrate(),!1}else if(d(this._pathName)&&d(this._base))return this._url=new URL(this._pathName,this._base),this.rehydrate(),!1}return d(this._url)}base(e){if(this._url!==null)throw new Error("Cannot redefine base after defining the protocol and domain");return this._base=e,this.refresh(),this}protocol(e){return this._protocol=e,this.refresh()&&(this._url.protocol=e),this}host(e){return this._host=e,this.refresh()&&(this._url.host=e,this._hostName=this._url.hostname,this._port=Yt(this._url.port)),this}hostName(e){return this._hostName=e,this.refresh()&&(this._url.hostname=e,this._host=`${this._url.hostname}:${this._url.port}`),this}port(e){return this._port=e,this.refresh()&&(this._url.port=e.toFixed(0),this._host=`${this._url.hostname}:${this._url.port}`),this}userName(e){return this._userName=e,this.refresh()&&(this._url.username=e),this}password(e){return this._password=e,this.refresh()&&(this._url.password=e),this}path(e){return this._pathName=e,this.refresh()&&(this._url.pathname=e),this}pathPop(e){return e=e||/\/[^/]+\/?$/,this.path(this._pathName.replace(e,""))}pathPush(e){let t=this._pathName;return t.endsWith("/")||(t+="/"),t+=e,this.path(t)}query(e,t){return this._query.set(e,t),this.refresh()&&this._url.searchParams.set(e,t),this}hash(e){return this._hash=e,this.refresh()&&(this._url.hash=e),this}toURL(){return this._url}toString(){return this._url.href}[Symbol.toStringTag](){return this.toString()}};var At=class extends T{test_EmptyConstructor(){this.doesNotThrow(()=>{let e=new f;this.throws(()=>e.toString())})}test_EmptyConstructor_SetProtocol(){let e=new f;this.doesNotThrow(()=>{e.protocol("http:"),this.throws(()=>e.toString())})}test_EmptyConstructor_SetHost(){let e=new f;this.doesNotThrow(()=>{e.host("www.seanmcbeth.com:8081"),this.throws(()=>e.toString())})}test_EmptyConstructor_SetHostName(){let e=new f;this.doesNotThrow(()=>{e.hostName("www.seanmcbeth.com"),this.throws(()=>e.toString())})}test_EmptyConstructor_SetProtocolAndHost(){let e=new f;this.areExact(e.protocol("http:").host("www.seanmcbeth.com:8081").toString(),"http://www.seanmcbeth.com:8081/")}test_EmptyConstructor_SetProtocolAndHostName(){let e=new f;this.areExact(e.protocol("http:").hostName("www.seanmcbeth.com").toString(),"http://www.seanmcbeth.com/")}test_EmptyConstructor_SetProtocolAndHostNameAndPathName(){let e=new f;this.areExact(e.protocol("http:").hostName("www.seanmcbeth.com").path("images").toString(),"http://www.seanmcbeth.com/images")}test_EmptyConstructor_SetProtocolAndPathNameAndHostName(){let e=new f;this.areExact(e.protocol("http:").path("images").hostName("www.seanmcbeth.com").toString(),"http://www.seanmcbeth.com/images")}test_EmptyConstructor_SetHostNameAndProtocolAndPathName(){let e=new f;this.areExact(e.hostName("www.seanmcbeth.com").protocol("http:").path("images").toString(),"http://www.seanmcbeth.com/images")}test_EmptyConstructor_SetHostNameAndPathNameAndProtocol(){let e=new f;this.areExact(e.hostName("www.seanmcbeth.com").path("images").protocol("http:").toString(),"http://www.seanmcbeth.com/images")}test_EmptyConstructor_SetPathNameAndProtocolAndHostName(){let e=new f;this.areExact(e.path("images").protocol("http:").hostName("www.seanmcbeth.com").toString(),"http://www.seanmcbeth.com/images")}test_EmptyConstructor_SetPathNameAndHostNameAndProtocol(){let e=new f;this.areExact(e.path("images").hostName("www.seanmcbeth.com").protocol("http:").toString(),"http://www.seanmcbeth.com/images")}test_EmptyConstructor_BaseAndPathName(){let e=new f;this.areExact(e.path("").base(new URL("https://www.seanmcbeth.com")).toString(),"https://www.seanmcbeth.com/")}test_EmptyConstructor_PathNameAndBase(){let e=new f;this.areExact(e.base("https://www.seanmcbeth.com").path("").toString(),"https://www.seanmcbeth.com/")}test_CantResetBase1(){let e=new f("https://www.seanmcbeth.com");this.throws(()=>e.base("https://yahoo.com"))}test_CantResetBase2(){let e=new f().base("https://www.seanmcbeth.com").path("");this.throws(()=>e.base("https://yahoo.com"))}test_CanResetBaseBeforePathIsSet(){let e=new f().base("https://www.seanmcbeth.com").base("https://yahoo.com").path("");this.areExact(e.toString(),"https://yahoo.com/")}test_PathPush1(){let e=new f("https://www.seanmcbeth.com").pathPush("images");this.areExact(e.toString(),"https://www.seanmcbeth.com/images")}test_PathPush2(){let e=new f("https://www.seanmcbeth.com").pathPush("images").pathPush("archive");this.areExact(e.toString(),"https://www.seanmcbeth.com/images/archive")}test_PathPop(){let e=new f("https://www.seanmcbeth.com/images/archive").pathPop();this.areExact(e.toString(),"https://www.seanmcbeth.com/images")}test_PathPopPush(){let e=new f("https://www.seanmcbeth.com/images/archive").pathPop().pathPush("whatever");this.areExact(e.toString(),"https://www.seanmcbeth.com/images/whatever")}test_UndefinedConstructor(){this.doesNotThrow(()=>new f(void 0))}test_UndefinedUndefinedConstructor(){this.doesNotThrow(()=>new f(void 0,void 0))}test_UndefinedNullConstructor(){this.doesNotThrow(()=>new f(void 0,null))}test_NullConstructor(){this.throws(()=>new f(null))}test_NullUndefinedConstructor(){this.throws(()=>new f(null,void 0))}test_NullNullConstructor(){this.throws(()=>new f(null,null))}test_FullURLConstructor(){this.doesNotThrow(()=>{let e=new f("https://www.seanmcbeth.com");this.areExact(e.toString(),"https://www.seanmcbeth.com/")})}test_RelativeConstructorWithStringBase1(){this.doesNotThrow(()=>{let e=new f("image.jpg","https://www.seanmcbeth.com");this.areExact(e.toString(),"https://www.seanmcbeth.com/image.jpg")})}test_RelativeConstructorWithNullBase(){this.throws(()=>new f("image.jpg",null))}test_RelativeConstructorWithUndefinedBase(){this.throws(()=>new f("image.jpg",void 0))}test_RelativeConstructorWithStringBase2(){this.doesNotThrow(()=>{let e=new f("image.jpg","https://www.seanmcbeth.com/images/");this.areExact(e.toString(),"https://www.seanmcbeth.com/images/image.jpg")})}test_RelativeConstructorWithStringBase3(){this.doesNotThrow(()=>{let e=new f("../image.jpg","https://www.seanmcbeth.com/images/");this.areExact(e.toString(),"https://www.seanmcbeth.com/image.jpg")})}test_AbsoluteConstructorWithStringBase1(){this.doesNotThrow(()=>{let e=new f("/image.jpg","https://www.seanmcbeth.com");this.areExact(e.toString(),"https://www.seanmcbeth.com/image.jpg")})}test_AbsoluteConstructorWithStringBase2(){this.doesNotThrow(()=>{let e=new f("/image.jpg","https://www.seanmcbeth.com/images");this.areExact(e.toString(),"https://www.seanmcbeth.com/image.jpg")})}};function re(){return{disposed:!1,dispose(){this.disposed=!0}}}function ie(){return{closed:!1,close(){this.closed=!0}}}function se(){return{destroyed:!1,destroy(){this.destroyed=!0}}}var St=class extends T{test_DisposeIDisposable(){let e=re();this.isFalse(e.disposed,"Before"),M(e),this.isTrue(e.disposed,"After")}test_DisposeIClosable(){let e=ie();this.isFalse(e.closed,"Before"),M(e),this.isTrue(e.closed,"After")}test_DisposeIDestroyable(){let e=se();this.isFalse(e.destroyed,"Before"),M(e),this.isTrue(e.destroyed,"After")}test_DisposeNull(){this.doesNotThrow(()=>M(null))}test_DisposeUndefined(){this.doesNotThrow(()=>M(void 0))}test_DisposeString(){this.doesNotThrow(()=>M("ASDFXYZ"))}test_DisposeNumber(){this.doesNotThrow(()=>M(3))}test_DisposeObject(){this.doesNotThrow(()=>M({}))}test_DisposeArray(){this.doesNotThrow(()=>M([123,456]))}test_UsingIDisposable(){let e=re();this.isFalse(e.disposed,"Before"),$(e,t=>{this.areExact(e,t),this.isFalse(e.disposed,"Inside")}),this.isTrue(e.disposed,"After")}test_UsingIClosable(){let e=ie();this.isFalse(e.closed,"Before"),$(e,t=>{this.areExact(e,t),this.isFalse(e.closed,"Inside")}),this.isTrue(e.closed,"After")}test_UsingIDestroyable(){let e=se();this.isFalse(e.destroyed,"Before"),$(e,t=>{this.areExact(e,t),this.isFalse(e.destroyed,"Inside")}),this.isTrue(e.destroyed,"After")}test_UsingNull(){this.doesNotThrow(()=>$(null,this.isNull.bind(this)))}test_UsingUndefined(){this.doesNotThrow(()=>$(void 0,this.isUndefined.bind(this)))}async test_UsingAsyncIDisposable(){let e=re();this.isFalse(e.disposed,"Before"),await ce(e,async t=>{this.areExact(e,t),this.isFalse(e.disposed,"Inside")}),this.isTrue(e.disposed,"After")}async test_UsingAsyncIClosable(){let e=ie();this.isFalse(e.closed,"Before"),await ce(e,async t=>{this.areExact(e,t),this.isFalse(e.closed,"Inside")}),this.isTrue(e.closed,"After")}async test_UsingAsyncIDestroyable(){let e=se();this.isFalse(e.destroyed,"Before"),await ce(e,async t=>{this.areExact(e,t),this.isFalse(e.destroyed,"Inside")}),this.isTrue(e.destroyed,"After")}test_UsingAsyncNull(){this.doesNotThrow(()=>ce(null,async e=>this.isNull(e)))}test_UsingAsyncUndefined(){this.doesNotThrow(()=>ce(void 0,async e=>this.isUndefined(e)))}test_UsingArrayIDisposable(){let e=[re(),re(),re()];e.forEach(t=>this.isFalse(t.disposed,"Before")),pe(e,t=>{this.areExact(e,t),e.forEach(o=>this.isFalse(o.disposed,"Inside"))}),e.forEach(t=>this.isTrue(t.disposed,"After"))}test_UsingArrayIClosable(){let e=[ie(),ie(),ie()];e.forEach(t=>this.isFalse(t.closed,"Before")),pe(e,t=>{this.areExact(e,t),e.forEach(o=>this.isFalse(o.closed,"Inside"))}),e.forEach(t=>this.isTrue(t.closed,"After"))}test_UsingArrayIDestroyable(){let e=[se(),se(),se()];e.forEach(t=>this.isFalse(t.destroyed,"Before")),pe(e,t=>{this.areExact(e,t),e.forEach(o=>this.isFalse(o.destroyed,"Inside"))}),e.forEach(t=>this.isTrue(t.destroyed,"After"))}test_UsingArrayNull(){this.doesNotThrow(()=>pe(null,this.isNull.bind(this)))}test_UsingArrayOfNulls(){this.doesNotThrow(()=>pe([null,null,null],e=>e.forEach(t=>this.isNull(t))))}test_UsingArrayUndefined(){this.doesNotThrow(()=>pe(void 0,this.isUndefined.bind(this)))}test_UsingArrayOfUndefineds(){this.doesNotThrow(()=>pe([void 0,void 0,void 0],e=>e.forEach(t=>this.isUndefined(t))))}async test_UsingArrayAsyncIDisposable(){let e=[re(),re(),re()];e.forEach(t=>this.isFalse(t.disposed,"Before")),await le(e,async t=>{this.areExact(e,t),e.forEach(o=>this.isFalse(o.disposed,"Inside"))}),e.forEach(t=>this.isTrue(t.disposed,"After"))}async test_UsingArrayAsyncIClosable(){let e=[ie(),ie(),ie()];e.forEach(t=>this.isFalse(t.closed,"Before")),await le(e,async t=>{this.areExact(e,t),e.forEach(o=>this.isFalse(o.closed,"Inside"))}),e.forEach(t=>this.isTrue(t.closed,"After"))}async test_UsingArrayAsyncIDestroyable(){let e=[se(),se(),se()];e.forEach(t=>this.isFalse(t.destroyed,"Before")),await le(e,async t=>{this.areExact(e,t),e.forEach(o=>this.isFalse(o.destroyed,"Inside"))}),e.forEach(t=>this.isTrue(t.destroyed,"After"))}test_UsingArrayAsyncNull(){this.doesNotThrow(()=>le(null,async e=>this.isNull(e)))}test_UsingArrayAsyncOfNulls(){this.doesNotThrow(()=>le([null,null,null],async e=>e.forEach(t=>this.isNull(t))))}test_UsingArrayAsyncUndefined(){this.doesNotThrow(()=>le(void 0,async e=>this.isUndefined(e)))}test_UsingArrayAsyncOfUndefineds(){this.doesNotThrow(()=>le([void 0,void 0,void 0],async e=>e.forEach(t=>this.isUndefined(t))))}};var Co=[...eo,...to,...Vo,At,St];function Zt(n){let e=new Map;for(let[t,o]of n)e.set(o,t);return e}function Wi(n){return n!=="B"&&n[1]==="i"}function To(n){return n!=="B"&&!To(n)}var Eo=new Map([[1,"KiB"],[2,"MiB"],[3,"GiB"],[4,"TiB"]]),Po=new Map([[1,"KB"],[2,"MB"],[3,"GB"],[4,"TB"]]),Ui=Zt(Eo),qi=Zt(Po),Ki=new Map([[2,Eo],[10,Po]]);function Mo(n,e=10){let t=n<0;n=Math.abs(n);let o=e===2?1024:1e3,r=Math.min(4,Math.floor(Math.log(n)/Math.log(o))),i=Math.pow(o,r);2*n>=o*i&&r<4&&(r++,i*=o);let s;r===0?s="B":(s=Ki.get(e).get(r),n/=i);let a=n%1===0;return`${t?"-":""}${n.toFixed(a?0:2)} ${s}`}function Io(n,e){if(e==="B")return n;{let t,o;Wi(e)?(t=1024,o=Ui.get(e)):To(e)?(t=1e3,o=qi.get(e)):O(e);let r=Math.pow(t,o);return n*r}}var yt=class extends T{test_FormatBytes1(){let e=Mo(500,2);this.areExact(e,"500 B")}test_ToBytes1(){let e=Io(2,"KiB");this.areExact(e,2048)}};var ko=[yt];var Lo=[ct,...ko,...Yn,...Co];var Ro=new $e(...Lo);We("main",Ro);Ro.run("UTMPointTests");
