var ae=document.readyState==="complete"?Promise.resolve("already"):new Promise(o=>{let t=()=>{document.readyState==="complete"&&(document.removeEventListener("readystatechange",t),o("had to wait for it"))};document.addEventListener("readystatechange",t,!1)});function rt(o,t,e){return typeof o===t||o instanceof e}function g(o){return rt(o,"function",Function)}function _(o){return rt(o,"string",String)}function q(o){return rt(o,"boolean",Boolean)}function W(o){return rt(o,"number",Number)}function U(o){return c(o)&&rt(o,"object",Object)}function $(o){return o instanceof Array}function S(o,t){throw new Error((t||"Unexpected object: ")+o)}function m(o){return o==null}function c(o){return!m(o)}function le(o){return o instanceof Uint8Array||o instanceof Uint8ClampedArray||o instanceof Int8Array||o instanceof Uint16Array||o instanceof Int16Array||o instanceof Uint32Array||o instanceof Int32Array||o instanceof Float32Array||o instanceof Float64Array||"BigUint64Array"in globalThis&&o instanceof globalThis.BigUint64Array||"BigInt64Array"in globalThis&&o instanceof globalThis.BigInt64Array}function de(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function I(o){return o.splice(0)}function me(o,t){for(let e=0;e<o.length;++e)if(o[e]!==t[e])return e;return-1}function K(o,t){let e=o.indexOf(t);return e>-1?(Et(o,e),!0):!1}function Et(o,t){return o.splice(t,1)[0]}function xe(o,...t){o.splice(0,o.length,...t)}function Y(o){return o}function ue(){return!0}function _e(){return!1}var Z=class{constructor(){this.listeners=new Map,this.listenerOptions=new Map,this.bubblers=new Set,this.scopes=new WeakMap}addBubbler(t){this.bubblers.add(t)}removeBubbler(t){this.bubblers.delete(t)}addScopedEventListener(t,e,n,r){this.scopes.has(t)||this.scopes.set(t,[]),this.scopes.get(t).push([e,n]),this.addEventListener(e,n,r)}removeScope(t){let e=this.scopes.get(t);if(e){this.scopes.delete(t);for(let[n,r]of e)this.removeEventListener(n,r)}}addEventListener(t,e,n){let r=this.listeners.get(t);r||(r=new Array,this.listeners.set(t,r)),r.find(i=>i===e)||(r.push(e),n&&this.listenerOptions.set(e,n))}removeEventListener(t,e){let n=this.listeners.get(t);n&&this.removeListener(n,e)}clearEventListeners(t){for(let[e,n]of this.listeners)if(m(t)||t===e){for(let r of n)this.removeEventListener(t,r);I(n),this.listeners.delete(e)}}removeListener(t,e){let n=t.findIndex(r=>r===e);n>=0&&(Et(t,n),this.listenerOptions.has(e)&&this.listenerOptions.delete(e))}dispatchEvent(t){let e=this.listeners.get(t.type);if(e)for(let n of e){let r=this.listenerOptions.get(n);c(r)&&!q(r)&&r.once&&this.removeListener(e,n),g(n)?n.call(this,t):n.handleEvent(t)}if(t.defaultPrevented)return!1;for(let n of this.bubblers)if(!n.dispatchEvent(t))return!1;return!0}};var A=class{constructor(t=!0){this.autoStart=t,this.onThens=new Array,this.onCatches=new Array,this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",this.resolve=e=>{if(this.running){this._result=e,this._resultState="resolved";for(let n of this.onThens)n(e);this.clear(),this._executionState="finished"}},this.reject=e=>{if(this.running){this._error=e,this._resultState="errored";for(let n of this.onCatches)n(e);this.clear(),this._executionState="finished"}},this.autoStart&&this.start()}clear(){I(this.onThens),I(this.onCatches)}start(){this._executionState="running"}resolver(t){return()=>this.resolve(t)}resolveOn(t,e,n){let r=this.resolver(n);t.addEventListener(e,r),this.finally(()=>t.removeEventListener(e,r))}get result(){if(c(this.error))throw this.error;return this._result}get error(){return this._error}get executionState(){return this._executionState}get waiting(){return this.executionState==="waiting"}get started(){return this.executionState!=="waiting"}get running(){return this.executionState==="running"}get finished(){return this.executionState==="finished"}get resultState(){return this._resultState}get resolved(){return this.resultState==="resolved"}get errored(){return this.resultState==="errored"}get[Symbol.toStringTag](){return this.toString()}project(){return new Promise((t,e)=>{this.finished?this.errored?e(this.error):t(this.result):(this.onThens.push(t),this.onCatches.push(e))})}then(t,e){return this.project().then(t,e)}catch(t){return this.project().catch(t)}finally(t){return this.project().finally(t)}reset(){this._reset(this.autoStart)}restart(){this._reset(!0)}_reset(t){this.running&&this.reject("Resetting previous invocation"),this.clear(),this._result=void 0,this._error=void 0,this._executionState="waiting",this._resultState="none",t&&this.start()}};function fe(o,t){return"on"+t in o}function T(o,t,e,...n){m(n)&&(n=[]);let r;if(_(e)?n.unshift(e):W(e)&&(r=e),!(o instanceof Z)){if(!fe(o,t))throw new Error(`Target does not have a ${t} rejection event`);for(let s of n)if(!fe(o,s))throw new Error(`Target does not have a ${s} rejection event`)}let i=new A;if(W(r)){let s=setTimeout(i.reject,r,`'${t}' has timed out.`);i.finally(clearTimeout.bind(globalThis,s))}let p=(s,l)=>{o.addEventListener(s,l),i.finally(()=>o.removeEventListener(s,l))};p(t,s=>i.resolve(s));let a=s=>i.reject(s);for(let s of n)p(s,a);return i}function E(o){return o.then(ue).catch(_e)}var he=/([^\/]+)\/(.+)/,_o=/(?:([^\.]+)\.)?([^\+;]+)(?:\+([^;]+))?((?:; *([^=]+)=([^;]+))*)/;function Ot(o){return o.flatMap(t=>t.extensions.map(e=>"."+e)).sort().join(", ")}var it=class o{constructor(t,e,n){this._type=t,this._fullSubType=e,this._primaryExtension=null,this.depMessage=null;let r=new Map;this._parameters=r;let i=this._fullSubType.match(_o);this._tree=i[1],this._subType=i[2],this._suffix=i[3];let p=i[4];if(this._value=this._fullValue=this._type+"/",c(this._tree)&&(this._value=this._fullValue+=this._tree+"."),this._value=this._fullValue+=this._subType,c(this._suffix)&&(this._value=this._fullValue+="+"+this._suffix),c(p)){let a=p.split(";").map(s=>s.trim()).filter(s=>s.length>0).map(s=>s.split("="));for(let[s,...l]of a){let d=l.join("=");r.set(s,d);let w=`; ${s}=${d}`;this._fullValue+=w,s!=="q"&&(this._value+=w)}}this._extensions=n||[],this._primaryExtension=this._extensions[0]||null}static parse(t){if(!t)return null;let e=t.match(he);if(!e)return null;let n=e[1],r=e[2];return new o(n,r)}deprecate(t){return this.depMessage=t,this}check(){c(this.depMessage)&&console.warn(`${this._value} is deprecated ${this.depMessage}`)}matches(t){if(m(t))return!1;if(this.typeName==="*"&&this.subTypeName==="*")return!0;let e=null,n=null;if(_(t)){let r=t.match(he);if(!r)return!1;e=r[1],n=r[2]}else e=t.typeName,n=t._fullSubType;return this.typeName===e&&(this._fullSubType==="*"||this._fullSubType===n)}withParameter(t,e){let n=`${this._fullSubType}; ${t}=${e}`;return new o(this.typeName,n,this.extensions)}get typeName(){return this.check(),this._type}get tree(){return this.check(),this._tree}get suffix(){return this._suffix}get subTypeName(){return this.check(),this._subType}get value(){return this.check(),this._value}__getValueUnsafe(){return this._value}get fullValue(){return this.check(),this._fullValue}get parameters(){return this.check(),this._parameters}get extensions(){return this.check(),this._extensions}__getExtensionsUnsafe(){return this._extensions}get primaryExtension(){return this.check(),this._primaryExtension}toString(){return this.parameters.get("q")==="1"?this.value:this.fullValue}toFileSystemAPIAccepts(){return{[this.value]:this.extensions.map(t=>"."+t)}}addExtension(t){if(!t)throw new Error("File name is not defined");return this.primaryExtension&&(t=o.removeExtension(t),t=`${t}.${this.primaryExtension}`),t}static removeExtension(t){let e=t.lastIndexOf(".");return e>-1&&(t=t.substring(0,e)),t}};function fo(o,t,...e){return new it(o,t,e)}function k(o){return fo.bind(null,o)}var pt=k("application");var Q=pt("javascript","js");var Dt=pt("json","json");var Rt=pt("wasm","wasm");var ge=pt("x-zip-compressed","zip");var ve=pt("zip","zip");var Bt=k("text");var st=Bt("css","css");var dt=Bt("plain","txt","text","conf","def","list","log","in");var Ae=Bt("xml");var ho="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ";function Lt(o,t){if(o<0)throw new Error("Length must be greater than 0");m(t)&&(t=ho);let e="";for(let n=0;n<o;++n){let r=Math.floor(Math.random()*t.length);e+=t[r]}return e}var be=new Map,mt=class{constructor(t,e,n,...r){this.key=t,this.value=e,this.bySetAttribute=n,this.tags=r.map(i=>i.toLocaleUpperCase()),Object.freeze(this)}applyToElement(t){if(this.tags.length>0&&this.tags.indexOf(t.tagName)===-1){let e=be.get(t.tagName);e||be.set(t.tagName,e=new Set),e.has(this.key)||(e.add(this.key),console.warn(`Element ${t.tagName} does not support Attribute ${this.key}`))}this.bySetAttribute?t.setAttribute(this.key,this.value.toString()):this.key in t?t[this.key]=this.value:this.value===!1?t.removeAttribute(this.key):this.value===!0?t.setAttribute(this.key,""):g(this.value)?this.value(t):t.setAttribute(this.key,this.value.toString())}};function j(o,t,e,...n){return new mt(o,t,e,...n)}function we(o){return o instanceof mt}function Ve(o){return j("ariaValueMax",o,!1)}function ye(o){return j("ariaValueMin",o,!1)}function Se(o){return j("ariaValueNow",o,!1)}function b(...o){return o=o.filter(Y),j("CLASS_LIST",t=>t.classList.add(...o),!1)}function ke(o,t){return j("data-"+o.toLowerCase(),t,!0)}function Xe(o){return j("height",o,!1,"canvas","embed","iframe","img","input","object","video")}function Ft(o){return j("rel",o,!1,"a","area","link")}function Ce(o){return j("role",o,!1)}function ct(o){return _(o)||(o=o.value),j("type",o,!1,"button","input","command","embed","link","object","script","source","style","menu")}function Te(o){return j("width",o,!1,"canvas","embed","iframe","img","input","object","video")}function ut(...o){return`rgb(${o.join(", ")})`}var Nt=class{constructor(t){this._value=t}get value(){return this._value}toString(){return this.value}};var Gt=class extends Nt{constructor(t,e,n){super(n),this._name=t,this.sep=e}get name(){return this._name}toString(){return this.name+this.sep+this.value+";"}};var zt=class extends Gt{constructor(t,e){super(t,": ",e)}},xt=class extends zt{constructor(t,e){super(t.replace(/[A-Z]/g,n=>`-${n.toLocaleLowerCase()}`),e.toString()),this.key=t,this.priority=""}applyToElement(t){t.style[this.key]=this.value+this.priority}important(){return this.priority=" !important",this}get value(){return super.value+this.priority}};function Me(o){return new xt("display",o)}function Ie(o){return new xt("width",o)}function je(o){return U(o)?o.element instanceof Element:!1}function J(o){return je(o)?o.element:_(o)?Oe(o):o}function go(o){return U(o)&&"applyToElement"in o&&g(o.applyToElement)}function Pe(o,t,e=""){o=J(o),t?(o.style.removeProperty("display"),getComputedStyle(o).display==="none"&&(o.style.display=e||"block")):o.style.display="none"}function Ee(o){return o=J(o),o.style.display!=="none"}function B(o,...t){let e=o instanceof Element||o instanceof ShadowRoot?o:_(o)?document.querySelector(o):o.element,n=e instanceof HTMLTemplateElement?e.content:e;for(let r of t)c(r)&&(r instanceof Node?n.appendChild(r):je(r)?n.appendChild(J(r)):go(r)?e instanceof ShadowRoot||r.applyToElement(e):n.appendChild(document.createTextNode(r.toLocaleString())));return e}function Oe(o){return document.querySelector(o)}function _t(o){return Oe(o)}function O(o,...t){let e=null,n=t.filter(we).filter(r=>r.key==="id"||r.key==="query");for(let r of n)r.key==="query"?(e=r.value,K(t,r)):r.key==="id"&&(e=document.getElementById(r.value),e&&K(t,r));return e&&e.tagName!==o.toUpperCase()&&console.warn(`Expected a "${o.toUpperCase()}" element but found a "${e.tagName}".`),e||(e=document.createElement(o)),B(e,...t),e}function vo(o){for(o=J(o);o.lastChild;)o.lastChild.remove()}function M(o,t){o=J(o),vo(o),o.append(wo(t))}function Ao(o,t){o=J(o),o.title=t}function ft(o,t,e,n,r){o=J(o);let i=null,p=null,a=null;q(t)?(p=t,a=e,r=n):(i=t,p=e,a=n),o.disabled=!p,a&&M(o,a),r&&Ao(o,r),i&&(o.classList.toggle("btn-"+i,p),o.classList.toggle("btn-outline-"+i,!p))}function bo(...o){return O("button",...o)}function ht(...o){return bo(...o,ct("button"))}function De(...o){return ht(...o,b("btn","btn-primary"))}function Re(...o){return ht(...o,b("btn","btn-secondary"))}function Be(...o){return O("canvas",...o)}function L(...o){return O("div",...o)}function Le(...o){return O("h1",...o)}function Fe(...o){return O("h2",...o)}function Wt(...o){return O("img",...o)}function Ne(...o){return O("link",...o)}function Jt(...o){return O("p",...o)}function Ge(...o){return O("script",...o)}function wo(o){return document.createTextNode(o)}function Ht(o){if(o.status>=400)throw new Error("Resource could not be retrieved: "+o.requestPath);return o}var gt=class extends Event{get type(){return super.type}constructor(t,e){super(t,e)}},F=class extends Z{addBubbler(t){super.addBubbler(t)}removeBubbler(t){super.removeBubbler(t)}addScopedEventListener(t,e,n,r){super.addScopedEventListener(t,e,n,r)}addEventListener(t,e,n){super.addEventListener(t,e,n)}removeEventListener(t,e){super.removeEventListener(t,e)}clearEventListeners(t){return super.clearEventListeners(t)}};var N=class extends F{constructor(){super(...arguments),this.attached=new Array,this.soFar=null,this.total=null,this.msg=null,this.est=null}get p(){return this.total>0?this.soFar/this.total:0}report(t,e,n,r){this.soFar=t,this.total=e,this.msg=n,this.est=r;for(let i of this.attached)i.report(t,e,n,r)}attach(t){this.attached.push(t),t.report(this.soFar,this.total,this.msg,this.est)}clear(){this.report(0,0),this._clear()}start(t){this.report(0,1,t||"starting")}end(t){this.report(1,1,t||"done"),this._clear()}_clear(){this.soFar=null,this.total=null,this.msg=null,this.est=null,I(this.attached)}};var qt=class{constructor(t="controls progress"){let e=L(b("progress-bar"),Ce("progressbar"),Se(0),ye(0),Ve(1),Ie(0));this.element=L(b(t),e),this.progress=new Ut(e)}clear(){this.progress.clear()}report(t,e,n,r){this.progress.report(t,e,n,r)}attach(t){this.progress.attach(t)}start(t){this.progress.start(t)}end(t){this.progress.end(t)}},Ut=class extends N{constructor(t,e=!0){super(),this.progressBar=t,this.showMessage=e}report(t,e,n,r){if(super.report(t,e,n,r),t===0)this.progressBar.style.width="0",this.progressBar.setAttribute("aria-valuenow","0");else{let i=(100*this.p).toFixed(1);this.progressBar.style.width=`${i}%`,this.progressBar.setAttribute("aria-valuenow",i)}this.showMessage&&M(this.progressBar,n||"")}};function ze(o="controls progress"){return new qt(o)}var vt=class{constructor(t){this.task=new A(!1),this.element=L(b("dialog"),Me("none"),ke("dialogname",t),this.container=L(b("dialog-container"),this.titleElement=Le(b("title-bar"),t),this.contentArea=L(b("dialog-content")),L(b("dialog-controls"),this.confirmButton=De("Confirm",b("confirm-button")),this.cancelButton=Re("Cancel",b("cancel-button"))))),this.confirmButton.addEventListener("click",this.task.resolver(!0)),this.cancelButton.addEventListener("click",this.task.resolver(!1)),B(document.body,this)}get title(){return this._title}set title(t){M(this.titleElement,this._title=t)}async onShowing(){}onShown(){}async onConfirm(){}onCancel(){}async onClosing(){}onClosed(){}show(t){Pe(this,t)}get isOpen(){return Ee(this)}hide(){this.show(!1)}async toggle(){this.isOpen?this.hide():this.showDialog()}async showDialog(){return await this.onShowing(),this.show(!0),this.onShown(),this.task.restart(),await this.task?await this.onConfirm():this.onCancel(),await this.onClosing(),this.show(!1),this.onClosed(),this.task.result}};var $t=class{constructor(t,e,n){if(this.name=t,this.callback=e,!g(e))throw new Error("A function instance is required for this parameter");this.opts=n,Object.freeze(this)}applyToElement(t){this.add(t)}add(t){t.addEventListener(this.name,this.callback,this.opts)}remove(t){t.removeEventListener(this.name,this.callback)}};function at(o,t,e){return new $t(o,t,e)}function We(o,t){return at("click",o,t)}function Je(o,t){return at("dragend",o,t)}function He(o,t){return at("dragleave",o,t)}function qe(o,t){return at("dragover",o,t)}function Ue(o,t){return at("drop",o,t)}var Kt=class extends gt{constructor(t){super("input"),this.files=t}},At=class extends F{get dragTarget(){return this._dragTarget}set dragTarget(t){t!==this.dragTarget&&(this.dragTarget&&(this.dragTarget.removeEventListener("dragover",this.onDragOver),this.dragTarget.removeEventListener("dragend",this.onDragEnd),this.dragTarget.removeEventListener("dragleave",this.onDragEnd),this.dragTarget.removeEventListener("drop",this.onDrop)),this._dragTarget=t,this.dragTarget&&B(this.dragTarget,qe(this.onDragOver),He(this.onDragEnd),Je(this.onDragEnd),Ue(this.onDrop)))}constructor(t,e,n,r=null){super(),this.file=n,this.typeFilters=new Array,this.element=null,this._dragTarget=null;let i=s=>Array.from(s).filter(l=>this.typeFilters.length===0||this.typeFilters.filter(d=>d.matches(l.type)).length>0),p=s=>Array.from(s).filter(l=>l.kind=="file"&&(this.typeFilters.length===0||this.typeFilters.filter(d=>d.matches(l.type)).length>0));this.onDragOver=s=>{this.enabled&&(p(s.dataTransfer.items).length>0?M(this.element,"Drop file..."):M(this.element,"No files matching expected type(s)")),s.preventDefault()},this.onDragEnd=s=>{this.enabled&&M(this.element,t),s.preventDefault()},this.onDrop=s=>{this.enabled&&a(s.dataTransfer.files),this.onDragEnd(s)};let a=s=>{let l=i(s);l.length>0&&this.dispatchEvent(new Kt(l))};this.file.style.display="none",this.file.insertAdjacentElement("afterend",this.element=ht(b("btn",`btn-${e}`),We(()=>this.show()),t)),this.dragTarget=r||this.element,this.file.addEventListener("input",()=>a(this.file.files)),this.setTypeFilters(),this.enabled=!0}show(){this.file.showPicker?this.file.showPicker():this.file.click()}setTypeFilters(...t){xe(this.typeFilters,...t),this.file.accept=Ot(t)}isExpectedType(t){return m(t)?!1:this.typeFilters.length===0?!0:this.typeFilters.map(e=>e.matches(t)).reduce((e,n)=>e||n,!1)}get accept(){return this.file.accept}get enabled(){return!this.file.disabled}set enabled(t){this.file.disabled=!t,this.element.disabled=!t}get disabled(){return!this.enabled}set disabled(t){this.enabled=!t}get files(){return this.file.files}clear(){this.file.value=null}};var lt=class extends N{constructor(t,e){super(),this.i=t,this.prog=e}report(t,e,n,r){super.report(t,e,n,r),this.prog.update(this.i,t,e,n)}};var bt=class{constructor(t){this.prog=t,this.weightTotal=0,this.subProgressCallbacks=new Array,this.subProgressWeights=new Array,this.subProgressValues=new Array,this.start=performance.now();for(let e=0;e<this.subProgressWeights.length;++e)this.subProgressValues[e]=0,this.subProgressCallbacks[e]=new lt(e,this)}addSubProgress(t){t=t||1,this.weightTotal+=t,this.subProgressWeights.push(t),this.subProgressValues.push(0);let e=new lt(this.subProgressCallbacks.length,this);return this.subProgressCallbacks.push(e),e}update(t,e,n,r){if(this.prog){this.subProgressValues[t]=e/n;let i=0;for(let l=0;l<this.subProgressWeights.length;++l)i+=this.subProgressValues[l]*this.subProgressWeights[l];let p=performance.now(),a=p-this.start,s=this.start-p+a*this.weightTotal/i;this.prog.report(i,this.weightTotal,r,s)}}};function Zt(o,t){return new Yt(t,o).subProgressCallbacks}function $e(o,t){let e=new Array(t);for(let n=0;n<t;++n)e[n]=1;return Zt(o,e)}var Yt=class extends bt{constructor(t,e){super(e);for(let n of t)this.addSubProgress(n)}};async function Ke(o,t){let e=new Array(t.length),n=new Array(t.length);for(let p=0;p<t.length;++p){let a=t[p];e[p]=a[0],n[p]=a[1]}let r=Zt(o,e),i=new Array(t.length);for(let p=0;p<t.length;++p)i[p]=n[p](r[p]);return await Promise.all(i)}function Ze(o){return c(o)&&g(o.then)&&g(o.catch)&&g(o.finally)&&g(o.fetch)&&g(o.getSize)}var Ye=class{get result(){if(c(this.error))throw this.error;return this._result}get error(){return this._error}get started(){return this._started}get finished(){return this._finished}constructor(t,e){this.path=t,this.type=e,this._result=null,this._error=null,this._started=!1,this._finished=!1,this.resolve=null,this.reject=null,this.promise=new Promise((n,r)=>{this.resolve=i=>{this._result=i,this._finished=!0,n(i)},this.reject=i=>{this._error=i,this._finished=!0,r(i)}})}async getSize(t){try{let{contentLength:e}=await t.head(this.path).accept(this.type).exec();return[this,e||1]}catch(e){return console.warn(e),[this,1]}}async fetch(t,e){try{let n=await this.getResult(t,e);this.resolve(n)}catch(n){this.reject(n)}}get[Symbol.toStringTag](){return this.promise.toString()}then(t,e){return this.promise.then(t,e)}catch(t){return this.promise.catch(t)}finally(t){return this.promise.finally(t)}};function Qt(o,...t){if(!U(o))return!1;o=o;for(let e of t){if(!(e in o))return!1;let n=o[e];if(!g(n))return!1}return!0}function yo(o){return Qt(o,"dispose")}function So(o){return Qt(o,"destroy")}function ko(o){return Qt(o,"close")}function D(o){yo(o)&&o.dispose(),ko(o)&&o.close(),So(o)&&o.destroy()}function Qe(o,t){try{return t(o)}finally{D(o)}}var pi="HTMLCanvasElement"in globalThis,si="HTMLImageElement"in globalThis,te=!1,tt=!te&&"OffscreenCanvas"in globalThis,ci=!te&&"createImageBitmap"in globalThis;function Xo(){try{return new OffscreenCanvas(1,1).getContext("2d")!=null}catch{return!1}}var ai=tt&&Xo();function Co(){try{return new OffscreenCanvas(1,1).getContext("webgl2")!=null}catch{return!1}}var li=tt&&Co();function to(o,t){return new OffscreenCanvas(o,t)}function eo(o,t){return Be(Te(o),Xe(t))}function ee(o,t){let e=o.getContext("2d");if(m(e))throw new Error("Could not create 2d context for canvas");e.drawImage(t,0,0)}function oo(o){let t=new A,e=setInterval(()=>{o()&&(clearInterval(e),t.resolve())},100);return t}async function h(o,t){let{status:e,requestPath:n,responsePath:r,content:i,contentType:p,contentLength:a,fileName:s,headers:l,date:d}=o;return{status:e,requestPath:n,responsePath:r,content:c(t)?await t(i):void 0,contentType:p,contentLength:a,fileName:s,headers:l,date:d}}var oe=null;function no(o){return oe===null&&(oe=new Audio),oe.canPlayType(o)!==""}var wt=class{constructor(t,e,n,r=!1){this.fetcher=t,this.method=e,this.path=n,this.useBLOBs=r,this.prog=null,this.request={method:e,path:this.path.href,body:null,headers:null,timeout:null,withCredentials:!1,useCache:!1,retryCount:3}}retries(t){return this.request.retryCount=t,this}query(t,e){return this.path.searchParams.set(t,e),this.request.path=this.path.href,this}header(t,e){return this.request.headers===null&&(this.request.headers=new Map),this.request.headers.set(t.toLowerCase(),e),this}headers(t){for(let[e,n]of t.entries())this.header(e,n);return this}timeout(t){return this.request.timeout=t,this}progress(t){return this.prog=t,this}body(t,e){if(c(t)){let n=new Set,r=new Array;r.push(t);let i=!1;for(;!i&&r.length>0;){let p=r.shift();if(p&&!n.has(p))if(n.add(p),p instanceof Blob){i=!0;break}else _(p)||r.push(...Object.values(p))}if(i){let p=new FormData,a=new Map,s=new Set;for(let[l,d]of Object.entries(t))if(d instanceof Blob){let w=l+".name",x=t[w];_(x)&&(a.set(d,x),s.add(w))}for(let[l,d]of Object.entries(t))s.has(l)||(d instanceof Blob?p.append(l,d,a.get(d)):_(d)?p.append(l,d):c(d)&&g(d.toString)?p.append(l,d.toString()):console.warn("Can't serialize value to formdata",l,d));t=p,e=void 0}this.request.body=t,this.content(e)}return this}withCredentials(){return this.request.withCredentials=!0,this}useCache(t=!0){return this.request.useCache=t,this}media(t,e){c(e)&&(_(e)||(e=e.value),this.header(t,e))}content(t){this.media("content-type",t)}accept(t){return this.media("accept",t),this}blob(t){if(this.accept(t),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetBlob(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetBlob(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}buffer(t){if(this.accept(t),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetBuffer(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetBuffer(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}async file(t){if(this.accept(t),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return await this.fetcher.sendObjectGetFile(this.request,this.prog);if(this.method==="GET"){if(this.useBLOBs)return await this.fetcher.sendNothingGetFile(this.request,this.prog);{let e=await this.fetcher.sendNothingGetNothing(this.request);return h(e,()=>this.request.path)}}else{if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}}text(t){if(this.accept(t||dt),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetText(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetText(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}object(t){if(this.accept(t||Dt),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetObject(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetObject(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}xml(t){if(this.accept(t||Ae),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetXml(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetXml(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}imageBitmap(t){if(this.accept(t),this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetImageBitmap(this.request,this.prog);if(this.method==="GET")return this.fetcher.sendNothingGetImageBitmap(this.request,this.prog);if(this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}exec(){if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE")return this.fetcher.sendObjectGetNothing(this.request,this.prog);if(this.method==="GET")throw new Error("GET requests should expect a response type");if(this.method==="HEAD"||this.method==="OPTIONS")return this.fetcher.sendNothingGetNothing(this.request);S(this.method)}async audioBlob(t){if(c(t)&&(_(t)||(t=t.value),!no(t)))throw new Error(`Probably can't play file of type "${t}" at path: ${this.request.path}`);let e=await this.blob(t);if(no(e.contentType))return e;throw new Error(`Cannot play file of type "${e.contentType}" at path: ${this.request.path}`)}async audioBuffer(t,e){return h(await this.audioBlob(e),async n=>await t.decodeAudioData(await n.arrayBuffer()))}async htmlElement(t,e,n){let r=await this.file(n),i=T(t,e,"error");return t instanceof HTMLLinkElement?t.href=r.content:t.src=r.content,await i,await h(r,()=>t)}image(t){return this.htmlElement(Wt(),"load",t)}async htmlCanvas(t){let e=eo(1,1);if(this.method==="GET")if(tt){this.accept(t);let n=await this.fetcher.drawImageToCanvas(this.request,e.transferControlToOffscreen(),this.prog);return await h(n,()=>e)}else{let n=await this.image(t);return await h(n,r=>(e.width=r.width,e.height=r.height,ee(e,r),D(r),e))}else{if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE"||this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}}canvas(t){return tt?this.offscreenCanvas(t):this.htmlCanvas(t)}async offscreenCanvas(t){if(!tt)throw new Error("This system does not support OffscreenCanvas");if(this.method==="GET"){let e=await this.image(t);return await h(e,n=>{let r=to(n.width,n.height);return ee(r,n),D(n),r})}else{if(this.method==="POST"||this.method==="PUT"||this.method==="PATCH"||this.method==="DELETE"||this.method==="HEAD"||this.method==="OPTIONS")throw new Error(`${this.method} responses do not contain bodies`);S(this.method)}}async style(){let t=Ne(ct(st),Ft("stylesheet"));document.head.append(t);let e=await this.htmlElement(t,"load",st);return h(e)}async getScript(){let t=Ge(ct(Q));document.head.append(t);let e=await this.htmlElement(t,"load",Q);return h(e)}async script(t){let e=null,n=this.request.path;if(!t)e=await this.getScript();else if(!t()){let r=oo(t);e=await this.getScript(),await r}return this.prog&&this.prog.end(n),e}async module(){let t=this.request.path,e=await this.file(Q),n=await import(e.content);return this.prog&&this.prog.end(t),h(e,()=>n)}async wasm(t){let e=await this.buffer(Rt);if(!Rt.matches(e.contentType))throw new Error(`Server did not respond with WASM file. Was: ${e.contentType}`);let n=await WebAssembly.compile(e.content),r=await WebAssembly.instantiate(n,t);return h(e,()=>r.exports)}async worker(t="module"){let e=this.request.path,n=await this.file(Q);this.prog=null,this.request.timeout=null;let r=new Worker(n.content,{type:t});return this.prog&&this.prog.end(e),h(n,()=>r)}};var Vt=class{constructor(t,e=!1){this.service=t,this.useBLOBs=e;{let n=_t("input[name=__RequestVerificationToken]");n&&this.service.setRequestVerificationToken(n.value)}}clearCache(){return this.service.clearCache()}evict(t,e){return this.service.evict(new URL(t,e||location.href).href)}request(t,e,n){return new wt(this.service,t,new URL(e,n||location.href),this.useBLOBs)}head(t,e){return this.request("HEAD",t,e)}options(t,e){return this.request("OPTIONS",t,e)}get(t,e){return this.request("GET",t,e)}post(t,e){return this.request("POST",t,e)}put(t,e){return this.request("PUT",t,e)}patch(t,e){return this.request("PATCH",t,e)}delete(t,e){return this.request("DELETE",t,e)}async assets(t,e,...n){m(n)&&(n=[]),n.unshift(e);let r;Ze(t)?n.unshift(t):c(t)&&(r=t),n=n.filter(c);let i=await Promise.all(n.map(a=>a.getSize(this))),p=new Map(i);await Ke(r,n.map(a=>[p.get(a),s=>a.fetch(this,s)]))}};var yt=class{constructor(t){this.impl=t,this.defaultPostHeaders=new Map}setRequestVerificationToken(t){this.defaultPostHeaders.set("RequestVerificationToken",t)}clearCache(){return this.impl.clearCache()}evict(t){return this.impl.evict(t)}sendNothingGetNothing(t){return this.impl.sendNothingGetNothing(t)}sendNothingGetBlob(t,e){return this.impl.sendNothingGetSomething("blob",t,e)}sendObjectGetBlob(t,e){return this.impl.sendSomethingGetSomething("blob",t,this.defaultPostHeaders,e)}sendNothingGetBuffer(t,e){return this.impl.sendNothingGetSomething("arraybuffer",t,e)}sendObjectGetBuffer(t,e){return this.impl.sendSomethingGetSomething("arraybuffer",t,this.defaultPostHeaders,e)}sendNothingGetText(t,e){return this.impl.sendNothingGetSomething("text",t,e)}sendObjectGetText(t,e){return this.impl.sendSomethingGetSomething("text",t,this.defaultPostHeaders,e)}sendNothingGetObject(t,e){return this.impl.sendNothingGetSomething("json",t,e)}sendObjectGetObject(t,e){return this.impl.sendSomethingGetSomething("json",t,this.defaultPostHeaders,e)}sendObjectGetNothing(t,e){return this.impl.sendSomethingGetSomething("",t,this.defaultPostHeaders,e)}drawImageToCanvas(t,e,n){return this.impl.drawImageToCanvas(t,e,n)}async sendNothingGetFile(t,e){return h(await this.sendNothingGetBlob(t,e),URL.createObjectURL)}async sendObjectGetFile(t,e){return h(await this.sendObjectGetBlob(t,e),URL.createObjectURL)}async sendNothingGetXml(t,e){return h(await this.impl.sendNothingGetSomething("document",t,e),n=>n.documentElement)}async sendObjectGetXml(t,e){return h(await this.impl.sendSomethingGetSomething("document",t,this.defaultPostHeaders,e),n=>n.documentElement)}async sendNothingGetImageBitmap(t,e){return h(await this.sendNothingGetBlob(t,e),createImageBitmap)}async sendObjectGetImageBitmap(t,e){return h(await this.sendObjectGetBlob(t,e),createImageBitmap)}};function ro(o,t,e){return new Map(o.map(n=>[t(n),e(n)]))}function io(o,t){return ro(o,t,Y)}var G=class{constructor(t){if(this.items=new Map,this.defaultItems=new Array,c(t))for(let[e,n]of t)this.add(e,n)}add(t,...e){for(let n of e)if(m(t))this.defaultItems.push(n);else{let r=this.items.get(t);m(r)&&this.items.set(t,r=[]),r.push(n)}return this}entries(){return this.items.entries()}[Symbol.iterator](){return this.entries()}keys(){return this.items.keys()}*values(){for(let t of this.defaultItems)yield t;for(let t of this.items.values())for(let e of t)yield e}has(t){return c(t)?this.items.has(t):this.defaultItems.length>0}get(t){return m(t)?this.defaultItems:this.items.get(t)||[]}count(t){if(m(t))return this.defaultItems.length;let e=this.get(t);return c(e)?e.length:0}get size(){let t=this.defaultItems.length;for(let e of this.items.values())t+=e.length;return t}delete(t){return m(t)?I(this.defaultItems).length>0:this.items.delete(t)}remove(t,e){if(m(t))K(this.defaultItems,e);else{let n=this.items.get(t);c(n)&&(K(n,e),n.length===0&&this.items.delete(t))}}clear(){this.items.clear(),I(this.defaultItems)}};var H=class{constructor(t){if(this.items=new Map,c(t))for(let[e,n,r]of t)this.add(e,n,r)}add(t,e,n){let r=this.items.get(t);return m(r)&&this.items.set(t,r=new Map),r.set(e,n),this}*entries(){for(let[t,e]of this.items)for(let[n,r]of e)yield[t,n,r]}keys(t){return m(t)?this.items.keys():this.items.get(t).keys()}*values(){for(let t of this.items.values())for(let e of t.values())yield e}has(t,e){return this.items.has(t)&&(m(e)||this.items.get(t).has(e))}get(t,e){return m(e)?this.items.get(t):this.items.has(t)?this.items.get(t).get(e):null}count(t){return this.items.has(t)?this.items.get(t).size:null}get size(){let t=0;for(let e of this.items.values())t+=e.size;return t}delete(t,e){if(m(e))return this.items.delete(t);if(this.items.has(t)){let n=this.items.get(t),r=n.delete(e);return n.size===0&&this.items.delete(t),r}else return!1}clear(){this.items.clear()}};var St=class o{static delete(t){let e=indexedDB.deleteDatabase(t),n=T(e,"success","error","blocked");return E(n)}static async open(t,...e){let n=io(e,v=>v.name),r=new H(e.filter(v=>c(v.indexes)).flatMap(v=>v.indexes.map(C=>[v.name,C.name,C]))),i=new Array,p=new Array,a=new Array,s=new G,l=new G,d=null,w=indexedDB.open(t);if(await E(T(w,"success","error","blocked"))){let v=w.result;d=v.version;let C=new Array;for(let V of v.objectStoreNames)n.has(V)||p.push(V);for(let V of n.keys())v.objectStoreNames.contains(V)?C.push(V):i.push(V);if(C.length>0){let V=v.transaction(C),y=T(V,"complete","error","abort"),R=E(y);for(let f of C){let z=V.objectStore(f),ce=n.get(f);c(ce.options)&&z.keyPath!==ce.options.keyPath&&(p.push(f),i.push(f));for(let P of z.indexNames)r.has(f,P)||(a.indexOf(f)===-1&&a.push(f),l.add(f,P));if(r.has(f))for(let P of r.get(f).keys())if(!z.indexNames.contains(P))a.indexOf(f)===-1&&a.push(f),s.add(f,P);else{let ot=r.get(f,P),nt=z.index(P);(_(ot.keyPath)!==_(nt.keyPath)||_(ot.keyPath)&&_(nt.keyPath)&&ot.keyPath!==nt.keyPath||$(ot.keyPath)&&$(nt.keyPath)&&me(ot.keyPath,nt.keyPath))&&(a.indexOf(f)===-1&&a.push(f),l.add(f,P),s.add(f,P))}}V.commit(),await R}D(v)}else{d=0,i.push(...n.keys());for(let v of e)if(c(v.indexes))for(let C of v.indexes)s.add(v.name,C.name)}(i.length>0||p.length>0||s.size>0||l.size>0)&&++d;let x=new A,u=c(d)?indexedDB.open(t,d):indexedDB.open(t),X=T(u,"success","error","blocked"),et=E(x),Pt=E(X),se=x.resolver(!1);if(u.addEventListener("success",se),u.addEventListener("upgradeneeded",()=>{let v=T(u.transaction,"complete","error","abort"),C=u.result;for(let y of p)C.deleteObjectStore(y);let V=new Map;for(let y of i){let R=n.get(y),f=C.createObjectStore(y,R.options);V.set(y,f)}for(let y of a){let R=u.transaction.objectStore(y);V.set(y,R)}for(let[y,R]of V){for(let f of l.get(y))R.deleteIndex(f);for(let f of s.get(y)){let z=r.get(y,f);R.createIndex(f,z.keyPath,z.options)}}E(v).then(x.resolve).catch(x.reject).finally(()=>u.removeEventListener("success",se))}),!await et)throw x.error;if(!await Pt)throw X.error;return new o(u.result)}constructor(t){this.db=t}dispose(){D(this.db)}get name(){return this.db.name}get version(){return this.db.version}get storeNames(){return Array.from(this.db.objectStoreNames)}getStore(t){return new ne(this.db,t)}},ne=class{constructor(t,e){this.db=t,this.storeName=e}async request(t,e){let n=this.db.transaction(this.storeName,e),r=T(n,"complete","error"),i=n.objectStore(this.storeName),p=t(i),a=T(p,"success","error");if(!await E(a))throw n.abort(),a.error;if(n.commit(),!await E(r))throw r.error;return p.result}add(t,e){return this.request(n=>n.add(t,e),"readwrite")}clear(){return this.request(t=>t.clear(),"readwrite")}getCount(t){return this.request(e=>e.count(t),"readonly")}async has(t){return await this.getCount(t)>0}delete(t){return this.request(e=>e.delete(t),"readwrite")}get(t){return this.request(e=>e.get(t),"readonly")}getAll(){return this.request(t=>t.getAll(),"readonly")}getAllKeys(){return this.request(t=>t.getAllKeys(),"readonly")}getKey(t){return this.request(e=>e.getKey(t),"readonly")}openCursor(t,e){return this.request(n=>n.openCursor(t,e),"readonly")}openKeyCursor(t,e){return this.request(n=>n.openKeyCursor(t,e),"readonly")}put(t,e){return this.request(n=>n.put(t,e),"readwrite")}};function po(o,...t){for(let e of t)if(c(e))for(let[n,r]of e)o.set(n,r);return o}var re=class extends A{constructor(t){super(!1),this.milliseconds=t,this._timer=null}start(){super.start(),this._timer=setTimeout(()=>{this._timer=null,this.resolve()},this.milliseconds)}reset(){super.reset(),c(this._timer)&&(clearTimeout(this._timer),this._timer=null)}};function so(o){let t=new re(o);return t.start(),t}function kt(o,t){return async()=>{let e=null,n=500;for(let r=0;r<=o;++r)try{return r>0&&(await so(n),n*=2),await t()}catch(i){e=i}throw e}}function To(o){return _(o)||le(o)||o instanceof Blob||o instanceof FormData||de(o)||"Document"in globalThis&&o instanceof Document}function Xt(o,t,e,n,r,i){let p=!i;i&&i.then(()=>p=!0);let a=!1,s=r,l=new A;e.addEventListener("loadstart",()=>{p&&!a&&n&&n.start(o)}),e.addEventListener("progress",w=>{if(p&&!a){let x=w;n&&n.report(x.loaded,Math.max(x.loaded,x.total),o),x.loaded===x.total&&(s=!0,a&&l.resolve())}}),e.addEventListener("load",()=>{p&&!a&&(n&&n.end(o),a=!0,s&&l.resolve())});let d=w=>()=>{p&&l.reject(`${w} (${t.status})`)};return e.addEventListener("error",d("error")),e.addEventListener("abort",d("abort")),e.addEventListener("timeout",d("timeout")),l}function ie(o,t,e,n,r,i){if(o.open(t,e),o.responseType="blob",o.timeout=n,r)for(let[p,a]of r)o.setRequestHeader(p,a);c(i)?o.send(i):o.send()}function Ct(o,t,e){if(!o.has(t))return null;let n=o.get(t);try{let r=e(n);return o.delete(t),r}catch(r){console.warn(t,r)}return null}var Mo=/filename=\"(.+)\"(;|$)/,Io="Juniper:Fetcher:Cache",Tt=class{constructor(){this.cache=null,this.store=null,this.tasks=new H,this.cacheReady=this.openCache()}async drawImageToCanvas(t,e,n){let r=await this.sendNothingGetSomething("blob",t,n),i=r.content;return Qe(await createImageBitmap(i,{imageOrientation:"from-image"}),p=>(e.width=p.width,e.height=p.height,e.getContext("2d").drawImage(p,0,0),h(r)))}async openCache(){let t={keyPath:"requestPath"};this.cache=await St.open(Io,{name:"files",options:t}),this.store=await this.cache.getStore("files")}async clearCache(){await this.cacheReady,await this.store.clear()}async evict(t){await this.cacheReady,this.store.has(t)&&await this.store.delete(t)}async readResponseHeaders(t,e){let n=e.getAllResponseHeaders().split(/[\r\n]+/).map(x=>x.trim()).filter(x=>x.length>0).map(x=>{let u=x.split(": "),X=u.shift().toLowerCase(),et=u.join(": ");return[X,et]}),r=new G(n),i=Array.from(r.keys()).map(x=>[x,r.get(x).join(", ")]),p=new Map(i),a=Ct(p,"content-type",Y),s=Ct(p,"content-length",parseFloat),l=Ct(p,"date",x=>new Date(x)),d=Ct(p,"content-disposition",x=>{if(c(x)){let u=x.match(Mo);if(c(u))return u[1]}return null});return{status:e.status,requestPath:t,responsePath:e.responseURL,content:void 0,contentType:a,contentLength:s,fileName:d,date:l,headers:p}}async readResponse(t,e){let{responsePath:n,status:r,contentType:i,contentLength:p,fileName:a,date:s,headers:l}=await this.readResponseHeaders(t,e),d={requestPath:t,responsePath:n,status:r,contentType:i,contentLength:p,fileName:a,date:s,headers:l,content:e.response};return c(d.content)&&(d.contentType=d.contentType||d.content.type,d.contentLength=d.contentLength||d.content.size),d}async decodeContent(t,e){return h(e,async n=>{if(t==="")return null;if(m(e.contentType)){let r=Array.from(e.headers.entries()).map(i=>i.join(": ")).join(`
  `);throw new Error(`No content type found in headers: 
  `+r)}else{if(t==="blob")return n;if(t==="arraybuffer")return await n.arrayBuffer();if(t==="json"){let r=await n.text();return r.length>0?JSON.parse(r):null}else if(t==="document"){let r=new DOMParser;if(e.contentType==="application/xhtml+xml"||e.contentType==="text/html"||e.contentType==="application/xml"||e.contentType==="image/svg+xml"||e.contentType==="text/xml")return r.parseFromString(await n.text(),e.contentType);throw new Error("Couldn't parse document")}else{if(t==="text")return await n.text();S(t)}}})}async withCachedTask(t,e){return t.method!=="GET"&&t.method!=="HEAD"&&t.method!=="OPTIONS"?await e():(this.tasks.has(t.method,t.path)||this.tasks.add(t.method,t.path,e().finally(()=>this.tasks.delete(t.method,t.path))),this.tasks.get(t.method,t.path))}sendNothingGetNothing(t){return this.withCachedTask(t,kt(t.retryCount,async()=>{let e=new XMLHttpRequest,n=Xt(`requesting: ${t.path}`,e,e,null,!0);return ie(e,t.method,t.path,t.timeout,t.headers),await n,await this.readResponseHeaders(t.path,e)}))}sendNothingGetSomething(t,e,n){return this.withCachedTask(e,kt(e.retryCount,async()=>{let r=null,i=e.useCache&&e.method==="GET";i&&(c(n)&&n.start(),await this.cacheReady,r=await this.store.get(e.path));let p=m(r);if(p){let s=new XMLHttpRequest,l=Xt(`requesting: ${e.path}`,s,s,n,!0);ie(s,e.method,e.path,e.timeout,e.headers),await l,r=await this.readResponse(e.path,s),i&&await this.store.add(r)}let a=await this.decodeContent(t,r);return p&&c(n)&&n.end(),a}))}sendSomethingGetSomething(t,e,n,r){let i=null,p=po(new Map,n,e.headers),a=null;if(c(p)){let u=new Array;for(let X of p.keys())X.toLowerCase()==="content-type"&&u.push(X);if(u.length>0){e.body instanceof FormData||(a=p.get(u[0]),u.shift());for(let X of u)p.delete(X)}}To(e.body)&&!_(e.body)||_(e.body)&&dt.matches(a)?i=e.body:c(e.body)&&(i=JSON.stringify(e.body));let s=c(i),l=$e(r,s?2:1),[d,w]=l,x=async()=>{let u=new XMLHttpRequest,X=s?Xt("uploading",u,u.upload,d,!1):Promise.resolve(),et=Xt("saving",u,u,w,!0,X);ie(u,e.method,e.path,e.timeout,p,i),await X,await et;let Pt=await this.readResponse(e.path,u);return await this.decodeContent(t,Pt)};return kt(e.retryCount,x)()}};var jo=/OculusBrowser\/(\d+)\.(\d+)\.(\d+)/i,Mt=navigator.userAgent.match(jo),It=!!Mt,Ap=It&&{major:parseFloat(Mt[1]),minor:parseFloat(Mt[2]),patch:parseFloat(Mt[3])},bp=It&&/pacific/i.test(navigator.userAgent),wp=It&&/quest/i.test(navigator.userAgent),Vp=It&&/quest 2/i.test(navigator.userAgent);var Po="Worker"in globalThis;var co=new URL(globalThis.location.href),jt=co.searchParams.has("DEBUG")&&!co.searchParams.has("RELEASE");function ao(o,t){let e=globalThis,n=e[o];if(m(n)){if(m(t))throw new Error(`No value ${o} found`);n=t(),e[o]=n}return n}var as=ao("juniper::loadedFonts",()=>[]);var lo="3.7.24";var Is=jt?Lt(10):lo;var Oo=50,Do=12,js=Oo*Do;var mo={fontFamily:"Lato",fontSize:20};var Ps=ut(30,67,136),Es=ut(78,77,77),xo={fontFamily:mo.fontFamily,fontSize:mo.fontSize,textFillColor:"white"},Os=Object.assign({},xo,{bgFillColor:ut(0,120,215),bgStrokeColor:"black",bgStrokeSize:.02,padding:{top:.025,left:.05,bottom:.025,right:.05},minHeight:.2,maxHeight:.2,scale:300}),Ds=Object.assign({},xo,{textStrokeColor:"black",textStrokeSize:.01,minHeight:.25,maxHeight:.25});function uo(o=!0){let t=new yt(new Tt);return new Vt(t,!jt)}var pe=class extends vt{statusMessage;progressBar;constructor(){super("Scenario Importing..."),B(this.contentArea,Fe("Please wait"),Jt("Importing scenarios takes a significant amount of time. Please do not close the window before the import completes."),this.statusMessage=Jt("Uploading..."),this.progressBar=ze()),this.cancelButton.remove(),ft(this.confirmButton,!1,"OK","Close dialog")}success(){M(this.statusMessage,"Upload completed successfully!"),ft(this.confirmButton,!0,"OK","Close dialog")}fail(t){console.error(t),M(this.statusMessage,"Upload failed!"),ft(this.confirmButton,!0,"OK","Close dialog")}};(async function(){await ae;let o=uo(!1),t=new pe,e=new At("Import","danger",_t("#scenarioPackageFile"));e.setTypeFilters(ge,ve),e.addEventListener("input",async n=>{t.progressBar.start("Uploading..."),e.enabled=!1;let r=t.showDialog();try{let i=new FormData;i.set("FormFile",n.files[0]);let p=await o.post("/editor/scenarios/").query("handler","Import").body(i).progress(t.progressBar).exec();Ht(p),t.success(),globalThis.location.href=p.responsePath}catch(i){t.fail(i)}finally{await r,location.reload()}})})();
