function pe(r,e){for(let t=0;t<r.length;++t)if(r[t]!==e[t])return t;return-1}function he(r,e,t){return new Map(r.map(s=>[e(s),t(s)]))}function A(r,e,t){return typeof r===e||r instanceof t}function D(r){return A(r,"function",Function)}function b(r){return A(r,"string",String)}function G(r){return A(r,"boolean",Boolean)}function ne(r){return A(r,"number",Number)}function fe(r){return d(r)&&A(r,"object",Object)}function V(r){return r instanceof Array}function me(r,e){throw new Error((e||"Unexpected object: ")+r)}function h(r){return r==null}function d(r){return!h(r)}function ge(r){return r instanceof Uint8Array||r instanceof Uint8ClampedArray||r instanceof Int8Array||r instanceof Uint16Array||r instanceof Int16Array||r instanceof Uint32Array||r instanceof Int32Array||r instanceof Float32Array||r instanceof Float64Array||"BigUint64Array"in globalThis&&r instanceof globalThis.BigUint64Array||"BigInt64Array"in globalThis&&r instanceof globalThis.BigInt64Array}function ye(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function I(r){return r.splice(0)}function W(r,e){return r.splice(e,1)[0]}function oe(r,e){let t=r.indexOf(e);return t>-1?(W(r,t),!0):!1}var k=class{constructor(e){this.items=new Map;this.defaultItems=new Array;if(d(e))for(let[t,s]of e)this.add(t,s)}add(e,t){if(h(e))this.defaultItems.push(t);else{let s=this.items.get(e);h(s)&&this.items.set(e,s=[]),s.push(t)}return this}entries(){return this.items.entries()}[Symbol.iterator](){return this.entries()}keys(){return this.items.keys()}*values(){for(let e of this.defaultItems)yield e;for(let e of this.items.values())for(let t of e)yield t}has(e){return d(e)?this.items.has(e):this.defaultItems.length>0}get(e){return h(e)?this.defaultItems:this.items.get(e)||[]}count(e){if(h(e))return this.defaultItems.length;let t=this.get(e);return d(t)?t.length:0}get size(){let e=this.defaultItems.length;for(let t of this.items.values())e+=t.length;return e}delete(e){return h(e)?I(this.defaultItems).length>0:this.items.delete(e)}remove(e,t){if(h(e))oe(this.defaultItems,t);else{let s=this.items.get(e);d(s)&&(oe(s,t),s.length===0&&this.items.delete(e))}}clear(){this.items.clear(),I(this.defaultItems)}};var K=class{constructor(e){this.items=new Map;if(d(e))for(let[t,s,n]of e)this.add(t,s,n)}add(e,t,s){let n=this.items.get(e);return h(n)&&this.items.set(e,n=new Map),n.set(t,s),this}*entries(){for(let[e,t]of this.items)for(let[s,n]of t)yield[e,s,n]}keys(e){return h(e)?this.items.keys():this.items.get(e).keys()}*values(){for(let e of this.items.values())for(let t of e.values())yield t}has(e,t){return this.items.has(e)&&(h(t)||this.items.get(e).has(t))}get(e,t){return h(t)?this.items.get(e):this.items.has(e)?this.items.get(e).get(t):null}count(e){return this.items.has(e)?this.items.get(e).size:null}get size(){let e=0;for(let t of this.items.values())e+=t.size;return e}delete(e,t){return h(t)?this.items.delete(e):this.items.has(e)?this.items.get(e).delete(t):!1}clear(){this.items.clear()}};var F=class extends Error{constructor(t,s=null){super(t);this.innerError=s}};function _(r){return r}function H(){return!0}function Te(){return!1}var q=class{constructor(){this.listeners=new Map;this.listenerOptions=new Map}addEventListener(e,t,s){if(D(t)){let n=this.listeners.get(e);n||(n=new Array,this.listeners.set(e,n)),n.find(o=>o===t)||(n.push(t),s&&this.listenerOptions.set(t,s))}}removeEventListener(e,t){if(D(t)){let s=this.listeners.get(e);s&&this.removeListener(s,t)}}clearEventListeners(e){for(let[t,s]of this.listeners)if(h(e)||e===t){for(let n of s)this.removeEventListener(e,n);I(s),this.listeners.delete(t)}}removeListener(e,t){let s=e.findIndex(n=>n===t);s>=0&&(W(e,s),this.listenerOptions.has(t)&&this.listenerOptions.delete(t))}dispatchEvent(e){let t=this.listeners.get(e.type);if(t)for(let s of t){let n=this.listenerOptions.get(s);d(n)&&!G(n)&&n.once&&this.removeListener(t,s),s.call(this,e)}return!e.defaultPrevented}};var X=class extends q{constructor(){super(...arguments);this.bubblers=new Set;this.scopes=new WeakMap}addBubbler(t){this.bubblers.add(t)}removeBubbler(t){this.bubblers.delete(t)}addEventListener(t,s,n){super.addEventListener(t,s,n)}removeEventListener(t,s){super.removeEventListener(t,s)}clearEventListeners(t){return super.clearEventListeners(t)}addScopedEventListener(t,s,n,o){this.scopes.has(t)||this.scopes.set(t,[]),this.scopes.get(t).push([s,n]),this.addEventListener(s,n,o)}removeScope(t){let s=this.scopes.get(t);if(s){this.scopes.delete(t);for(let[n,o]of s)this.removeEventListener(n,o)}}dispatchEvent(t){if(!super.dispatchEvent(t))return!1;if(!t.cancelBubble){for(let s of this.bubblers)if(!s.dispatchEvent(t))return!1}return!0}};var C=class{constructor(e,t,s=!0){this.onThens=new Array;this.onCatches=new Array;this._result=void 0;this._error=void 0;this._started=!1;this._errored=!1;this._finished=!1;D(e)?this.resolveTest=e:this.resolveTest=H,D(t)?this.rejectTest=t:this.rejectTest=H,G(e)?this.autoStart=e:G(t)?this.autoStart=t:d(s)?this.autoStart=s:this.autoStart=!1,this.resolve=n=>{if(this.running&&this.resolveTest(n)){this._result=n;for(let o of this.onThens)o(n);this.clear(),this._finished=!0}},this.reject=n=>{if(this.running&&this.rejectTest(n)){this._error=n,this._errored=!0;for(let o of this.onCatches)o(n);this.clear(),this._finished=!0}},this.autoStart&&this.start()}clear(){I(this.onThens),I(this.onCatches)}start(){this._started=!0}get result(){if(d(this.error))throw this.error;return this._result}get error(){return this._error}get started(){return this._started}get finished(){return this._finished}get running(){return this.started&&!this.finished}get errored(){return this._errored}get[Symbol.toStringTag](){return this.toString()}project(){return new Promise((e,t)=>{this.finished?this.errored?t(this.error):e(this.result):(this.onThens.push(e),this.onCatches.push(t))})}then(e,t){return this.project().then(e,t)}catch(e){return this.project().catch(e)}finally(e){return this.project().finally(e)}reset(){this.running&&this.reject("Resetting previous invocation"),this.clear(),this._result=void 0,this._error=void 0,this._errored=!1,this._finished=!1,this._started=!1,this.autoStart&&this.start()}};function ve(r,e){return"on"+e in r}function N(r,e,t,...s){h(s)&&(s=[]);let n;if(b(t)?s.unshift(t):ne(t)&&(n=t),!(r instanceof q)){if(!ve(r,e))throw new F(`Target does not have a ${e} rejection event`);for(let a of s)if(!ve(r,a))throw new F(`Target does not have a ${a} rejection event`)}let o=new C;if(ne(n)){let a=setTimeout(o.reject,n,`'${e}' has timed out.`);o.finally(clearTimeout.bind(globalThis,a))}let i=(a,m)=>{r.addEventListener(a,m),o.finally(()=>r.removeEventListener(a,m))},l=a=>o.resolve(a),u=a=>o.reject(a);i(e,l);for(let a of s)i(a,u);return o}function P(r){return r.then(H).catch(Te)}var S=class{constructor(e){this.db=e}static async getCurrentVersion(e){if(d(indexedDB.databases)){let t=await indexedDB.databases();for(let{name:s,version:n}of t)if(s===e)return n}return null}static delete(e){let t=indexedDB.deleteDatabase(e),s=N(t,"success","error","blocked");return P(s)}static async open(e,...t){let s=he(t,g=>g.name,_),n=new K(t.filter(g=>d(g.indexes)).flatMap(g=>g.indexes.map(T=>[g.name,T.name,T]))),o=new Array,i=new Array,l=new Array,u=new k,a=new k,m=await this.getCurrentVersion(e);if(h(m)){o.push(...s.keys());for(let g of t)if(d(g.indexes))for(let T of g.indexes)u.add(g.name,T.name)}else{let g=indexedDB.open(e);if(await P(N(g,"success","error","blocked"))){let T=g.result,w=new Array;for(let p of Array.from(T.objectStoreNames))s.has(p)||i.push(p);for(let p of s.keys())T.objectStoreNames.contains(p)?w.push(p):o.push(p);if(w.length>0){let p=T.transaction(w),M=N(p,"complete","error","abort"),B=P(M);for(let f of w){let re=p.objectStore(f);for(let x of Array.from(re.indexNames))n.has(f,x)||(l.indexOf(f)===-1&&l.push(f),a.add(f,x));if(n.has(f))for(let x of n.get(f).keys())if(!re.indexNames.contains(x))l.indexOf(f)===-1&&l.push(f),u.add(f,x);else{let j=n.get(f,x),O=re.index(x);(b(j.keyPath)!==b(O.keyPath)||b(j.keyPath)&&b(O.keyPath)&&j.keyPath!==O.keyPath||V(j.keyPath)&&V(O.keyPath)&&pe(j.keyPath,O.keyPath))&&(l.indexOf(f)===-1&&l.push(f),a.add(f,x),u.add(f,x))}}p.commit(),await B}T.close()}(o.length>0||i.length>0||u.size>0||a.size>0)&&++m}let y=new C,c=d(m)?indexedDB.open(e,m):indexedDB.open(e),v=N(c,"success","error","blocked"),E=P(y),se=P(v),ce=()=>y.resolve(!1);if(c.addEventListener("success",ce),c.addEventListener("upgradeneeded",()=>{let g=N(c.transaction,"complete","error","abort"),T=c.result;for(let p of i)T.deleteObjectStore(p);let w=new Map;for(let p of o){let M=s.get(p),B=T.createObjectStore(p,M.options);w.set(p,B)}for(let p of l){let M=c.transaction.objectStore(p);w.set(p,M)}for(let[p,M]of w){for(let B of a.get(p))M.deleteIndex(B);for(let B of u.get(p)){let f=n.get(p,B);M.createIndex(B,f.keyPath,f.options)}}P(g).then(y.resolve).catch(y.reject).finally(()=>c.removeEventListener("success",ce))}),!await E)throw y.error;if(!await se)throw v.error;return new S(c.result)}dispose(){this.db.close()}get name(){return this.db.name}get version(){return this.db.version}get storeNames(){return Array.from(this.db.objectStoreNames)}getStore(e){return new ie(this.db,e)}},ie=class{constructor(e,t){this.db=e;this.storeName=t}async request(e,t){let s=this.db.transaction(this.storeName,t),n=N(s,"complete","error"),o=s.objectStore(this.storeName),i=e(o),l=N(i,"success","error");if(!await P(l))throw s.abort(),l.error;if(s.commit(),!await P(n))throw n.error;return i.result}add(e,t){return this.request(s=>s.add(e,t),"readwrite")}clear(){return this.request(e=>e.clear(),"readwrite")}getCount(e){return this.request(t=>t.count(e),"readonly")}delete(e){return this.request(t=>t.delete(e),"readwrite")}get(e){return this.request(t=>t.get(e),"readonly")}getAll(){return this.request(e=>e.getAll(),"readonly")}getAllKeys(){return this.request(e=>e.getAllKeys(),"readonly")}getKey(e){return this.request(t=>t.getKey(e),"readonly")}openCursor(e,t){return this.request(s=>s.openCursor(e,t),"readonly")}openKeyCursor(e,t){return this.request(s=>s.openKeyCursor(e,t),"readonly")}put(e,t){return this.request(s=>s.put(e,t),"readwrite")}};function be(r,...e){for(let t of e)if(d(t))for(let[s,n]of t)r.set(s,n);return r}var L=class extends X{constructor(){super(...arguments);this.attached=new Array;this.soFar=null;this.total=null;this.msg=null;this.est=null}get p(){return this.total>0?this.soFar/this.total:0}report(t,s,n,o){this.soFar=t,this.total=s,this.msg=n,this.est=o;for(let i of this.attached)i.report(t,s,n,o)}attach(t){this.attached.push(t),t.report(this.soFar,this.total,this.msg,this.est)}clear(){this.report(0,0),this._clear()}start(t){this.report(0,1,t||"starting")}end(t){this.report(1,1,t||"done"),this._clear()}_clear(){this.soFar=null,this.total=null,this.msg=null,this.est=null,I(this.attached)}};var U=class extends L{constructor(t,s){super();this.i=t;this.prog=s}report(t,s,n,o){super.report(t,s,n,o),this.prog.update(this.i,t,s,n)}};var $=class{constructor(e){this.prog=e;this.weightTotal=0;this.subProgressCallbacks=new Array;this.subProgressWeights=new Array;this.subProgressValues=new Array;this.start=performance.now();for(let t=0;t<this.subProgressWeights.length;++t)this.subProgressValues[t]=0,this.subProgressCallbacks[t]=new U(t,this)}addSubProgress(e){e=e||1,this.weightTotal+=e,this.subProgressWeights.push(e),this.subProgressValues.push(0);let t=new U(this.subProgressCallbacks.length,this);return this.subProgressCallbacks.push(t),t}update(e,t,s,n){if(this.prog){this.subProgressValues[e]=t/s;let o=0;for(let a=0;a<this.subProgressWeights.length;++a)o+=this.subProgressValues[a]*this.subProgressWeights[a];let i=performance.now(),l=i-this.start,u=this.start-i+l*this.weightTotal/o;this.prog.report(o,this.weightTotal,n,u)}}};function xe(r,e){return new ae(e,r).subProgressCallbacks}function Ie(r,e){let t=new Array(e);for(let s=0;s<e;++s)t[s]=1;return xe(r,t)}var ae=class extends ${constructor(e,t){super(t);for(let s of e)this.addSubProgress(s)}};function le(r,...e){if(!fe(r))return!1;r=r;for(let t of e){if(!(t in r))return!1;let s=r[t];if(!D(s))return!1}return!0}function Pe(r){return le(r,"dispose")}function Ee(r){return le(r,"destroy")}function we(r){return le(r,"close")}function Me(r){Pe(r)&&r.dispose(),we(r)&&r.close(),Ee(r)&&r.destroy()}function Re(r,e){try{return e(r)}finally{Me(r)}}async function R(r,e){let{status:t,path:s,content:n,contentType:o,contentLength:i,fileName:l,headers:u,date:a}=r;return{status:t,path:s,content:await e(n),contentType:o,contentLength:i,fileName:l,headers:u,date:a}}function Be(r){return b(r)||ge(r)||r instanceof Blob||r instanceof FormData||ye(r)||"Document"in globalThis&&r instanceof Document}function z(r,e,t,s,n,o){let i=!o;o&&o.then(()=>i=!0);let l=!1,u=n,a=new C(()=>u&&l,()=>i);t.addEventListener("loadstart",()=>{i&&!l&&s&&s.start(r)}),t.addEventListener("progress",y=>{if(i&&!l){let c=y;s&&s.report(c.loaded,Math.max(c.loaded,c.total),r),c.loaded===c.total&&(u=!0,a.resolve())}}),t.addEventListener("load",()=>{i&&!l&&(s&&s.end(r),l=!0,a.resolve())});let m=y=>()=>a.reject(`${y} (${e.status})`);return t.addEventListener("error",m("error")),t.addEventListener("abort",m("abort")),t.addEventListener("timeout",m("timeout")),a}function de(r,e,t,s,n,o){if(r.open(e,t),r.responseType="blob",r.timeout=s,n)for(let[i,l]of n)r.setRequestHeader(i,l);d(o)?r.send(o):r.send()}function J(r,e,t){if(!r.has(e))return null;let s=r.get(e);try{let n=t(s);return r.delete(e),n}catch(n){console.warn(e,n)}return null}var De=/filename=\"(.+)\"(;|$)/,Ce="Juniper:Fetcher:Cache",Q=class{constructor(){this.cache=null;this.store=null;this.tasks=new K;this.cacheReady=this.openCache()}async drawImageToCanvas(e,t,s){let n=await this.sendNothingGetSomething("blob",e,s),o=n.content;return Re(await createImageBitmap(o,{imageOrientation:"none"}),i=>(t.width=i.width,t.height=i.height,t.getContext("2d").drawImage(i,0,0),R(n,()=>null)))}async openCache(){this.cache=await S.open(Ce,{name:"files",options:{keyPath:"path"}}),this.store=await this.cache.getStore("files")}async clearCache(){await this.cacheReady,await this.store.clear()}async readResponseHeaders(e,t){let s=t.getAllResponseHeaders().split(/[\r\n]+/).map(c=>c.trim()).filter(c=>c.length>0).map(c=>{let v=c.split(": "),E=v.shift().toLowerCase(),se=v.join(": ");return[E,se]}),n=new k(s),o=Array.from(n.keys()).map(c=>[c,n.get(c).join(", ")]),i=new Map(o),l=J(i,"content-type",_),u=J(i,"content-length",parseFloat),a=J(i,"date",c=>new Date(c)),m=J(i,"content-disposition",c=>{if(d(c)){let v=c.match(De);if(d(v))return v[1]}return null});return{status:t.status,path:e,content:void 0,contentType:l,contentLength:u,fileName:m,date:a,headers:i}}async readResponse(e,t){let{status:s,contentType:n,contentLength:o,fileName:i,date:l,headers:u}=await this.readResponseHeaders(e,t),a={path:e,status:s,contentType:n,contentLength:o,fileName:i,date:l,headers:u,content:t.response};return d(a.content)&&(a.contentType=a.contentType||a.content.type,a.contentLength=a.contentLength||a.content.size),a}async decodeContent(e,t){return R(t,async s=>{if(e==="")return null;if(h(t.contentType)){let n=Array.from(t.headers.entries()).map(o=>o.join(": ")).join(`
  `);throw new Error(`No content type found in headers: 
  `+n)}else{if(e==="blob")return s;if(e==="arraybuffer")return await s.arrayBuffer();if(e==="json"){let n=await s.text();return n.length>0?JSON.parse(n):null}else if(e==="document"){let n=new DOMParser;if(t.contentType==="application/xhtml+xml"||t.contentType==="text/html"||t.contentType==="application/xml"||t.contentType==="image/svg+xml"||t.contentType==="text/xml")return n.parseFromString(await s.text(),t.contentType);throw new Error("Couldn't parse document")}else{if(e==="text")return await s.text();me(e)}}})}async withCachedTask(e,t){return e.method!=="GET"&&e.method!=="HEAD"&&e.method!=="OPTIONS"?await t():(this.tasks.has(e.method,e.path)||this.tasks.add(e.method,e.path,t().finally(()=>this.tasks.delete(e.method,e.path))),this.tasks.get(e.method,e.path))}sendNothingGetNothing(e){return this.withCachedTask(e,async()=>{let t=new XMLHttpRequest,s=z(`requesting: ${e.path}`,t,t,null,!0);return de(t,e.method,e.path,e.timeout,e.headers),await s,await this.readResponseHeaders(e.path,t)})}sendNothingGetSomething(e,t,s){return this.withCachedTask(t,async()=>{let n=null,o=t.useCache&&t.method==="GET";o&&(d(s)&&s.start(),await this.cacheReady,n=await this.store.get(t.path));let i=h(n);if(i){let u=new XMLHttpRequest,a=z(`requesting: ${t.path}`,u,u,s,!0);de(u,t.method,t.path,t.timeout,t.headers),await a,n=await this.readResponse(t.path,u),o&&await this.store.add(n)}let l=await this.decodeContent(e,n);return i&&d(s)&&s.end(),l})}async sendSomethingGetSomething(e,t,s,n){let o=null,i=be(new Map,s,t.headers);if(t.body instanceof FormData&&d(i)){let v=new Array;for(let E of i.keys())E.toLowerCase()==="content-type"&&v.push(E);for(let E of v)i.delete(E)}Be(t.body)&&!b(t.body)?o=t.body:d(t.body)&&(o=JSON.stringify(t.body));let l=Ie(n,2),u=new XMLHttpRequest,a=d(o)?z("uploading",u,u.upload,l.shift(),!1):Promise.resolve(),m=l.shift(),y=z("saving",u,u,m,!0,a);de(u,t.method,t.path,t.timeout,i,o),await a,await y;let c=await this.readResponse(t.path,u);return await this.decodeContent(e,c)}};var Y=class{constructor(e){this.impl=e;this.defaultPostHeaders=new Map}setRequestVerificationToken(e){this.defaultPostHeaders.set("RequestVerificationToken",e)}clearCache(){return this.impl.clearCache()}sendNothingGetNothing(e){return this.impl.sendNothingGetNothing(e)}sendNothingGetBlob(e,t){return this.impl.sendNothingGetSomething("blob",e,t)}sendObjectGetBlob(e,t){return this.impl.sendSomethingGetSomething("blob",e,this.defaultPostHeaders,t)}sendNothingGetBuffer(e,t){return this.impl.sendNothingGetSomething("arraybuffer",e,t)}sendObjectGetBuffer(e,t){return this.impl.sendSomethingGetSomething("arraybuffer",e,this.defaultPostHeaders,t)}sendNothingGetText(e,t){return this.impl.sendNothingGetSomething("text",e,t)}sendObjectGetText(e,t){return this.impl.sendSomethingGetSomething("text",e,this.defaultPostHeaders,t)}async sendNothingGetObject(e,t){return(await this.impl.sendNothingGetSomething("json",e,t)).content}async sendObjectGetObject(e,t){return(await this.impl.sendSomethingGetSomething("json",e,this.defaultPostHeaders,t)).content}sendObjectGetNothing(e,t){return this.impl.sendSomethingGetSomething("",e,this.defaultPostHeaders,t)}drawImageToCanvas(e,t,s){return this.impl.drawImageToCanvas(e,t,s)}async sendNothingGetFile(e,t){return R(await this.sendNothingGetBlob(e,t),URL.createObjectURL)}async sendObjectGetFile(e,t){return R(await this.sendObjectGetBlob(e,t),URL.createObjectURL)}async sendNothingGetXml(e,t){return R(await this.impl.sendNothingGetSomething("document",e,t),s=>s.documentElement)}async sendObjectGetXml(e,t){return R(await this.impl.sendSomethingGetSomething("document",e,this.defaultPostHeaders,t),s=>s.documentElement)}async sendNothingGetImageBitmap(e,t){return R(await this.sendNothingGetBlob(e,t),createImageBitmap)}async sendObjectGetImageBitmap(e,t){return R(await this.sendObjectGetBlob(e,t),createImageBitmap)}};var ue=class extends L{constructor(t,s){super();this.server=t;this.taskID=s}report(t,s,n,o){let i={type:"progress",taskID:this.taskID,soFar:t,total:s,msg:n,est:o};this.server.postMessage(i)}},Z=class{constructor(e){this.self=e;this.methods=new Map;this.self.addEventListener("message",t=>{let s=t.data;this.callMethod(s)})}postMessage(e,t){d(t)?this.self.postMessage(e,t):this.self.postMessage(e)}callMethod(e){let t=this.methods.get(e.methodName);if(t)try{V(e.params)?t(e.taskID,...e.params):d(e.params)?t(e.taskID,e.params):t(e.taskID)}catch(s){this.onError(e.taskID,`method invocation error: ${e.methodName}(${s.message||s})`)}else this.onError(e.taskID,`method not found: ${e.methodName}`)}onError(e,t){let s={type:"error",taskID:e,errorMessage:t};this.postMessage(s)}onReturn(e,t,s){let n=null;if(t===void 0?n={type:"return",taskID:e}:n={type:"return",taskID:e,returnValue:t},d(s)){let o=s(t);this.postMessage(n,o)}else this.postMessage(n)}addMethodInternal(e,t,s){if(this.methods.has(e))throw new Error(`${e} method has already been mapped.`);this.methods.set(e,async(n,...o)=>{let i=new ue(this,n);try{let l=await t(...o,i);this.onReturn(n,l,s)}catch(l){console.error(l),this.onError(n,l.message||l)}})}addFunction(e,t,s){this.addMethodInternal(e,t,s)}addVoidFunction(e,t){this.addMethodInternal(e,t)}addMethod(e,t,s,n){this.addFunction(t,s.bind(e),n)}addVoidMethod(e,t,s){this.addVoidFunction(t,s.bind(e))}addEvent(e,t,s,n){e.addEventListener(t,o=>{let i=null;if(d(s)?i={type:"event",eventName:t,data:s(o)}:i={type:"event",eventName:t},i.data!==void 0&&d(n)){let l=n(i.data);this.postMessage(i,l)}else this.postMessage(i)})}};var te=class extends Z{constructor(e,t){super(e);let s=new Y(t);Ne(this,s)}};function ee(r){return[r.content]}function Ne(r,e){r.addVoidMethod(e,"setRequestVerificationToken",e.setRequestVerificationToken),r.addMethod(e,"clearCache",e.clearCache),r.addMethod(e,"sendNothingGetNothing",e.sendNothingGetNothing),r.addMethod(e,"sendNothingGetBuffer",e.sendNothingGetBuffer,ee),r.addMethod(e,"sendNothingGetImageBitmap",e.sendNothingGetImageBitmap,ee),r.addMethod(e,"sendNothingGetObject",e.sendNothingGetObject),r.addMethod(e,"sendNothingGetFile",e.sendNothingGetFile),r.addMethod(e,"sendNothingGetText",e.sendNothingGetText),r.addMethod(e,"sendObjectGetNothing",e.sendObjectGetNothing),r.addMethod(e,"sendObjectGetImageBitmap",e.sendObjectGetImageBitmap,ee),r.addMethod(e,"sendObjectGetBuffer",e.sendObjectGetBuffer,ee),r.addMethod(e,"sendObjectGetObject",e.sendObjectGetObject),r.addMethod(e,"sendObjectGetFile",e.sendObjectGetFile),r.addMethod(e,"sendObjectGetText",e.sendObjectGetText),r.addMethod(e,"drawImageToCanvas",e.drawImageToCanvas)}globalThis.server=new te(globalThis,new Q);
